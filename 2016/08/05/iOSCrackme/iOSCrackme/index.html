<!DOCTYPE HTML>

    <html lang="zh-Hans">
  
<head>
  <meta charset="utf-8">
  
  <title>看雪iOSCrackme破解报告 | 4chendy</title>
  <meta name="author" content="4chendy">
  
  <meta name="description" content="看雪iOSCrackme破解报告0x01.首先，利用classdump把crackme的头文件导出来，可以看到头文件只有6个，根据屏幕上的check按钮，很容易在控制器中找到如下函数
0x02.然后将可执行文件拉入IDA分析，直接跳到check这个函数。可以猜测这个函数应该就是加密函数。下面重点对这">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="看雪iOSCrackme破解报告"/>
  <meta property="og:site_name" content="4chendy"/>

  
    <meta property="og:image" content="undefined"/>
  

  
    <meta http-equiv="Content-Language" content="zh-Hans"/>
  

  <link href="/img/favicon.png" rel="icon">
  
    <link rel="apple-touch-icon" href="/img/apple-icon.ico">
    <link rel="apple-touch-icon-precomposed" href="/img/apple-icon.ico">
    

  <link rel="alternate" href="/dark-tech/atom.xml" title="4chendy" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">

  
  <!-- Chinese readability improment -->
  <style type="text/css">
    article {font-weight: 400;letter-spacing: .01rem;}
    article .entry{line-height:2;}
  </style>
  
  
  <style type="text/css">
  /* Tim Pietrusky advanced checkbox hack (Android <= 4.1.2) */
body{ -webkit-animation: bugfix infinite 1s; }
@-webkit-keyframes bugfix { from {padding:0;} to {padding:0;} }
</style>

  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-48887175-1', 'auto');
  ga('send', 'pageview');

</script>



  
    <!-- 360 Font and Baidu CDN in China -->
    
      <link href='http://fonts.useso.com/css?family=Open+Sans:300,400|Playball' rel='stylesheet' type='text/css'>
    
  <link href='http://apps.bdimg.com/libs/fontawesome/4.1.0/css/font-awesome.css' rel='stylesheet' type='text/css'>
  <script src="http://libs.baidu.com/jquery/1.11.1/jquery.min.js"></script>
  



<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
</head>


<body>
  <header id="header" class="inner"><div class="padding">
	<div class="alignleft logo">
	  <h1><a href="/">4chendy</a></h1>
	</div>
	<nav id="main-nav" class="alignright">
		<input type="checkbox" id="toggle" />
		<label for="toggle" class="toggle" data-open="Main Menu" data-close="Close Menu" onclick><i class="fa fa-bars"></i></label>
	  <ul class="menu">
	    
	      <li><a href="/dark-tech/">Home</a></li>
	    
	      <li><a href="/dark-tech/archives">Archives</a></li>
	    
	      <li><a href="/about">About</a></li>
	    
	      <li><a href="/guestbook">GuestBook</a></li>
	    
	    
	    	<li><a href="/dark-tech/atom.xml" target="_blank" title="bruce tan blog rss" class="rss-top"><i class="fa fa-rss"></i></a></li>
	    
	  </ul>
	</nav>
	<div class="clearfix"></div>
</div>
</header>
  <div id="page-heading-wrap">
  	<div class="inner">
      <div class="padding">
    		
          <h1>看雪iOSCrackme破解报告</h1>
          <ul>
            <li>
              <span class="heading-span">Posted on: </span>
              <time datetime="2016-08-04T17:51:44.000Z">2016-08-05</time>
            </li>
            
              <li>
                <span class="heading-span">By: </span>

                
                  <a href="/" target="_blank">4chendy</a>

                

              </li>
            
            <li>
              <span class="heading-span">With: </span>
              

                <a href="#ds-thread"><span class="ds-thread-count" data-thread-key="2016/08/05/iOSCrackme/iOSCrackme/" data-count-type="comments"></span></a>
              
            </li>
          </ul>
        
      </div>
  	</div>
  </div>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper" class="padding"><article class="post">
  
  
    <div class="post-content">
  
      
      <div class="entry">
        
          <h1 id="看雪iOSCrackme破解报告"><a href="#看雪iOSCrackme破解报告" class="headerlink" title="看雪iOSCrackme破解报告"></a>看雪iOSCrackme破解报告</h1><h5 id="0x01-首先，利用classdump把crackme的头文件导出来，可以看到头文件只有6个，根据屏幕上的check按钮，很容易在控制器中找到如下函数"><a href="#0x01-首先，利用classdump把crackme的头文件导出来，可以看到头文件只有6个，根据屏幕上的check按钮，很容易在控制器中找到如下函数" class="headerlink" title="0x01.首先，利用classdump把crackme的头文件导出来，可以看到头文件只有6个，根据屏幕上的check按钮，很容易在控制器中找到如下函数"></a>0x01.首先，利用classdump把crackme的头文件导出来，可以看到头文件只有6个，根据屏幕上的check按钮，很容易在控制器中找到如下函数</h5><p><img src="https://github.com/NULL-ME/NULL-ME.github.io/blob/master/articlePic/iOSCrackme/1.png?raw=true" alt="pic"></p>
<h5 id="0x02-然后将可执行文件拉入IDA分析，直接跳到check这个函数。可以猜测这个函数应该就是加密函数。下面重点对这个函数进行详细分析。"><a href="#0x02-然后将可执行文件拉入IDA分析，直接跳到check这个函数。可以猜测这个函数应该就是加密函数。下面重点对这个函数进行详细分析。" class="headerlink" title="0x02.然后将可执行文件拉入IDA分析，直接跳到check这个函数。可以猜测这个函数应该就是加密函数。下面重点对这个函数进行详细分析。"></a>0x02.然后将可执行文件拉入IDA分析，直接跳到check这个函数。可以猜测这个函数应该就是加密函数。下面重点对这个函数进行详细分析。</h5><p><img src="https://github.com/NULL-ME/NULL-ME.github.io/blob/master/articlePic/iOSCrackme/2.png?raw=true" alt="pic"></p>
<h5 id="0x03-在分析之前，先在手机屏幕上直接点击check，无反应。然后输入一定字符后再点击check，仍然没有反应。没有一点的错误提示，看来只能一步一步看汇编了。在IDA中先大概看下流程图的结构，拉到最底下，发现貌似成功的界面"><a href="#0x03-在分析之前，先在手机屏幕上直接点击check，无反应。然后输入一定字符后再点击check，仍然没有反应。没有一点的错误提示，看来只能一步一步看汇编了。在IDA中先大概看下流程图的结构，拉到最底下，发现貌似成功的界面" class="headerlink" title="0x03.在分析之前，先在手机屏幕上直接点击check，无反应。然后输入一定字符后再点击check，仍然没有反应。没有一点的错误提示，看来只能一步一步看汇编了。在IDA中先大概看下流程图的结构，拉到最底下，发现貌似成功的界面"></a>0x03.在分析之前，先在手机屏幕上直接点击check，无反应。然后输入一定字符后再点击check，仍然没有反应。没有一点的错误提示，看来只能一步一步看汇编了。在IDA中先大概看下流程图的结构，拉到最底下，发现貌似成功的界面</h5><p><img src="https://github.com/NULL-ME/NULL-ME.github.io/blob/master/articlePic/iOSCrackme/3.png?raw=true" alt="pic"></p>
<h5 id="不管怎样，先试试直接跳转到该地址，看能不能弹出成功的界面？"><a href="#不管怎样，先试试直接跳转到该地址，看能不能弹出成功的界面？" class="headerlink" title="不管怎样，先试试直接跳转到该地址，看能不能弹出成功的界面？: /"></a>不管怎样，先试试直接跳转到该地址，看能不能弹出成功的界面？: /</h5><p><img src="https://github.com/NULL-ME/NULL-ME.github.io/blob/master/articlePic/iOSCrackme/4.png?raw=true" alt="pic"></p>
<h5 id="修改为B-0x0000C1AC-然后再屏幕上点击check，成功弹出welcome-to-kanxue的界面！再接再厉-看看中间都经历了什么步骤。"><a href="#修改为B-0x0000C1AC-然后再屏幕上点击check，成功弹出welcome-to-kanxue的界面！再接再厉-看看中间都经历了什么步骤。" class="headerlink" title="修改为B 0x0000C1AC 然后再屏幕上点击check，成功弹出welcome to kanxue的界面！再接再厉,看看中间都经历了什么步骤。"></a>修改为<code>B 0x0000C1AC</code> 然后再屏幕上点击check，成功弹出welcome to kanxue的界面！再接再厉,看看中间都经历了什么步骤。</h5><p><img src="https://github.com/NULL-ME/NULL-ME.github.io/blob/master/articlePic/iOSCrackme/5.png?raw=true" alt="pic"></p>
<h5 id="0x04-下面进入汇编，第一阶段，根据strlen函数很容易知道，这是在对用户输入的字符串进行长度判断，若不满足情况，直接跳到失败代码。name为14位，serialnumber为8位"><a href="#0x04-下面进入汇编，第一阶段，根据strlen函数很容易知道，这是在对用户输入的字符串进行长度判断，若不满足情况，直接跳到失败代码。name为14位，serialnumber为8位" class="headerlink" title="0x04.下面进入汇编，第一阶段，根据strlen函数很容易知道，这是在对用户输入的字符串进行长度判断，若不满足情况，直接跳到失败代码。name为14位，serialnumber为8位"></a>0x04.下面进入汇编，第一阶段，根据strlen函数很容易知道，这是在对用户输入的字符串进行长度判断，若不满足情况，直接跳到失败代码。<strong><em>name为14位，serialnumber为8位</em></strong></h5><p><img src="https://github.com/NULL-ME/NULL-ME.github.io/blob/master/articlePic/iOSCrackme/6.png?raw=true" alt="pic"></p>
<h5 id="既然是逆向工程，所以先分析下在弹出这个界面前的代码都在做写些什么-r11为我们输入的serialnumber然后可以发现如果栈中的值和serialnumber8次匹配成功就会弹出成功的界面。"><a href="#既然是逆向工程，所以先分析下在弹出这个界面前的代码都在做写些什么-r11为我们输入的serialnumber然后可以发现如果栈中的值和serialnumber8次匹配成功就会弹出成功的界面。" class="headerlink" title="既然是逆向工程，所以先分析下在弹出这个界面前的代码都在做写些什么,r11为我们输入的serialnumber然后可以发现如果栈中的值和serialnumber8次匹配成功就会弹出成功的界面。"></a>既然是逆向工程，所以先分析下在弹出这个界面前的代码都在做写些什么,r11为我们输入的serialnumber然后可以发现如果栈中的值和serialnumber8次匹配成功就会弹出成功的界面。</h5><p><img src="https://github.com/NULL-ME/NULL-ME.github.io/blob/master/articlePic/iOSCrackme/7.png?raw=true" alt="pic"></p>
<h5 id="0x05-一段插曲，不知道是程序自身的原因还是手机的问题，在一步步向下调试的时候，发现内存非法访问，为什么会出现这个问题呢？向上找的时候，发现这样一条指令MOV-PC-PC按理说，根据arm处理器流水线的处理机制，PC会指向当前的下面两条指令，所以执行这条语句后应该会跳到VDUP-8-Q9-R1指令"><a href="#0x05-一段插曲，不知道是程序自身的原因还是手机的问题，在一步步向下调试的时候，发现内存非法访问，为什么会出现这个问题呢？向上找的时候，发现这样一条指令MOV-PC-PC按理说，根据arm处理器流水线的处理机制，PC会指向当前的下面两条指令，所以执行这条语句后应该会跳到VDUP-8-Q9-R1指令" class="headerlink" title="0x05.一段插曲，不知道是程序自身的原因还是手机的问题，在一步步向下调试的时候，发现内存非法访问，为什么会出现这个问题呢？向上找的时候，发现这样一条指令MOV    PC, PC按理说，根据arm处理器流水线的处理机制，PC会指向当前的下面两条指令，所以执行这条语句后应该会跳到VDUP.8    Q9, R1指令."></a>0x05.一段插曲，不知道是程序自身的原因还是手机的问题，在一步步向下调试的时候，发现内存非法访问，为什么会出现这个问题呢？向上找的时候，发现这样一条指令<code>MOV    PC, PC</code>按理说，根据arm处理器流水线的处理机制，PC会指向当前的下面两条指令，所以执行这条语句后应该会跳到<code>VDUP.8    Q9, R1</code>指令.</h5><p><img src="https://github.com/NULL-ME/NULL-ME.github.io/blob/master/articlePic/iOSCrackme/8.png?raw=true" alt="pic"></p>
<h5 id="但是实际情况却是把拆成四条指令，并把r0的值变为了0，导致r2变化，从而非法访问了r2地址的内存。"><a href="#但是实际情况却是把拆成四条指令，并把r0的值变为了0，导致r2变化，从而非法访问了r2地址的内存。" class="headerlink" title="但是实际情况却是把拆成四条指令，并把r0的值变为了0，导致r2变化，从而非法访问了r2地址的内存。"></a>但是实际情况却是把拆成四条指令，并把r0的值变为了0，导致r2变化，从而非法访问了r2地址的内存。</h5><p><img src="https://github.com/NULL-ME/NULL-ME.github.io/blob/master/articlePic/iOSCrackme/9.png?raw=true" alt="pic"><br><img src="https://github.com/NULL-ME/NULL-ME.github.io/blob/master/articlePic/iOSCrackme/10.png?raw=true" alt="pic"></p>
<h5 id="所以为了让r0的值不改变-之前都是通过每次动态修register-write-r0的值，导致每次调试都要在那两处下个断点，浪费了很多时间。后来直接把静态修改重新打包安装到手机，lsls-r0-r0改为nop代替，同理下面还有一处，作相应的修改。"><a href="#所以为了让r0的值不改变-之前都是通过每次动态修register-write-r0的值，导致每次调试都要在那两处下个断点，浪费了很多时间。后来直接把静态修改重新打包安装到手机，lsls-r0-r0改为nop代替，同理下面还有一处，作相应的修改。" class="headerlink" title="所以为了让r0的值不改变,之前都是通过每次动态修register write $r0的值，导致每次调试都要在那两处下个断点，浪费了很多时间。后来直接把静态修改重新打包安装到手机，lsls r0 r0改为nop代替，同理下面还有一处，作相应的修改。"></a>所以为了让r0的值不改变,之前都是通过每次动态修<code>register write $r0</code>的值，导致每次调试都要在那两处下个断点，浪费了很多时间。后来直接把静态修改重新打包安装到手机，<code>lsls r0 r0</code>改为<code>nop</code>代替，同理下面还有一处，作相应的修改。</h5><p><img src="https://github.com/NULL-ME/NULL-ME.github.io/blob/master/articlePic/iOSCrackme/11.png?raw=true" alt="pic"><br><img src="https://github.com/NULL-ME/NULL-ME.github.io/blob/master/articlePic/iOSCrackme/12.png?raw=true" alt="pic"></p>
<h5 id="0x06-回到我们之前的分析，现在开始加密阶段，首先进入的是下面的一个循环"><a href="#0x06-回到我们之前的分析，现在开始加密阶段，首先进入的是下面的一个循环" class="headerlink" title="0x06.回到我们之前的分析，现在开始加密阶段，首先进入的是下面的一个循环"></a>0x06.回到我们之前的分析，现在开始加密阶段，首先进入的是下面的一个循环</h5><p><img src="https://github.com/NULL-ME/NULL-ME.github.io/blob/master/articlePic/iOSCrackme/13.png?raw=true" alt="pic"></p>
<h5 id="r0的值为栈中的某个地址，d18-d19的值为00-0f，然后循环了16次，每次都对d18-d19加一，所以循环结束后在栈中生成了一个16-16大小的矩阵，且值为00-ff"><a href="#r0的值为栈中的某个地址，d18-d19的值为00-0f，然后循环了16次，每次都对d18-d19加一，所以循环结束后在栈中生成了一个16-16大小的矩阵，且值为00-ff" class="headerlink" title="r0的值为栈中的某个地址，d18-d19的值为00-0f，然后循环了16次，每次都对d18-d19加一，所以循环结束后在栈中生成了一个16*16大小的矩阵，且值为00-ff."></a>r0的值为栈中的某个地址，d18-d19的值为00-0f，然后循环了16次，每次都对d18-d19加一，所以循环结束后在栈中生成了一个16*16大小的矩阵，且值为00-ff.</h5><p><img src="https://github.com/NULL-ME/NULL-ME.github.io/blob/master/articlePic/iOSCrackme/14.png?raw=true" alt="pic"></p>
<h5 id="0x07-接着往下面分析，又是一个循环。循环了256次，可以猜测应该是对上面的矩阵进行变换，分析可以发现这个循环通过r9-0xaaaaaaab-和r1相乘结果来对矩阵中的值进行交换。"><a href="#0x07-接着往下面分析，又是一个循环。循环了256次，可以猜测应该是对上面的矩阵进行变换，分析可以发现这个循环通过r9-0xaaaaaaab-和r1相乘结果来对矩阵中的值进行交换。" class="headerlink" title="0x07.接着往下面分析，又是一个循环。循环了256次，可以猜测应该是对上面的矩阵进行变换，分析可以发现这个循环通过r9(0xaaaaaaab)和r1相乘结果来对矩阵中的值进行交换。"></a>0x07.接着往下面分析，又是一个循环。循环了256次，可以猜测应该是对上面的矩阵进行变换，分析可以发现这个循环通过r9(0xaaaaaaab)和r1相乘结果来对矩阵中的值进行交换。</h5><p><img src="https://github.com/NULL-ME/NULL-ME.github.io/blob/master/articlePic/iOSCrackme/15.png?raw=true" alt="pic"></p>
<h5 id="在循环的结束的下一条地址下个断点，打印对应的内存，验证了我们的猜想。"><a href="#在循环的结束的下一条地址下个断点，打印对应的内存，验证了我们的猜想。" class="headerlink" title="在循环的结束的下一条地址下个断点，打印对应的内存，验证了我们的猜想。"></a>在循环的结束的下一条地址下个断点，打印对应的内存，验证了我们的猜想。</h5><p><img src="https://github.com/NULL-ME/NULL-ME.github.io/blob/master/articlePic/iOSCrackme/16.png?raw=true" alt="pic"></p>
<h5 id="我们之前的分析中好像还没有和我们输入的name和serialnumber有什么联系。接着分析，这个循环终于对name进行了存取操作，通过四次循环把name的前四位取出来与之前的矩阵加密后又放回到name的前四位。"><a href="#我们之前的分析中好像还没有和我们输入的name和serialnumber有什么联系。接着分析，这个循环终于对name进行了存取操作，通过四次循环把name的前四位取出来与之前的矩阵加密后又放回到name的前四位。" class="headerlink" title="我们之前的分析中好像还没有和我们输入的name和serialnumber有什么联系。接着分析，这个循环终于对name进行了存取操作，通过四次循环把name的前四位取出来与之前的矩阵加密后又放回到name的前四位。"></a>我们之前的分析中好像还没有和我们输入的name和serialnumber有什么联系。接着分析，这个循环终于对name进行了存取操作，通过四次循环把name的前四位取出来与之前的矩阵加密后又放回到name的前四位。</h5><p><img src="https://github.com/NULL-ME/NULL-ME.github.io/blob/master/articlePic/iOSCrackme/17.png?raw=true" alt="pic"></p>
<h5 id="内存图："><a href="#内存图：" class="headerlink" title="内存图："></a>内存图：</h5><p><img src="https://github.com/NULL-ME/NULL-ME.github.io/blob/master/articlePic/iOSCrackme/18.png?raw=true" alt="pic"></p>
<h5 id="下面这一段有点繁琐，各种跳转，但是并不复杂，就是通过判断加密后的name的长度然后复制到栈中地址r8处。"><a href="#下面这一段有点繁琐，各种跳转，但是并不复杂，就是通过判断加密后的name的长度然后复制到栈中地址r8处。" class="headerlink" title="下面这一段有点繁琐，各种跳转，但是并不复杂，就是通过判断加密后的name的长度然后复制到栈中地址r8处。"></a>下面这一段有点繁琐，各种跳转，但是并不复杂，就是通过判断加密后的name的长度然后复制到栈中地址r8处。</h5><p><img src="https://github.com/NULL-ME/NULL-ME.github.io/blob/master/articlePic/iOSCrackme/19.png?raw=true" alt="pic"></p>
<h5 id="接着又是一个循环，分析可知是对r8即刚才复制加密name后的内存进行每四位反序变换。"><a href="#接着又是一个循环，分析可知是对r8即刚才复制加密name后的内存进行每四位反序变换。" class="headerlink" title="接着又是一个循环，分析可知是对r8即刚才复制加密name后的内存进行每四位反序变换。"></a>接着又是一个循环，分析可知是对r8即刚才复制加密name后的内存进行每四位反序变换。</h5><p><img src="https://github.com/NULL-ME/NULL-ME.github.io/blob/master/articlePic/iOSCrackme/20.png?raw=true" alt="pic"></p>
<h5 id="内存图：-1"><a href="#内存图：-1" class="headerlink" title="内存图："></a>内存图：</h5><p><img src="https://github.com/NULL-ME/NULL-ME.github.io/blob/master/articlePic/iOSCrackme/21.png?raw=true" alt="pic"></p>
<h5 id="keep-going！这一段不是很复杂，就是把刚才变换后的首地址r8向下的64个字节复制到内存栈中-sp-0x50-处。后来得知从这个地址到r8后的内存就是整个栈变化的结束，后面的四个循环并没有进行栈的存操作，只是将这块内存的值取出来加密。"><a href="#keep-going！这一段不是很复杂，就是把刚才变换后的首地址r8向下的64个字节复制到内存栈中-sp-0x50-处。后来得知从这个地址到r8后的内存就是整个栈变化的结束，后面的四个循环并没有进行栈的存操作，只是将这块内存的值取出来加密。" class="headerlink" title="keep going！这一段不是很复杂，就是把刚才变换后的首地址r8向下的64个字节复制到内存栈中[sp 0x50]处。后来得知从这个地址到r8后的内存就是整个栈变化的结束，后面的四个循环并没有进行栈的存操作，只是将这块内存的值取出来加密。"></a>keep going！这一段不是很复杂，就是把刚才变换后的首地址r8向下的64个字节复制到内存栈中[sp 0x50]处。后来得知从这个地址到r8后的内存就是整个栈变化的结束，后面的四个循环并没有进行栈的存操作，只是将这块内存的值取出来加密。</h5><p><img src="https://github.com/NULL-ME/NULL-ME.github.io/blob/master/articlePic/iOSCrackme/22.png?raw=true" alt="pic"></p>
<h5 id="内存图：-2"><a href="#内存图：-2" class="headerlink" title="内存图："></a>内存图：</h5><p><img src="https://github.com/NULL-ME/NULL-ME.github.io/blob/master/articlePic/iOSCrackme/23.png?raw=true" alt="pic"></p>
<h5 id="下面的四个循环很相似，都是将那块内存每次提取80个字节进行加密。刚好有80-4-320与内存块的字节数相同。"><a href="#下面的四个循环很相似，都是将那块内存每次提取80个字节进行加密。刚好有80-4-320与内存块的字节数相同。" class="headerlink" title="下面的四个循环很相似，都是将那块内存每次提取80个字节进行加密。刚好有80*4=320与内存块的字节数相同。"></a>下面的四个循环很相似，都是将那块内存每次提取80个字节进行加密。刚好有80*4=320与内存块的字节数相同。</h5><p><img src="https://github.com/NULL-ME/NULL-ME.github.io/blob/master/articlePic/iOSCrackme/24.png?raw=true" alt="pic"><br><img src="https://github.com/NULL-ME/NULL-ME.github.io/blob/master/articlePic/iOSCrackme/25.png?raw=true" alt="pic"></p>
<h5 id="然后将这之后的寄存器值与对应的值相加spintf按-08x-08x-08x-08x-08x的格式写入栈。"><a href="#然后将这之后的寄存器值与对应的值相加spintf按-08x-08x-08x-08x-08x的格式写入栈。" class="headerlink" title="然后将这之后的寄存器值与对应的值相加spintf按%08x%08x%08x%08x%08x的格式写入栈。"></a>然后将这之后的寄存器值与对应的值相加spintf按%08x%08x%08x%08x%08x的格式写入栈。</h5><p><img src="https://github.com/NULL-ME/NULL-ME.github.io/blob/master/articlePic/iOSCrackme/26.png?raw=true" alt="pic"></p>
<h5 id="最后对栈进行了5次存储，与后面分析可知这段内存就会与serialnumber进行匹配。"><a href="#最后对栈进行了5次存储，与后面分析可知这段内存就会与serialnumber进行匹配。" class="headerlink" title="最后对栈进行了5次存储，与后面分析可知这段内存就会与serialnumber进行匹配。"></a>最后对栈进行了5次存储，与后面分析可知这段内存就会与serialnumber进行匹配。</h5><p><img src="https://github.com/NULL-ME/NULL-ME.github.io/blob/master/articlePic/iOSCrackme/27.png?raw=true" alt="pic"></p>
<h5 id="0x07-根据上面的步骤写出代码，注册机为一个命令行程序，运行程序会提示如数14位的字母和数字的字符串，然后根据此就会生成对应的serialnumber。效果图如下："><a href="#0x07-根据上面的步骤写出代码，注册机为一个命令行程序，运行程序会提示如数14位的字母和数字的字符串，然后根据此就会生成对应的serialnumber。效果图如下：" class="headerlink" title="0x07.根据上面的步骤写出代码，注册机为一个命令行程序，运行程序会提示如数14位的字母和数字的字符串，然后根据此就会生成对应的serialnumber。效果图如下："></a>0x07.根据上面的步骤写出代码，注册机为一个命令行程序，运行程序会提示如数14位的字母和数字的字符串，然后根据此就会生成对应的serialnumber。效果图如下：</h5><p><img src="https://github.com/NULL-ME/NULL-ME.github.io/blob/master/articlePic/iOSCrackme/28.png?raw=true" alt="pic"></p>
<h5 id="在手机中输入生成的name和serialnumber弹出成功的界面！"><a href="#在手机中输入生成的name和serialnumber弹出成功的界面！" class="headerlink" title="在手机中输入生成的name和serialnumber弹出成功的界面！"></a>在手机中输入生成的name和serialnumber弹出成功的界面！</h5><p><img src="https://github.com/NULL-ME/NULL-ME.github.io/blob/master/articlePic/iOSCrackme/29.png?raw=true" alt="pic"></p>

        
      </div>
      <footer>
        
          
          
  
  <div class="tags">
    <a href="/tags/Crackme/">Crackme</a>, <a href="/tags/看雪/">看雪</a>, <a href="/tags/iOS/">iOS</a>
  </div>

          <div class="share">
  

    
      <div class="bdsharebuttonbox"><a href="#" class="bds_twi" data-cmd="twi" title="Share to Twitter"></a><a href="#" class="bds_fbook" data-cmd="fbook" title="Share to Facebook"></a><a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a><a href="#" class="bds_weixin" data-cmd="weixin" title="Share to Wechat"></a><a href="#" class="bds_mail" data-cmd="mail" title="分享到邮件分享"></a><a href="#" class="bds_copy" data-cmd="copy" title="分享到复制网址"></a><a href="#" class="bds_sqq" data-cmd="sqq" title="Share to QQ Friends"></a><a href="#" class="bds_linkedin" data-cmd="linkedin" title="Share to linkedin"></a><a href="#" class="bds_youdao" data-cmd="youdao" title="分享到有道云笔记"></a><a href="#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a><a href="#" class="bds_renren" data-cmd="renren" title="分享到人人网"></a><a href="#" class="bds_douban" data-cmd="douban" title="分享到豆瓣网"></a></div>
	  <script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":["mshare","bdysc","tqq","bdxc","kaixin001","tqf","tieba","douban","tsohu","bdhome","sqq","thx","qq","ibaidu","taobao","hi","baidu","sohu","t163","qy","meilishuo","mogujie","diandian","huaban","leho","share189","duitang","hx","tfh","fx","youdao","sdo","qingbiji","ifeng","people","xinhua","ff","mail","kanshou","isohu","yaolan","wealink","xg","ty","iguba","fbook","twi","deli","s51","s139","linkedin","copy","print"],"bdPic":"","bdStyle":"1","bdSize":"24"},"share":{},"image":{"viewList":["twi","fbook","tsina","weixin","mail","copy","sqq","linkedin","youdao","qzone","renren","douban"],"viewText":"Share to","viewSize":"24"}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>
    

    

    
  
</div>
          

        
        <div class="clearfix"></div>
      </footer>
    </div>
</article>



<nav id="pagination" >
    
    <a href="/2016/12/06/macOS内核框架/macOS内核架构-功能/" class="alignleft prev" >Anterior</a>
    
    
    <div class="clearfix"></div>
</nav>

<section id="comment">
  <h2 class="title">Comentarios</h2>

  

  <!-- 多说评论框 start -->
	<div class="ds-thread" data-thread-key="请将此处替换成文章在你的站点中的ID" data-title="请替换成文章的标题" data-url="请替换成文章的网址"></div>
  <!-- 多说评论框 end -->
  <!-- 多说公共JS代码 start (一个网页只需插入一次) -->
  <script type="text/javascript">
  var duoshuoQuery = {short_name:"datablog"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
  </script>
  <!-- 多说公共JS代码 end -->

  
</section>

</div></div>
    <aside id="sidebar" class="alignright"><div class="padding">
	
	  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" autocomplete="off" name="q" maxlength="20" results="0" placeholder="Buscar">
    <input type="hidden" name="q" value="site:github.com/NULL-ME/NULL-ME.github.io.git">
  </form>
</div>
	
	  
	
	  
<div class="widget recent-post">
  <h3 class="title">Entradas Recientes</h3>
  <ul class="entry">
    
      <li>
        <a href="/2017/04/26/Protostar-堆溢出系列学习-heap 3/Protostar-堆溢出系列学习-heap 3/">Protostar-堆溢出学习-滥用堆metadata重定向程序执行</a>
      </li>
    
      <li>
        <a href="/2017/04/23/Linux堆分配器-DLMalloc/Linux堆分配器-DLMalloc/">深入理解Linux堆分配器-DLMalloc</a>
      </li>
    
      <li>
        <a href="/2017/04/21/Protostar-堆溢出系列学习-heap 2/Protostar-堆溢出系列学习-heap 2/">Protostar-堆溢出学习-UAF(use after free)</a>
      </li>
    
      <li>
        <a href="/2017/04/19/Protostar-堆溢出系列学习-heap 1/Protostar-堆溢出系列学习-heap 1/">Protostar-堆溢出学习-strcpy堆指针造成任意地址GOT表写</a>
      </li>
    
      <li>
        <a href="/2017/04/18/Protostar-堆溢出系列学习-heap 0/Protostar-堆溢出系列学习-heap 0/">Protostar-堆溢出学习-覆盖堆函数指针劫持代码流</a>
      </li>
    
  </ul>
</div>

	
	  
<div class="widget tagcloud">
  <h3 class="title">Nube de Etiquetas</h3>
  <div class="entry">
    <a href="../../../../../tags/BSD/" style="font-size: 10px;">BSD</a> <a href="../../../../../tags/C/" style="font-size: 10px;">C++</a> <a href="../../../../../tags/Crackme/" style="font-size: 10px;">Crackme</a> <a href="../../../../../tags/DLMalloc/" style="font-size: 10px;">DLMalloc</a> <a href="../../../../../tags/GOT表/" style="font-size: 10px;">GOT表</a> <a href="../../../../../tags/IPC/" style="font-size: 10px;">IPC</a> <a href="../../../../../tags/Linux/" style="font-size: 20px;">Linux</a> <a href="../../../../../tags/Protostar/" style="font-size: 20px;">Protostar</a> <a href="../../../../../tags/UAF/" style="font-size: 10px;">UAF</a> <a href="../../../../../tags/cve/" style="font-size: 10px;">cve</a> <a href="../../../../../tags/dyld/" style="font-size: 10px;">dyld</a> <a href="../../../../../tags/format/" style="font-size: 10px;">format</a> <a href="../../../../../tags/free/" style="font-size: 10px;">free</a> <a href="../../../../../tags/gdb/" style="font-size: 10px;">gdb</a> <a href="../../../../../tags/heap/" style="font-size: 10px;">heap</a> <a href="../../../../../tags/iOS/" style="font-size: 10px;">iOS</a> <a href="../../../../../tags/linux/" style="font-size: 13.33px;">linux</a> <a href="../../../../../tags/macOS内核/" style="font-size: 10px;">macOS内核</a> <a href="../../../../../tags/mach/" style="font-size: 10px;">mach</a> <a href="../../../../../tags/mach-o/" style="font-size: 10px;">mach-o</a> <a href="../../../../../tags/macos内核/" style="font-size: 10px;">macos内核</a> <a href="../../../../../tags/malloc/" style="font-size: 10px;">malloc</a> <a href="../../../../../tags/metadata/" style="font-size: 10px;">metadata</a> <a href="../../../../../tags/printf/" style="font-size: 10px;">printf</a> <a href="../../../../../tags/strcpy/" style="font-size: 10px;">strcpy</a> <a href="../../../../../tags/stub/" style="font-size: 10px;">stub</a> <a href="../../../../../tags/vm/" style="font-size: 13.33px;">vm</a> <a href="../../../../../tags/vtable/" style="font-size: 10px;">vtable</a> <a href="../../../../../tags/xnu/" style="font-size: 10px;">xnu</a> <a href="../../../../../tags/堆溢出/" style="font-size: 16.67px;">堆溢出</a> <a href="../../../../../tags/栈溢出/" style="font-size: 16.67px;">栈溢出</a> <a href="../../../../../tags/看雪/" style="font-size: 10px;">看雪</a> <a href="../../../../../tags/调试/" style="font-size: 10px;">调试</a>
  </div>
</div>

	
	  <iframe width="100%" height="120" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=550&fansRow=2&ptype=1&speed=0&skin=10&isTitle=1&noborder=1&isWeibo=0&isFans=0&uid=5594792135&verifier=676ff25e&dpc=1"></iframe>
	
	  <div class="widget category">
	<h3 class="title">Link</h3>
	<ul class="entry">
		
        	<li><a href="https://www.google.com/">Google</a></li>
      	
        	<li><a href="https://github.com/">Github</a></li>
      	
        	<li><a href="http://hijiangtao.github.io/">hijiangtao</a></li>
      	
	</ul>
</div>
	
</div></aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="padding">
	<div class="alignleft">
	  
	  Copyright&copy;2013-2017 <a href=" / ">4chendy</a>
	  
	  | Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
	  and Theme by <a href="https://github.com/hijiangtao/dark-tech/" target="_blank">Dark-Tech</a> | <script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1000257487'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s96.cnzz.com/z_stat.php%3Fid%3D1000257487' type='text/javascript'%3E%3C/script%3E"));</script>
	</div>

	<div class="alignright">
		
		
			<a href="https://github.com/https://github.com/hijiangtao" target="_blank" title="4chendy Github"><i class="fa fa-github-square"></i></a>	
		
		
		
			<a href="http://www.weibo.com/http://weibo.com/hijiangtao" target="_blank" title="4chendy Weibo"><i class="fa fa-weibo"></i></a>	
		
		
		
		
			<a href="/dark-tech/atom.xml" target="_blank" title="4chendy RSS"><i class="fa fa-rss-square"></i></a>
		
	</div>

	<div class="clearfix"></div>
</div>

<div class="scroll-top"><i class="fa fa-arrow-circle-up"></i></div>
</footer>
  

<script type="text/javascript">
var duoshuoQuery = {short_name:"datablog"};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = 'http://static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script>



<script src="//cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/3.0.4/jquery.imagesloaded.js"></script>
<script src="/js/gallery.js"></script>



<script type="text/javascript">
$(window).scroll(function() {

    if($(this).scrollTop() > 400) {
        $('.scroll-top').fadeIn(200);
    } else {
        $('.scroll-top').fadeOut(200);
    }
});

$('.scroll-top').bind('click', function(e) {
    e.preventDefault();
    $('body,html').animate({scrollTop:0},200);
});
</script>

</body>
</html>
