
 <!DOCTYPE HTML>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
  
    <title>X86指令编码笔记 | 4ch12dy</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=3, minimum-scale=1">
    
    <meta name="author" content="4ch12dy">
    
    <meta name="description" content="由于重装系统同步导致原文章消失，只能再写一遍，方便以后查阅。

x86指令编码格式很多时候我们都是查阅指令参考页去了解一个指令的含义，但这并不能理解指令的编码格式。而只有学会看懂opcode表的时候才是王道。
x86是一种CISC指令集，CISC的全称是“Complex Instruction Se">
    
    
    
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/pacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/pacman.jpg">
    
    <link rel="stylesheet" href="../../../../../css/style.css">
</head>

  <body>
    <header>
      <div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.svg" alt="4ch12dy" title="4ch12dy"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="4ch12dy">4ch12dy</a></h1>
				<h2 class="blog-motto">当梦想全都被take away</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="Menu">
			</a></div>
			<nav class="animated">
				<ul>
					
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
					<li>
					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="text" id="search" name="q" autocomplete="off" maxlength="20" placeholder="Search" />
						<input type="hidden" name="q" value="site:github.com/4ch12dy/4ch12dy.github.io.git">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>

    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/10/11/x86指令编码笔记/X86指令编码笔记/" title="X86指令编码笔记" itemprop="url">X86指令编码笔记</a>
  </h1>
  <p class="article-author">By
    
      <a href="https://github.com/4ch12dy/4ch12dy.github.io.git" title="4ch12dy">4ch12dy</a>
    </p>
  <p class="article-time">
    <time datetime="2017-10-11T03:46:13.000Z" itemprop="datePublished">2017-10-11</time>
    Updated:<time datetime="2017-10-16T04:09:00.000Z" itemprop="dateModified">2017-10-16</time>
    
  </p>
</header>
	<div class="article-content">
		
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">Contents</strong>
		<ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#x86指令编码格式"><span class="toc-number">1.</span> <span class="toc-text">x86指令编码格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#指令prefix"><span class="toc-number">2.</span> <span class="toc-text">指令prefix</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#REX-prefix—开启-64-位计算的基石"><span class="toc-number">2.1.</span> <span class="toc-text">REX prefix—开启 64 位计算的基石</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#寄存器编码表"><span class="toc-number">2.1.1.</span> <span class="toc-text">寄存器编码表</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#opcode"><span class="toc-number">3.</span> <span class="toc-text">opcode</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ModR-M"><span class="toc-number">4.</span> <span class="toc-text">ModR/M</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SIB"><span class="toc-number">5.</span> <span class="toc-text">SIB</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Displacement-和-Immediate"><span class="toc-number">6.</span> <span class="toc-text">Displacement 和 Immediate</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#综合起来，看下面的例子："><span class="toc-number">7.</span> <span class="toc-text">综合起来，看下面的例子：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#参考及索引"><span class="toc-number">8.</span> <span class="toc-text">参考及索引</span></a></li></ol>
		</div>
		
		<blockquote>
<p>由于重装系统同步导致原文章消失，只能再写一遍，方便以后查阅。</p>
</blockquote>
<h3 id="x86指令编码格式"><a href="#x86指令编码格式" class="headerlink" title="x86指令编码格式"></a>x86指令编码格式</h3><p>很多时候我们都是查阅指令参考页去了解一个指令的含义，但这并不能理解指令的编码格式。而只有学会看懂opcode表的时候才是王道。</p>
<p>x86是一种CISC指令集，CISC的全称是“Complex Instruction Set Computer”，表示的是一种复杂的指令集，其中一个最重要的复杂性在于在这个指令集中，指令是不定长的，要使得CPU在这种不定长的指令集里面确定每一条指令的含义，就需要一种特定的指令格式，下图显示了<code>Intel 64</code>和<code>IA-32</code>架构下的指令格式，当然，这两种架构所采用的都是x86指令编码：</p>
<p><img src="https://github.com/4ch12dy/4ch12dy.github.io/blob/master/articlePic/X86%E6%8C%87%E4%BB%A4%E7%BC%96%E7%A0%81%E7%AC%94%E8%AE%B0/%E6%8C%87%E4%BB%A4%E7%BC%96%E7%A0%81%E6%A0%BC%E5%BC%8F.png?raw=true" alt="指令编码格式"></p>
<p>从上面可以看出，x86指令格式中，由6部分组成，但在这之中只有opcode是必须的，其余都是可选。我们稍后就介绍这些组成部分。</p>
<h3 id="指令prefix"><a href="#指令prefix" class="headerlink" title="指令prefix"></a>指令prefix</h3><p>prefix简单的说来就是调整内存操作数属性，增强指令的作用等。</p>
<ul>
<li><p><code>lock</code> 和 <code>repeat</code></p>
<p>其中，LOCK prefix保证该条指令对共享内存的访问是独占的；而repeat prefixes 表示这条指令会重复执行多次，直到某个条件满足位置。其中第二种repeat prefix只能用在对string的操作，或者对I/O的操作上。</p>
</li>
<li><p><code>operand-size override</code> （<strong>66H </strong>— 改变默认操作数大小）</p>
<p>这个prefix主要是在解析指令的操作数的时候，可以在十六位或者三十二位的操作数大小间进行切换。</p>
<p><img src="https://github.com/4ch12dy/4ch12dy.github.io/blob/master/articlePic/X86%E6%8C%87%E4%BB%A4%E7%BC%96%E7%A0%81%E7%AC%94%E8%AE%B0/operand_size_override.png?raw=true" alt="operand_size_override"></p>
</li>
<li><p><code>address-size override</code> （<strong>67H</strong> — 改变默认操作数地址大小）</p>
<p>这个prefix主要是在进行指令寻址的时候，可以在十六位或者三十二位的地址大小中进行切换。</p>
<p><img src="https://github.com/4ch12dy/4ch12dy.github.io/blob/master/articlePic/X86%E6%8C%87%E4%BB%A4%E7%BC%96%E7%A0%81%E7%AC%94%E8%AE%B0/address_override.png?raw=true" alt="address_override"></p>
</li>
<li><p><code>segment override</code>，<code>branch hints</code> 和 <code>bound</code></p>
<p>其中，segment override prefix会在执行这条指令的时候将默认的段寄存器给换掉；branch hints prefix主要应用在条件跳转指令（Jcc）中，可以协助CPU进行指令的prefetch；而bound prefix主要是用intel MPX硬件特性上。</p>
<p>​</p>
<p>| 2E          | 3E          | 26          | 64          | 65          | 36          |<br>| ———– | ———– | ———– | ———– | ———– | ———– |<br>| CS register | DS register | ES register | FS register | GS register | SS register |</p>
</li>
</ul>
<h4 id="REX-prefix—开启-64-位计算的基石"><a href="#REX-prefix—开启-64-位计算的基石" class="headerlink" title="REX prefix—开启 64 位计算的基石"></a>REX prefix—开启 64 位计算的基石</h4><p>REX prefix 是不定值，它的取值范围是：40 - 4F （共 16 个）</p>
<table>
<thead>
<tr>
<th>7</th>
<th>6</th>
<th>5</th>
<th>4</th>
<th>3</th>
<th>2</th>
<th>1</th>
<th>0</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>W</td>
<td>R</td>
<td>X</td>
<td>B</td>
</tr>
</tbody>
</table>
<ul>
<li>W: operand width 标志位，当 W = 0 时使用 default operand size,当 W = 1 时使用 64 位 operand size</li>
<li>R: 用来扩展 ModRM.reg 域</li>
<li>X: 用来扩展 SIB.index 域</li>
<li>B: 用来扩展 SIB.base, ModRM.r/m 以及 Opcode.reg</li>
</ul>
<h5 id="寄存器编码表"><a href="#寄存器编码表" class="headerlink" title="寄存器编码表"></a>寄存器编码表</h5><p><img src="https://github.com/4ch12dy/4ch12dy.github.io/blob/master/articlePic/X86%E6%8C%87%E4%BB%A4%E7%BC%96%E7%A0%81%E7%AC%94%E8%AE%B0/register_table.png?raw=true" alt="register_table"></p>
<p>下面来分析这条指令：</p>
<p><code>mov eax,ebx</code></p>
<p>正常编码为：<code>89 d8</code>  下面看看在不同的<code>REX.W</code>和<code>66H prefix</code>下的不同：</p>
<ul>
<li><p><code>48 89 d8</code>——————&gt; <code>mov rax,rbx</code></p>
</li>
<li><p><code>66 48 89 d8</code>—————&gt; <code>mov rax,rbx</code></p>
</li>
<li><p><code>66 40 89 d8</code>—————&gt; <code>mov ax, bx</code></p>
<p>​</p>
</li>
</ul>
<p>第 1 条指令编码使用 REX prefix 扩展访问 64 位寄存器，<strong>REX.W = 1</strong></p>
<p>第 2 条指令编码加上了 <strong>66H prefix</strong> 同时还有 REX prefix（<strong>REX.W = 1</strong>），此时一般会认为产生了冲突：是使用 64 位还是 16 位 operand size 呢？<br>实际上，很简单！<strong>48H 位于 66H 后面，66H 将被覆盖！</strong>也就是说：66H prefix 将会被忽略，REX prefix 产生了作用！因此：指令的 <strong>operand size 是 64 位</strong>的。</p>
<p>第 3 条指令编码也同样使用了 <strong>66H prefix </strong>和 <strong>REX prefix</strong>，但是 <strong>REX.W = 0</strong> 意味着不改变原来的 operand size！<br>在这种情况下，<strong>REX prefix 不会与 66H prefix 产生冲突</strong>，最终的作用于 66H prefix，因此 <strong>operand size 是 16 位</strong>的。</p>
<h3 id="opcode"><a href="#opcode" class="headerlink" title="opcode"></a>opcode</h3><p>整个编码中opcode是必须的，因为代表着这条指令的含义，整个指令的核心，且prefix与Opcode共享00~FF的空间。</p>
<p>一个opcode可以由一个byte组成，我们称之为<code>1-byte opcode</code>，当然，与之对应的，就有<code>2-bytes opcode</code>和<code>3-bytes opcode</code>。其中，后两者一般会有一个被称为<code>escape opcode</code>的byte进行引导，该byte的数值是<code>0FH</code>。所以，一般情况下，<code>2-bytes opcode</code>就是<code>0FH</code>后面再加一个byte，而<code>3-bytes opcode</code>就是<code>0FH</code>后面再加两个bytes。</p>
<h3 id="ModR-M"><a href="#ModR-M" class="headerlink" title="ModR/M"></a>ModR/M</h3><p>ModRM在指令中非常重要，是理解x86平台opcode的关键，决定着寻址模式。</p>
<p>由一个byte组成，其格式如下：</p>
<table>
<thead>
<tr>
<th>7 6</th>
<th>5 4 3</th>
<th>2 1 0</th>
</tr>
</thead>
<tbody>
<tr>
<td>mod</td>
<td>reg</td>
<td>R/M</td>
</tr>
</tbody>
</table>
<p><strong>1、mod：寻址模式。</strong><br>　　2位组成4种寻址模式，总的来说，只有两种寻址模式，就是：内存寻址模式和寄存器寻址模式。</p>
<ul>
<li>mod = 11指出寄存器寻址模式，mod = 00 ~ 10 时指出内存寻址模式：</li>
</ul>
<ul>
<li>mod = 00，定义 [register] 间接寻址，无displacement值。</li>
<li>mod = 01，定义 [register + disp8]，有8位displacemnet 偏移值。</li>
<li>mod = 10，定义 [register + disp32]，有32位displacement偏移值。</li>
</ul>
<p><strong>2、reg：寄存器ID值</strong><br>　　3位组成8个寄存器ID值，从 000 ~ 111，对应于 RAX、RCX、RDX、RBX、RSP、RBP、RSI以及RDI。这个ID值可以被REX prefix扩充为4位，范围从 0000 ~ 1111可表示16个寄存器。</p>
<p>reg域的另一含义是对Opcode的补充，对分为一组Opcode的进行选择（Group属性）。</p>
<p><strong>3、r/m：意即register / memory。</strong></p>
<p>​     提供对registers或memory的寻址，也用来表示寄存器ID，当是registers时是寄存器ID值。当是memory时是寄存器间接寻址中的寄存器ID值。当mod != 11 时，r/m 表示 [rax] ~ [rdi]，REX prefix用来扩充寄存器ID值。</p>
<blockquote>
<p>注意:</p>
<p>(1) 如果像这条指令：mov eax, [eax+ecx<em>2+0x0c] 在这条指令里eax是base寄存器，ecx是Index寄存器，2是scale，还有一个displacement ,这种内存寻址是base+index</em>scale+disp。这需要SIB字节来进行确定，那么ModRM必须要有一个手段来引出后续的SIB字节。在 [rax] ~ [rdi] 的范围里，Intel选择了原来应属于 [rsp] 的值用来引出SIB，一是因为 [rsp] 并不常用吧。二是因为 rsp 设计为 stack top指针，专用于stack top指针。<br>　　原来属于 [rsp] 的领域对应的，r/m是100，这个领域被 [SIB] 替代了，事实上在16位机器原本是没有SIB字节的，base+index*scale+disp这种寻址是后来才增加的。16位的ModRM上是没有SIB引导域。</p>
<p>(2)如果内存寻址中没有base和index，只有disp的话，如：mov ebx, [0x11223344]，这种直接寻址方式，在设计上ModRM还必须为提供这个模式。<br>　　Intel又作出修改，选择了原来属于 [rbp] 模式的领域提供给 [disp]，选择 [rbp] 让给 [disp]，是因为 rbp 原本意图就是设计为 stack基址指针。[rbp] 寻址一般都要加上一个偏移量，也就是基于stack frame指针的偏移量，即 [ebp + disp] 这种寻址模式在 mod = 01 或 mod = 10 中给出。</p>
</blockquote>
<h3 id="SIB"><a href="#SIB" class="headerlink" title="SIB"></a>SIB</h3><p>SIB意即：Scale – Index – Base，用来定义base+index*scale+disp这种寻址模式。同样按2-3-3比例组合。</p>
<table>
<thead>
<tr>
<th>7-6</th>
<th>5-4-3</th>
<th>2-1-0</th>
</tr>
</thead>
<tbody>
<tr>
<td>scale</td>
<td>index</td>
<td>base</td>
</tr>
</tbody>
</table>
<p>index 域指出index寄存器的ID值，范围从 000 ~ 111。base 域指出base寄存器的ID 值，从 000 ~ 111。Index与base经过 REX prefix可以扩展为0000 ~ 1111。</p>
<h3 id="Displacement-和-Immediate"><a href="#Displacement-和-Immediate" class="headerlink" title="Displacement 和 Immediate"></a>Displacement 和 Immediate</h3><p>某些指令会在最后要求有一个用于计算内存地址的值，或者一个立即数。很明显，不多说。</p>
<h3 id="综合起来，看下面的例子："><a href="#综合起来，看下面的例子：" class="headerlink" title="综合起来，看下面的例子："></a>综合起来，看下面的例子：</h3><ul>
<li><p><code>49 8b 7d 00</code></p>
<p>49=0100 1001对应REX prefix,默认64为size模式</p>
<p>8b= mov opcode</p>
<p>7d=01 111 101—&gt;ModR/M   mod = 01，定义 [register + disp8]，有8位displacemnet 偏移值。rdi ,r13</p>
<p>00=Displacement = 0</p>
<p>所以指令= mov rdi,QWORD PTR [r13+0]—&gt;mov rdi,[r13]</p>
<p>​</p>
</li>
</ul>
<h3 id="参考及索引"><a href="#参考及索引" class="headerlink" title="参考及索引"></a>参考及索引</h3><p><a href="http://ref.x86asm.net/coder32.html" target="_blank" rel="external">http://ref.x86asm.net/coder32.html </a>—-&gt; 查阅opcode</p>
<p><a href="http://pnx.tf/files/x86_opcode_structure_and_instruction_overview.png" target="_blank" rel="external">http://pnx.tf/files/x86_opcode_structure_and_instruction_overview.png</a> —&gt;quick look</p>
<p><a href="http://sparksandflames.com/files/x86InstructionChart.html" target="_blank" rel="external">Intel x86 Assembler Instruction Set Opcode Table</a></p>
<p><a href="http://www.mouseos.com/x64/index.html" target="_blank" rel="external">http://www.mouseos.com/x64/index.html</a></p>
<p><a href="https://bbs.pediy.com/thread-78121.htm" target="_blank" rel="external">https://bbs.pediy.com/thread-78121.htm</a></p>
<p><a href="http://ytliu.info/blog/2016/12/10/x86zhi-ling-bian-ma-de-na-xie-shi-er/" target="_blank" rel="external">X86指令编码的那些事儿</a></p>
<p><a href="http://subler.github.io/note/compiler/x86_instruction_encode.html" target="_blank" rel="external">http://subler.github.io/note/compiler/x86_instruction_encode.html</a></p>
<p><a href="https://www.onlinedisassembler.com/odaweb/strcpy_x86" target="_blank" rel="external">onlineDisassembler</a></p>
  
	</div>
		<footer class="article-footer clearfix">

  <div class="article-tags">
  
  <span></span> <a href="/tags/x86/">x86</a>
  </div>


<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="../../../../../categories/杂/">杂</a>
</div>



<div class="article-share" id="share">

  <div data-url="https://github.com/4ch12dy/4ch12dy.github.io.git/2017/10/11/x86指令编码笔记/X86指令编码笔记/" data-title="X86指令编码笔记 | 4ch12dy" data-tsina="null" class="share clearfix">
  </div>

</div>
</footer>   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2017/11/28/Android_JNI_掉坑笔记 /JNI/" title="Android JNI踩坑笔记">
  <strong>PREVIOUS:</strong><br/>
  <span>
  Android JNI踩坑笔记</span>
</a>
</div>


<div class="next">
<a href="/2017/08/10/一种用户层与kext内核扩展交互方式/一种用户层与kext内核扩展交互方式/"  title="一种用户层与kext内核扩展交互方式">
 <strong>NEXT:</strong><br/> 
 <span>一种用户层与kext内核扩展交互方式
</span>
</a>
</div>

</nav>

	
</div>  
      <div class="openaside"><a class="navbutton" href="#" title="Show Sidebar"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">Contents</strong>
  <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#x86指令编码格式"><span class="toc-number">1.</span> <span class="toc-text">x86指令编码格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#指令prefix"><span class="toc-number">2.</span> <span class="toc-text">指令prefix</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#REX-prefix—开启-64-位计算的基石"><span class="toc-number">2.1.</span> <span class="toc-text">REX prefix—开启 64 位计算的基石</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#寄存器编码表"><span class="toc-number">2.1.1.</span> <span class="toc-text">寄存器编码表</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#opcode"><span class="toc-number">3.</span> <span class="toc-text">opcode</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ModR-M"><span class="toc-number">4.</span> <span class="toc-text">ModR/M</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SIB"><span class="toc-number">5.</span> <span class="toc-text">SIB</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Displacement-和-Immediate"><span class="toc-number">6.</span> <span class="toc-text">Displacement 和 Immediate</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#综合起来，看下面的例子："><span class="toc-number">7.</span> <span class="toc-text">综合起来，看下面的例子：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#参考及索引"><span class="toc-number">8.</span> <span class="toc-text">参考及索引</span></a></li></ol>
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="Hide Sidebar"></a></div>
<aside class="clearfix">

  
<div class="categorieslist">
	<p class="asidetitle">Categories</p>
		<ul>
		
			<li><a href="/categories/C/" title="C++">C++<sup>2</sup></a></li>
		
			<li><a href="/categories/CTF/" title="CTF">CTF<sup>1</sup></a></li>
		
			<li><a href="/categories/Linux堆栈漏洞学习系列/" title="Linux堆栈漏洞学习系列">Linux堆栈漏洞学习系列<sup>10</sup></a></li>
		
			<li><a href="/categories/iOS-macOS内核漏洞分析/PoC分析/" title="PoC分析">PoC分析<sup>1</sup></a></li>
		
			<li><a href="/categories/XNU/" title="XNU">XNU<sup>1</sup></a></li>
		
			<li><a href="/categories/iOS-macOS内核漏洞分析/" title="iOS&amp;macOS内核漏洞分析">iOS&amp;macOS内核漏洞分析<sup>1</sup></a></li>
		
			<li><a href="/categories/kext-iokit/" title="kext/iokit">kext/iokit<sup>1</sup></a></li>
		
			<li><a href="/categories/llvm/" title="llvm">llvm<sup>1</sup></a></li>
		
			<li><a href="/categories/macOS内核知识点/" title="macOS内核知识点">macOS内核知识点<sup>1</sup></a></li>
		
			<li><a href="/categories/macho-dyld/" title="macho/dyld">macho/dyld<sup>1</sup></a></li>
		
			<li><a href="/categories/一点一点/" title="一点一点">一点一点<sup>1</sup></a></li>
		
			<li><a href="/categories/关于数学/" title="关于数学">关于数学<sup>1</sup></a></li>
		
			<li><a href="/categories/杂/" title="杂">杂<sup>2</sup></a></li>
		
			<li><a href="/categories/看雪/" title="看雪">看雪<sup>1</sup></a></li>
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">Tags</p>
		<ul class="clearfix">
		
			<li><a href="/tags/BSD/" title="BSD">BSD<sup>1</sup></a></li>
		
			<li><a href="/tags/C/" title="C++">C++<sup>2</sup></a></li>
		
			<li><a href="/tags/CTF/" title="CTF">CTF<sup>1</sup></a></li>
		
			<li><a href="/tags/CVE-2016-4655/" title="CVE-2016-4655">CVE-2016-4655<sup>1</sup></a></li>
		
			<li><a href="/tags/CVE-2016-4656/" title="CVE-2016-4656">CVE-2016-4656<sup>1</sup></a></li>
		
			<li><a href="/tags/Crackme/" title="Crackme">Crackme<sup>1</sup></a></li>
		
			<li><a href="/tags/DLMalloc/" title="DLMalloc">DLMalloc<sup>1</sup></a></li>
		
			<li><a href="/tags/GOT表/" title="GOT表">GOT表<sup>1</sup></a></li>
		
			<li><a href="/tags/Kernel/" title="Kernel">Kernel<sup>1</sup></a></li>
		
			<li><a href="/tags/LLDB/" title="LLDB">LLDB<sup>1</sup></a></li>
		
			<li><a href="/tags/Linux/" title="Linux">Linux<sup>9</sup></a></li>
		
			<li><a href="/tags/Pegasus/" title="Pegasus">Pegasus<sup>1</sup></a></li>
		
			<li><a href="/tags/PoC/" title="PoC">PoC<sup>1</sup></a></li>
		
			<li><a href="/tags/Protostar/" title="Protostar">Protostar<sup>9</sup></a></li>
		
			<li><a href="/tags/SSD/" title="SSD">SSD<sup>1</sup></a></li>
		
			<li><a href="/tags/UAF/" title="UAF">UAF<sup>1</sup></a></li>
		
			<li><a href="/tags/XNU/" title="XNU">XNU<sup>1</sup></a></li>
		
			<li><a href="/tags/android/" title="android">android<sup>1</sup></a></li>
		
			<li><a href="/tags/cve/" title="cve">cve<sup>1</sup></a></li>
		
			<li><a href="/tags/dyld/" title="dyld">dyld<sup>2</sup></a></li>
		
		</ul>
</div>


  <div class="rsspart">
	<a href="null" target="_blank" title="rss">RSS</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<div class="social-font clearfix">
		
		
		
		
		
	</div>
		<p class="copyright">Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/A-limon/pacman" target="_blank" title="Pacman">Pacman</a> © 2019 
		
		<a href="https://github.com/4ch12dy/4ch12dy.github.io.git" target="_blank" title="4ch12dy">4ch12dy</a>
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.1.0.min.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else
    {
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      h  = $('article h2')
      ah = $('article h2'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  if(ah.length==0){
    t.css('display','none');
  }else{
    c.click(function(){
      ta.css('display', 'block').addClass('fadeIn');
    });
    o.click(function(){
      ta.css('display', 'none');
    });
    $(window).scroll(function(){
      ta.css("top",Math.max(140,320-$(this).scrollTop()));
    });
  };
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina');
  var html = [
  '<a href="#" class="overlay" id="qrcode"></a>',
  '<div class="qrcode clearfix"><span>扫描二维码分享到微信朋友圈</span><a class="qrclose" href="#share"></a><strong>Loading...Please wait</strong><img id="qrcode-pic" data-src="http://s.jiathis.com/qrcode.php?url=' + encodedUrl + '"/></div>',
  '<a href="#textlogo" class="article-back-to-top" title="Top"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="QRcode"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="Weibo"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);
  $('.article-share-qrcode').click(function(){
    var imgSrc = $('#qrcode-pic').attr('data-src');
    $('#qrcode-pic').attr('src', imgSrc);
    $('#qrcode-pic').load(function(){
        $('.qrcode strong').text(' ');
    });
  });
});     
</script>






  </body>
</html>
