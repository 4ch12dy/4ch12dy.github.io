<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>4ch12dy</title>
  
  <subtitle>当梦想全都被take away</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://github.com/4ch12dy/4ch12dy.github.io.git/"/>
  <updated>2020-02-28T10:55:45.179Z</updated>
  <id>https://github.com/4ch12dy/4ch12dy.github.io.git/</id>
  
  <author>
    <name>4ch12dy</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Step into Jailbreak and dyld</title>
    <link href="https://github.com/4ch12dy/4ch12dy.github.io.git/2020/02/28/step-into-jailbreak-over-night/step-into-jailbreak-over-night/"/>
    <id>https://github.com/4ch12dy/4ch12dy.github.io.git/2020/02/28/step-into-jailbreak-over-night/step-into-jailbreak-over-night/</id>
    <published>2020-02-28T08:45:20.000Z</published>
    <updated>2020-02-28T10:55:45.179Z</updated>
    
    <content type="html"><![CDATA[<h2><a href="#step-into-jailbreak-and-dyld" class="header-anchor">#</a><span id="step-into-jailbreak-and-dyld">Step into Jailbreak and dyld</span></h2><blockquote><p>本文以coolstar系越狱为基础讨论</p></blockquote><h3><a href="#bei-jing" class="header-anchor">#</a><span id="bei-jing">背景</span></h3><p>本文由<a href="http://4ch12dy.site/2020/02/26/lldb-how-to-dump-gracefully/lldb-how-to-dump-gracefully/" target="_blank" rel="external"><strong>如何优雅的在LLDB里dumpdecrypted</strong></a>中tweak loader优先初始化的一个思考而来，里面提出了一个疑问在于，tweak loader到底何时加载到进程以及何时被初始化的。而在去探索这个答案的过程中，发现背后涉及到的却是和整个越狱相关，正好借此去深入了解越狱的相关细节。</p><h3><a href="#tweak-loader" class="header-anchor">#</a><span id="tweak-loader">Tweak loader</span></h3><p>我最开始搜到的源码是：<a href="https://github.com/chr1s0x1/TweakInject">https://github.com/chr1s0x1/TweakInject</a> </p><p>代码本身很简单，就是去<code>/Library/MobileSubstrate/DynamicLibraries</code>下面去搜索，通过plist文件里面的字段决定是否将dylib加载到当前进程中，就和平时开发tweak去hook那些app的过程一样。不过我感到疑问的地方在于那本身这个tweak loader dylib又是谁以及何时被加载到进程中的呢。这里不难想到应该就是越狱后支持hook环境相关，所以我又去翻阅相关越狱源码。</p><h3><a href="#electra" class="header-anchor">#</a><span id="electra">Electra</span></h3><p>我研究的越狱源码是：<a href="https://github.com/coolstar/electra">https://github.com/coolstar/electra</a></p><p>至于为什么会选择Electra，而且是早期的一个版本？有以下几点原因：</p><ul><li>coolstar由于在开发Electra后saurik没有提供substrate的支持，所以后面自己实现了完整的hook环境，这里面很多东西都是重新研究实现的，保留了很多当时的曲折过程，而这些恰好很便于去学习。</li><li>代码开源，而且早期一切都是以实用为主，代码都比较有代表性。</li></ul><h4><a href="#pspawn-payload" class="header-anchor">#</a><span id="pspawn-payload">pspawn_payload</span></h4><p>回到之前的问题，tweak loader是谁负责加载的呢？最直接相关的代码在:</p><p><a href="https://github.com/coolstar/electra/blob/master/basebinaries/pspawn_payload/pspawn_payload.m">https://github.com/coolstar/electra/blob/master/basebinaries/pspawn_payload/pspawn_payload.m</a></p><p>代码里面的<code>SBInject.dylib</code>就是tweak loader，如下</p><pre><code class="c">#define SBINJECT_PAYLOAD_DYLIB &quot;/usr/lib/SBInject.dylib&quot;</code></pre><p>这个模块叫做<code>pspawn_payload</code>，你在coolstar系越狱里进程模块里面就会有这个模块名。</p><p>下面是该模块初始化的代码</p><pre><code class="c">__attribute__ ((constructor))static void ctor(void) {    if (getpid() == 1) {        current_process = PROCESS_LAUNCHD;        pthread_t thd;        pthread_create(&amp;thd, NULL, thd_func, NULL);    } else {        current_process = PROCESS_XPCPROXY;        rebind_pspawns();    }}</code></pre><p>代码就是如果当前进程不是launchd，就hook pspawns函数。pspawns正是创建一个新进程的函数，所以hook以后会在创建前注入dylib。下面简单列举里面几个关键地方的代码</p><pre><code class="c">int fake_posix_spawn_common(pid_t * pid, const char* path, const posix_spawn_file_actions_t *file_actions, posix_spawnattr_t *attrp, char const* argv[], const char* envp[], pspawn_t old) {    ...    if (strcmp(path, &quot;/usr/libexec/amfid&quot;) == 0) {        DEBUGLOG(&quot;Starting amfid -- special handling&quot;);        inject_me = AMFID_PAYLOAD_DYLIB;    } else {        inject_me = SBINJECT_PAYLOAD_DYLIB;    }    ...    int envcount = 0;    if (envp != NULL){        DEBUGLOG(&quot;Env: &quot;);        const char** currentenv = envp;        while (*currentenv != NULL){            DEBUGLOG(&quot;\t%s&quot;, *currentenv);            if (strstr(*currentenv, &quot;DYLD_INSERT_LIBRARIES&quot;) == NULL) {                envcount++;            }            currentenv++;        }    }    char const** newenvp = malloc((envcount+2) * sizeof(char **));    int j = 0;    for (int i = 0; i &lt; envcount; i++){        if (strstr(envp[j], &quot;DYLD_INSERT_LIBRARIES&quot;) != NULL){            continue;        }        newenvp[i] = envp[j];        j++;    }    char *envp_inject = malloc(strlen(&quot;DYLD_INSERT_LIBRARIES=&quot;) + strlen(inject_me) + 1);    envp_inject[0] = &#39;\0&#39;;    strcat(envp_inject, &quot;DYLD_INSERT_LIBRARIES=&quot;);    strcat(envp_inject, inject_me);    newenvp[j] = envp_inject;    newenvp[j+1] = NULL;    ...    origret = old(pid, path, file_actions, newattrp, argv, newenvp);}</code></pre><p>这里我分析下几个关键的地方，第一是如果当前要创建进程为<code>/usr/libexec/amfid</code>（也就是验证代码签名的进程），那么就注入<code>AMFID_PAYLOAD_DYLIB</code>模块，这个模块主要就是去patch验证签名的地方，这样才能执行任意代码；如果是其他进程，那么就注入<code>SBINJECT_PAYLOAD_DYLIB</code>模块（也就是tweak loader）。第二个地方是介绍了注入的实现方式，原理就是设置当前的环境变量，在调用原函数前，将当前<code>DYLD_INSERT_LIBRARIES</code>这个环境变量里面增加一个dylib路径，这样在进程穿件后就会去加载tweak loader。到这里，我们明白了tweak loader原来就是在这里被注入进去的。但同时又引出了一个问题，<code>pspawn_payload</code>模块本身又是谁加载的呢？这不又回到了之前的问题，接着分析。</p><h4><a href="#the-fun-part" class="header-anchor">#</a><span id="the-fun-part">the fun part</span></h4><p>这里的名字并不是我随便起的，因为在Electra里面就是就是。相关的代码路径在</p><pre><code>https://github.com/coolstar/electra/blob/02858b14dac30c9ba868bd3024529e9ae6592e67/electra/the%20fun%20part/fun.c</code></pre><p>这个文件里面的代码会做Post exploit patching所有事情，即在漏洞完成利用以后的所有事，这里当然就是指越狱环境。和其他越狱一样，主要就下面几个工作</p><ul><li>初始化jailbreakd</li><li>setuid(0)：将当前进程设为root进程</li><li>Remap tfp0</li><li>Remount / as rw :重新挂起根目录，实现任意文件读写</li><li>Prepare bootstrap binary：准备预装的一些基本的二进制文件，包括sshd，gnu命令等</li><li><p>setup hook enviroment : 支持hook环境</p></li><li><p>launch some daemon：加载一些守护进程</p></li><li>respring ：重启Springboard</li></ul><p>这里的最后一步如果完成，也就是平时看到的那样，代表越狱成功了。</p><p>回我之前的问题，这些步骤里面我们关心的地方就是hook环境的支持，直接相关代码在</p><pre><code class="c">if (enable_tweaks){    const char* args_launchd[] = {BinaryLocation, itoa(1), &quot;/bootstrap/pspawn_payload.dylib&quot;, NULL};    rv = posix_spawn(&amp;pd, BinaryLocation, NULL, NULL, (char **)&amp;args_launchd, NULL);    waitpid(pd, NULL, 0);    const char* args_recache[] = {&quot;/bootstrap/usr/bin/recache&quot;, &quot;--no-respring&quot;, NULL};    rv = posix_spawn(&amp;pd, &quot;/bootstrap/usr/bin/recache&quot;, NULL, NULL, (char **)&amp;args_recache, NULL);    waitpid(pd, NULL, 0);}</code></pre><p>也就是说如果设置了支持tweak的话，就会将<code>pspawn_payload</code>模块注入到1号进程，而1号进程就是launchd进程。另外你可能想问，那这里的注入又是怎么实现的呢？不可能又是hook <code>posix_spawn</code>注入环境变量吧，这不就产生鸡生蛋和蛋生鸡的问题了吗？事实上这里的注入并不是通过hook <code>posix_spawn</code>，注入的实现在</p><pre><code>https://github.com/coolstar/electra/tree/02858b14dac30c9ba868bd3024529e9ae6592e67/basebinaries/inject_criticald</code></pre><p>注入的原理就是通过<code>task_for_pid</code>来实现的，如果你的设备是用的coolstar系越狱（Electra或者Chimera）的话，你会在越狱目录下存在这个可执行文件，下面是Chimera越狱的信息</p><pre><code class="bash">xia0:/chimera root# ls -latotal 1100drwxr-xr-x  8 root wheel    256 Feb 26 13:19 ./drwxr-xr-x 28 root wheel    896 Sep 16 17:44 ../-rwxr-xr-x  1 root wheel 168736 Sep 17 10:21 inject_criticald*-rwxr-xr-x  1 root wheel 207920 Sep 17 10:21 jailbreakd*-rwxr-xr-x  1 root wheel 133840 Sep 17 10:21 jailbreakd_client*-rwxr-xr-x  1 root wheel 167296 Sep 17 10:21 libjailbreak.dylib*-rwxr-xr-x  1 root wheel 236896 Sep 17 10:21 pspawn_payload-stg2.dylib*-rwxr-xr-x  1 root wheel 202640 Sep 17 10:21 pspawn_payload.dylib*xia0:/chimera root# ./inject_criticald Usage: inject_criticald &lt;pid&gt; &lt;dylib&gt;</code></pre><p><code>inject_criticald</code>这个命令可以直接对进程进行注入dylib。到这里，关于tweak loader的加载问题已经得到了解决，整个加载的过程可以说就是越狱的整个过程。现在tweak loader由谁加载的问题解决了，但是何时被加载和初始化的问题还没解决？接下来就和越狱本身不相关了，要从<code>DYLD_INSERT_LIBRARIES</code>说起</p><h3><a href="#dyld-insert-libraries-amp-amp-dyld" class="header-anchor">#</a><span id="dyld-insert-libraries-amp-amp-dyld">DYLD_INSERT_LIBRARIES &amp;&amp; dyld</span></h3><p>下面就抛开越狱，进入DYLD_INSERT_LIBRARIES和dyld的实现细节里面，由于dyld本事是开源的，所以从源码开始分析。直接搜索<code>DYLD_INSERT_LIBRARIES</code>最可疑的地方就在这里</p><pre><code class="c">// In order for register_func_for_add_image() callbacks to to be called bottom up,// we need to maintain a list of root images. The main executable is usally the// first root. Any images dynamically added are also roots (unless already loaded).// If DYLD_INSERT_LIBRARIES is used, those libraries are first.static void addRootImage(ImageLoader* image){    //dyld::log(&quot;addRootImage(%p, %s)\n&quot;, image, image-&gt;getPath());    // add to list of roots    sImageRoots.push_back(image);}</code></pre><p>注释里面说到了一句，<code>If DYLD_INSERT_LIBRARIES is used, those libraries are first.</code></p><p>也就是说，如果<code>DYLD_INSERT_LIBRARIES</code>环境变量注入的模块会被优先处理。本身这个函数的话是在下面函数中调用</p><pre><code class="c">void link(ImageLoader* image, bool forceLazysBound, bool neverUnload, const ImageLoader::RPathChain&amp; loaderRPaths){    // add to list of known images.  This did not happen at creation time for bundles    if ( image-&gt;isBundle() &amp;&amp; !image-&gt;isLinked() )        addImage(image);    // we detect root images as those not linked in yet     if ( !image-&gt;isLinked() )        addRootImage(image);    // process images    try {        image-&gt;link(gLinkContext, forceLazysBound, false, neverUnload, loaderRPaths);    }    catch (const char* msg) {        garbageCollectImages();        throw;    }}</code></pre><p>接下来一个重要的函数就是<code>initializeMainExecutable()</code></p><pre><code class="c">void initializeMainExecutable(){    // record that we&#39;ve reached this step    gLinkContext.startedInitializingMainExecutable = true;    // run initialzers for any inserted dylibs    ImageLoader::InitializerTimingList initializerTimes[sAllImages.size()];    initializerTimes[0].count = 0;    const size_t rootCount = sImageRoots.size();    if ( rootCount &gt; 1 ) {        for(size_t i=1; i &lt; rootCount; ++i) {            sImageRoots[i]-&gt;runInitializers(gLinkContext, initializerTimes[0]);        }    }    // run initializers for main executable and everything it brings up     sMainExecutable-&gt;runInitializers(gLinkContext, initializerTimes[0]);    // register cxa_atexit() handler to run static terminators in all loaded images when this process exits    if ( gLibSystemHelpers != NULL )         (*gLibSystemHelpers-&gt;cxa_atexit)(&amp;runAllStaticTerminators, NULL, NULL);    // dump info if requested    if ( sEnv.DYLD_PRINT_STATISTICS )        ImageLoaderMachO::printStatistics((unsigned int)sAllImages.size(), initializerTimes[0]);}</code></pre><p>这里可以看到会去先初始化<code>sImageRoots</code>，然后才初始化<code>sMainExecutable</code>。当然后面就是一个递归的初始化过程，即是说如果初始化的模块依赖其他模块，那么又先初始化依赖的模块。在递归初始化函数之中有个地方</p><pre><code class="c">void ImageLoader::recursiveInitialization(const LinkContext&amp; context, mach_port_t this_thread,                                          InitializerTimingList&amp; timingInfo, UninitedUpwards&amp; uninitUps){    ...    // let objc know we are about to initialize this image    uint64_t t1 = mach_absolute_time();    fState = dyld_image_state_dependents_initialized;    oldState = fState;    context.notifySingle(dyld_image_state_dependents_initialized, this);    // initialize this image    bool hasInitializers = this-&gt;doInitialization(context);    // let anyone know we finished initializing this image    fState = dyld_image_state_initialized;    oldState = fState;    context.notifySingle(dyld_image_state_initialized, this);    ...}</code></pre><p>从这里可以看出，<code>+load</code>函数确实会比<code>mod_init_func</code>优先执行。</p><p>最后总结一下，由于tweak loader是通过<code>DYLD_INSERT_LIBRARIES</code>注入的，所以会优先初始化，只有这样才能实现加载tweak模块的功能。到这里tweak loader何时被初始化的疑问也得到了解决，后面会用实验去验证这个分析。</p><h3><a href="#shi-yan" class="header-anchor">#</a><span id="shi-yan">实验</span></h3><p>前面分析了这么多，那实际情况到底是不是这样的呢。首先我们还是对<code>CFBundleGetMainBundle</code>、App里面的<code>+load</code>和<code>mod_init_func</code>下断点，首先断下来的是：</p><pre><code>(lldb) bt* thread #1, queue = &#39;com.apple.main-thread&#39;, stop reason = breakpoint 4.1  * frame #0: 0x00000001fd2d18ac CoreFoundation`CFBundleGetMainBundle    frame #1: 0x00000001fdbfeadc Foundation`+[NSBundle mainBundle] + 112    frame #2: 0x00000001024a2ee0 TweakInject.dylib`___lldb_unnamed_symbol1$$TweakInject.dylib + 96    frame #3: 0x000000010256f56c dyld`ImageLoaderMachO::doModInitFunctions(ImageLoader::LinkContext const&amp;) + 424    frame #4: 0x000000010256f7ac dyld`ImageLoaderMachO::doInitialization(ImageLoader::LinkContext const&amp;) + 40    frame #5: 0x0000000102569f64 dyld`ImageLoader::recursiveInitialization(ImageLoader::LinkContext const&amp;, unsigned int, char const*, ImageLoader::InitializerTimingList&amp;, ImageLoader::UninitedUpwards&amp;) + 512    frame #6: 0x0000000102568dd8 dyld`ImageLoader::processInitializers(ImageLoader::LinkContext const&amp;, unsigned int, ImageLoader::InitializerTimingList&amp;, ImageLoader::UninitedUpwards&amp;) + 152    frame #7: 0x0000000102568e98 dyld`ImageLoader::runInitializers(ImageLoader::LinkContext const&amp;, ImageLoader::InitializerTimingList&amp;) + 88    frame #8: 0x00000001025567d4 dyld`dyld::initializeMainExecutable() + 188    frame #9: 0x000000010255b88c dyld`dyld::_main(macho_header const*, unsigned long, int, char const**, char const**, char const**, unsigned long*) + 4708    frame #10: 0x0000000102555044 dyld`_dyld_start + 68</code></pre><p>从调用链来看<code>initializeMainExecutable</code>后就是先初始化<code>TweakInject.dylib</code>，这时候app自身代码还没执行。接下来断下来是</p><pre><code>(lldb) bt* thread #1, queue = &#39;com.apple.main-thread&#39;, stop reason = breakpoint 3.1  * frame #0: 0x000000010244e7f0 TestAPP`+[OCClassDemo load](self=OCClassDemo, _cmd=&quot;load&quot;) at OCClassDemo.m:20:5    frame #1: 0x00000001fc476a24 libobjc.A.dylib`call_load_methods + 188    frame #2: 0x00000001fc477d94 libobjc.A.dylib`load_images + 148    frame #3: 0x00000001025564c4 dyld`dyld::notifySingle(dyld_image_states, ImageLoader const*, ImageLoader::InitializerTimingList*) + 488    frame #4: 0x0000000102569f40 dyld`ImageLoader::recursiveInitialization(ImageLoader::LinkContext const&amp;, unsigned int, char const*, ImageLoader::InitializerTimingList&amp;, ImageLoader::UninitedUpwards&amp;) + 476    frame #5: 0x0000000102568dd8 dyld`ImageLoader::processInitializers(ImageLoader::LinkContext const&amp;, unsigned int, ImageLoader::InitializerTimingList&amp;, ImageLoader::UninitedUpwards&amp;) + 152    frame #6: 0x0000000102568e98 dyld`ImageLoader::runInitializers(ImageLoader::LinkContext const&amp;, ImageLoader::InitializerTimingList&amp;) + 88    frame #7: 0x00000001025567f8 dyld`dyld::initializeMainExecutable() + 224    frame #8: 0x000000010255b88c dyld`dyld::_main(macho_header const*, unsigned long, int, char const**, char const**, char const**, unsigned long*) + 4708    frame #9: 0x0000000102555044 dyld`_dyld_start + 68</code></pre><p>从调用链看，这时候开始初始化主模块，而且正是<code>+load</code>函数，所以<code>+load</code>就是app最早执行代码的地方。而且是通知<code>libobjc.A.dylib</code>去完成的。这里可以回到dyld的源码中：</p><pre><code class="c">static void notifySingle(dyld_image_states state, const ImageLoader* image){    //dyld::log(&quot;notifySingle(state=%d, image=%s)\n&quot;, state, image-&gt;getPath());    std::vector&lt;dyld_image_state_change_handler&gt;* handlers = stateToHandlers(state, sSingleHandlers);    if ( handlers != NULL ) {        dyld_image_info info;        info.imageLoadAddress    = image-&gt;machHeader();        info.imageFilePath        = image-&gt;getRealPath();        info.imageFileModDate    = image-&gt;lastModified();        for (std::vector&lt;dyld_image_state_change_handler&gt;::iterator it = handlers-&gt;begin(); it != handlers-&gt;end(); ++it) {            const char* result = (*it)(state, 1, &amp;info);            if ( (result != NULL) &amp;&amp; (state == dyld_image_state_mapped) ) {                //fprintf(stderr, &quot;  image rejected by handler=%p\n&quot;, *it);                // make copy of thrown string so that later catch clauses can free it                const char* str = strdup(result);                throw str;            }        }    }    ...}</code></pre><p><code>notifySingle</code>函数会循环调用所有注册通知的处理模块</p><pre><code class="c">// Callback that provides a bottom-up array of images// For dyld_image_state_[dependents_]mapped state only, returning non-NULL will cause dyld to abort loading all those images// and append the returned string to its load failure error message. dyld does not free the string, so// it should be a literal string or a static buffer//typedef const char* (*dyld_image_state_change_handler)(enum dyld_image_states state, uint32_t infoCount, const struct dyld_image_info info[]);</code></pre><p>这里就是由<code>libobjc.A.dylib</code>去处理的<code>+load</code>函数。最后断下来的就是：</p><pre><code>(lldb) bt* thread #1, queue = &#39;com.apple.main-thread&#39;, stop reason = breakpoint 1.1  * frame #0: 0x000000010242bd20 TestAPP`temp_init at temp.c:98:5    frame #1: 0x000000010256f56c dyld`ImageLoaderMachO::doModInitFunctions(ImageLoader::LinkContext const&amp;) + 424    frame #2: 0x000000010256f7ac dyld`ImageLoaderMachO::doInitialization(ImageLoader::LinkContext const&amp;) + 40    frame #3: 0x0000000102569f64 dyld`ImageLoader::recursiveInitialization(ImageLoader::LinkContext const&amp;, unsigned int, char const*, ImageLoader::InitializerTimingList&amp;, ImageLoader::UninitedUpwards&amp;) + 512    frame #4: 0x0000000102568dd8 dyld`ImageLoader::processInitializers(ImageLoader::LinkContext const&amp;, unsigned int, ImageLoader::InitializerTimingList&amp;, ImageLoader::UninitedUpwards&amp;) + 152    frame #5: 0x0000000102568e98 dyld`ImageLoader::runInitializers(ImageLoader::LinkContext const&amp;, ImageLoader::InitializerTimingList&amp;) + 88    frame #6: 0x00000001025567f8 dyld`dyld::initializeMainExecutable() + 224    frame #7: 0x000000010255b88c dyld`dyld::_main(macho_header const*, unsigned long, int, char const**, char const**, char const**, unsigned long*) + 4708    frame #8: 0x0000000102555044 dyld`_dyld_start + 68</code></pre><p>这里看出就是<code>mod_init_func</code>了，当然在dyld中调用这个函数的地方就是</p><pre><code class="c">bool ImageLoaderMachO::doInitialization(const LinkContext&amp; context){    CRSetCrashLogMessage2(this-&gt;getPath());    // mach-o has -init and static initializers    doImageInit(context);    doModInitFunctions(context);    CRSetCrashLogMessage2(NULL);    return (fHasDashInit || fHasInitializers);}</code></pre><p>其中<code>doModInitFunctions</code>就会解析load command找到<code>_DATA,_mod_init_func</code>列表进行初始化调用。</p><h3><a href="#zui-hou" class="header-anchor">#</a><span id="zui-hou">最后</span></h3><p>对于coolstar系的越狱简单的分析就到这里，unc0ver越狱的话整体流程应该差不多，但在<code>substrate</code>层应该实现差异挺大的，后面有时间的话再分析下相关实现了。</p><h3><a href="#can-kao" class="header-anchor">#</a><span id="can-kao">参考</span></h3><ul><li><a href="https://github.com/opensource-apple/dyld">https://github.com/opensource-apple/dyld</a></li><li><a href="https://github.com/opensource-apple/objc4">https://github.com/opensource-apple/objc4</a></li><li><a href="https://github.com/Chr0nicT/TweakInject">https://github.com/Chr0nicT/TweakInject</a></li><li><a href="https://github.com/chr1s0x1/TweakInject">https://github.com/chr1s0x1/TweakInject</a></li><li><a href="https://github.com/coolstar/electra">https://github.com/coolstar/electra</a></li><li><a href="https://coolstarorg.tumblr.com/" target="_blank" rel="external">https://coolstarorg.tumblr.com/</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2&gt;&lt;a href=&quot;#step-into-jailbreak-and-dyld&quot; class=&quot;header-anchor&quot;&gt;#&lt;/a&gt;&lt;span id=&quot;step-into-jailbreak-and-dyld&quot;&gt;Step into Jailbreak and dyld&lt;
      
    
    </summary>
    
      <category term="RE" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/categories/RE/"/>
    
    
      <category term="tweak" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/tweak/"/>
    
      <category term="dyld" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/dyld/"/>
    
      <category term="jailbrek" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/jailbrek/"/>
    
  </entry>
  
  <entry>
    <title>如何优雅的在LLDB里dumpdecrypted</title>
    <link href="https://github.com/4ch12dy/4ch12dy.github.io.git/2020/02/26/lldb-how-to-dump-gracefully/lldb-how-to-dump-gracefully/"/>
    <id>https://github.com/4ch12dy/4ch12dy.github.io.git/2020/02/26/lldb-how-to-dump-gracefully/lldb-how-to-dump-gracefully/</id>
    <published>2020-02-26T15:55:56.000Z</published>
    <updated>2020-02-28T08:42:51.477Z</updated>
    
    <content type="html"><![CDATA[<h2><a href="#ru-he-you-ya-de-zai-lldb-li-dumpdecrypted" class="header-anchor">#</a><span id="ru-he-you-ya-de-zai-lldb-li-dumpdecrypted">如何优雅的在LLDB里dumpdecrypted</span></h2><h3><a href="#kai-shi" class="header-anchor">#</a><span id="kai-shi">开始</span></h3><p>之前写过一篇<a href="http://4ch12dy.site/2019/09/23/lldb-dumpdecrypted/lldb-dumpdecrypted/" target="_blank" rel="external">文章</a>介绍了在LLDB中的脱壳工具，原理是将dumpdecrypted移植成了LLDB脚本。该脱壳的场景主要是针对一些无法正常启动的app进行脱壳，例如，检测到越狱直接闪退、不明crash等。因为现在的脱壳工具前提必须是app至少能正常启动。但是在LLDB中脱壳那篇文章关于脱壳流程其实很繁琐，所以这里将进行改进，用一种优雅的方式实现，本文默认讨论是针对启动就crash的场景。</p><h3><a href="#wen-ti" class="header-anchor">#</a><span id="wen-ti">问题？</span></h3><p>由于在LLDB中脱壳的特殊性，LLDB以后台模式启动App后，能拿到最早的执行点，所以App代码还没执行，自然是不会crash的，但是这个时机是没有办法进行脱壳的，因为很多基础模块都没有加载到进程，而我写的脱壳代码是需要执行环境（直接进行内存dump的话是不需要）。所以才有了之前那篇文章设置断点的方式，主要就是为了能够在基础模块加载完后，app代码还未执行之前进行dump。也因为如此，写了一个能对<code>mod_init_func</code>下断点的命令，但这种方式一直都不优雅，很麻烦，而且<code>+[Class load]</code>的执行时机在<code>mod_init_func</code>之前，如果把检测的代码放到那里，这时候程序以及退出了。</p><h3><a href="#ni-xiang-fen-xi" class="header-anchor">#</a><span id="ni-xiang-fen-xi">逆向分析</span></h3><p>其实对于dump的时机问题，最开始就在思考怎么容易的去拿到一个点。但之前在dyld源码中查找过相关api，不过没有找打合适的点。最近分析一个app正是用的<code>+[Class load]</code>方式进行的检测，导致脱壳费了一点精力，所以想完善一下。开始分析：</p><p>首先<code>+[Class load]</code>的调用链如下</p><pre><code>(lldb) bt* thread #1, queue = &#39;com.apple.main-thread&#39;, stop reason = breakpoint 3.1  * frame #0: 0x0000000100fd67f0 TestAPP`+[OCClassDemo load](self=OCClassDemo, _cmd=&quot;load&quot;) at OCClassDemo.m:20:5    frame #1: 0x00000001b6c2cecc libobjc.A.dylib`load_images + 736    frame #2: 0x00000001011ea0d4 dyld`dyld::notifySingle(dyld_image_states, ImageLoader const*, ImageLoader::InitializerTimingList*) + 448    frame #3: 0x00000001011f958c dyld`ImageLoader::recursiveInitialization(ImageLoader::LinkContext const&amp;, unsigned int, char const*, ImageLoader::InitializerTimingList&amp;, ImageLoader::UninitedUpwards&amp;) + 524    frame #4: 0x00000001011f8308 dyld`ImageLoader::processInitializers(ImageLoader::LinkContext const&amp;, unsigned int, ImageLoader::InitializerTimingList&amp;, ImageLoader::UninitedUpwards&amp;) + 184    frame #5: 0x00000001011f83d0 dyld`ImageLoader::runInitializers(ImageLoader::LinkContext const&amp;, ImageLoader::InitializerTimingList&amp;) + 92    frame #6: 0x00000001011ea420 dyld`dyld::initializeMainExecutable() + 216    frame #7: 0x00000001011eedb4 dyld`dyld::_main(macho_header const*, unsigned long, int, char const**, char const**, char const**, unsigned long*) + 4616    frame #8: 0x00000001011e9208 dyld`dyldbootstrap::start(dyld3::MachOLoaded const*, int, char const**, dyld3::MachOLoaded const*, unsigned long*) + 396    frame #9: 0x00000001011e9038 dyld`_dyld_start + 56</code></pre><p>可以看到是dyld在进行递归初始化的时候发出，然后调用<code>libobjc.A.dylib</code>的<code>load_images</code>函数，最后才执行到App自身的<code>+[OCClassDemo load]</code>代码。由于objc代码开源的，所以去看下<code>load_images</code>这个函数</p><pre><code class="c">/************************************************************************ load_images* Process +load in the given images which are being mapped in by dyld.* Calls ABI-agnostic code after taking ABI-specific locks.** Locking: write-locks runtimeLock and loadMethodLock**********************************************************************/const char *load_images(enum dyld_image_states state, uint32_t infoCount,            const struct dyld_image_info infoList[]){    bool found;    // Return without taking locks if there are no +load methods here.    found = false;    for (uint32_t i = 0; i &lt; infoCount; i++) {        if (hasLoadMethods((const headerType *)infoList[i].imageLoadAddress)) {            found = true;            break;        }    }    if (!found) return nil;    recursive_mutex_locker_t lock(loadMethodLock);    // Discover load methods    {        rwlock_writer_t lock2(runtimeLock);        found = load_images_nolock(state, infoCount, infoList);    }    // Call +load methods (without runtimeLock - re-entrant)    if (found) {        call_load_methods();    }    return nil;}</code></pre><p>注释上也写了，这个函数其实主要就是去处理<code>+load</code>方法的，这样说来我们直接在这个方法下断点可以吗？事实上是可以的，但是进程会加载很多模块，在调试器中去需要频繁的进行check是否当前就是app的模块。那这个点其实也是不优雅的。</p><h3><a href="#liu-an-hua-ming" class="header-anchor">#</a><span id="liu-an-hua-ming">柳暗花明</span></h3><p>在调试的时候由于一个偶然的bug，调试器断在了<code>TweakInject.dylib</code>这里面的一个函数。而且此时app的<code>+load</code>代码并没有执行，而且看名字应该是加载tweak的dylib用的，然后就去google 了一下这个，发现是有开源代码的</p><p><a href="https://github.com/chr1s0x1/TweakInject">https://github.com/chr1s0x1/TweakInject</a></p><p>看了下源码发现确实就是用来加载<code>/Library/MobileSubstrate/DynamicLibraries</code>下的dylib的，规则就是根据plist的字段。而且现在像<code>libobjc.A.dylib</code>这样的基础模块以及初始化完成。所以是能够执行OC代码，那这个时机应该就是最佳的dump时机。所以我对<code>CoreFoundation</code> 里面的<code>CFBundleGetMainBundle</code>函数下断点。堆栈如下</p><pre><code>* frame #0: 0x00000001fd2d18ac CoreFoundation`CFBundleGetMainBundle    frame #1: 0x00000001fdbfeadc Foundation`+[NSBundle mainBundle] + 112    frame #2: 0x00000001012b6ee0 TweakInject.dylib`___lldb_unnamed_symbol1$$TweakInject.dylib + 96    frame #3: 0x000000010146f56c dyld`ImageLoaderMachO::doModInitFunctions(ImageLoader::LinkContext const&amp;) + 424    frame #4: 0x000000010146f7ac dyld`ImageLoaderMachO::doInitialization(ImageLoader::LinkContext const&amp;) + 40    frame #5: 0x0000000101469f64 dyld`ImageLoader::recursiveInitialization(ImageLoader::LinkContext const&amp;, unsigned int, char const*, ImageLoader::InitializerTimingList&amp;, ImageLoader::UninitedUpwards&amp;) + 512</code></pre><p>这时候执行dumpdecrypted发现就没问题了，顺利脱壳。后面在封装成一个命令，这样只要调试器挂上以后，执行命令自动下断点，触发以后自动执行脱壳命令，这样就要优雅很多。</p><p>现在<a href="https://github.com/4ch12dy/xia0LLDB">xia0LLDB</a>中dumpdecrypted已经更新，在以后台模式启动app，lldb挂上去以后，直接执行<code>dumpdecrypted -X</code>即可</p><h3><a href="#geng-duo-si-kao" class="header-anchor">#</a><span id="geng-duo-si-kao">更多思考</span></h3><p>本文来说，这里应该就完了，已经找到了一个比较优雅的dump点。不过我却陷入了思考，这个<code>TweakInject.dylib</code>凭啥就能优先初始化执行代码，能够保证在基础模块初始化之后，其他模块之前。正常来说肯定是做不到的，除非对dyld进行修改，使其优先初始化这个dylib。所以是怎么做到这得呢？搜索了一番没有发现是什么资料，随后我又对unc0ver进行了测试（因为我用的Chimera越狱），之前我就说过这两个越狱其实差异很大，导致我想看下unc0ver中这里是怎么处理的，同样对<code>CFBundleGetMainBundle</code>下断点，堆栈如下</p><pre><code>(lldb) bt* thread #1, queue = &#39;com.apple.main-thread&#39;, stop reason = breakpoint 1.1  * frame #0: 0x00000001b6f4a510 CoreFoundation`CFBundleGetMainBundle    frame #1: 0x000000010d27bd14 SubstrateLoader.dylib`___lldb_unnamed_symbol1$$SubstrateLoader.dylib + 124    frame #2: 0x000000010d37e18c cy-c5bKjj.dylib`ImageLoaderMachO::doModInitFunctions(ImageLoader::LinkContext const&amp;) + 428    frame #3: 0x000000010d37e560 cy-c5bKjj.dylib`ImageLoaderMachO::doInitialization(ImageLoader::LinkContext const&amp;) + 52    frame #4: 0x000000010d3795a4 cy-c5bKjj.dylib`ImageLoader::recursiveInitialization(ImageLoader::LinkContext const&amp;, unsigned int, char const*, ImageLoader::InitializerTimingList&amp;, ImageLoader::UninitedUpwards&amp;) + 548    frame #5: 0x000000010d378308 cy-c5bKjj.dylib`ImageLoader::processInitializers(ImageLoader::LinkContext const&amp;, unsigned int, ImageLoader::InitializerTimingList&amp;, ImageLoader::UninitedUpwards&amp;) + 184    frame #6: 0x000000010d3783d0 cy-c5bKjj.dylib`ImageLoader::runInitializers(ImageLoader::LinkContext const&amp;, ImageLoader::InitializerTimingList&amp;) + 92    frame #7: 0x000000010d36d894 cy-c5bKjj.dylib`dyld::runInitializers(ImageLoader*) + 88    frame #8: 0x000000010d3743b8 cy-c5bKjj.dylib`dlopen_internal + 1064    frame #9: 0x00000001b6d03560 libdyld.dylib`dlopen + 172    frame #10: 0x000000010d37e18c cy-c5bKjj.dylib`ImageLoaderMachO::doModInitFunctions(ImageLoader::LinkContext const&amp;) + 428    frame #11: 0x000000010d37e560 cy-c5bKjj.dylib`ImageLoaderMachO::doInitialization(ImageLoader::LinkContext const&amp;) + 52    frame #12: 0x000000010d3795a4 cy-c5bKjj.dylib`ImageLoader::recursiveInitialization(ImageLoader::LinkContext const&amp;, unsigned int, char const*, ImageLoader::InitializerTimingList&amp;, ImageLoader::UninitedUpwards&amp;) + 548    frame #13: 0x000000010d378308 cy-c5bKjj.dylib`ImageLoader::processInitializers(ImageLoader::LinkContext const&amp;, unsigned int, ImageLoader::InitializerTimingList&amp;, ImageLoader::UninitedUpwards&amp;) + 184    frame #14: 0x000000010d3783d0 cy-c5bKjj.dylib`ImageLoader::runInitializers(ImageLoader::LinkContext const&amp;, ImageLoader::InitializerTimingList&amp;) + 92    frame #15: 0x000000010d36a3d0 cy-c5bKjj.dylib`dyld::initializeMainExecutable() + 136    frame #16: 0x000000010d36edb4 cy-c5bKjj.dylib`dyld::_main(macho_header const*, unsigned long, int, char const**, char const**, char const**, unsigned long*) + 4616    frame #17: 0x000000010d369208 cy-c5bKjj.dylib`dyldbootstrap::start(dyld3::MachOLoaded const*, int, char const**, dyld3::MachOLoaded const*, unsigned long*) + 396    frame #18: 0x000000010d369038 cy-c5bKjj.dylib`_dyld_start + 56</code></pre><p>这里可以发现并不是<code>TweakInject.dylib</code>，而是<code>SubstrateLoader.dylib</code>从名字上来看应该也是用作加载tweak的dylib的。另外有个注意的地方在于，调用者并不是dyld，而是<code>cy-c5bKjj.dylib</code>完整的路径是<code>/Library/Caches/cy-c5bKjj.dylib</code>，然而去文件中发现并不存在。</p><h3><a href="#geng-xin-2020-02-28" class="header-anchor">#</a><span id="geng-xin-2020-02-28">更新（2020-02-28）</span></h3><p>找到原因了，本来写了一段，不过又删除了。原因是后面涉及到的知识点太多了，如果只是用这一个节去简单说下原理，那无疑会遗漏很多细节，于是我准备再写一篇，详细介绍这背后的所有知识点。主要涉及到以下内容</p><ul><li>jailbreak post exploit patching </li><li>tweak loader</li><li>dyld how to load and init image</li><li>DYLD_INSERT_LIBRARIES details</li><li><code>+[Class load]</code> and mod_init_func</li><li>…</li></ul><h3><a href="#zui-hou" class="header-anchor">#</a><span id="zui-hou">最后</span></h3><p><del>这里目前还有几个疑问没解决，后面找到了答案再来更新。</del></p><h3><a href="#can-kao" class="header-anchor">#</a><span id="can-kao">参考</span></h3><ul><li><a href="https://github.com/Chr0nicT/TweakInject">https://github.com/Chr0nicT/TweakInject</a></li><li><a href="https://github.com/chr1s0x1/TweakInject">https://github.com/chr1s0x1/TweakInject</a></li><li><a href="https://github.com/BlueCocoa/dumpdecrypted-lldb/blob/master/dumpdecrypted.py">https://github.com/BlueCocoa/dumpdecrypted-lldb/blob/master/dumpdecrypted.py</a></li><li><a href="http://iosre.com/t/topic/8179" target="_blank" rel="external">http://iosre.com/t/topic/8179</a></li><li><a href="https://lldb.llvm.org/use/map.html" target="_blank" rel="external">https://lldb.llvm.org/use/map.html</a></li><li><a href="https://github.com/opensource-apple/objc4">https://github.com/opensource-apple/objc4</a></li><li><a href="https://github.com/opensource-apple/dyld">https://github.com/opensource-apple/dyld</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2&gt;&lt;a href=&quot;#ru-he-you-ya-de-zai-lldb-li-dumpdecrypted&quot; class=&quot;header-anchor&quot;&gt;#&lt;/a&gt;&lt;span id=&quot;ru-he-you-ya-de-zai-lldb-li-dumpdecrypted&quot;&gt;如何优
      
    
    </summary>
    
      <category term="RE" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/categories/RE/"/>
    
      <category term="debug" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/categories/RE/debug/"/>
    
    
      <category term="iOS" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/iOS/"/>
    
      <category term="LLDB" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/LLDB/"/>
    
      <category term="dump" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/dump/"/>
    
      <category term="Macho" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/Macho/"/>
    
      <category term="inject" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/inject/"/>
    
  </entry>
  
  <entry>
    <title>coronavirus</title>
    <link href="https://github.com/4ch12dy/4ch12dy.github.io.git/2020/01/24/2020-01-24-chinese-newyear-eve/2020-01-24-chinese-newyear-eve/"/>
    <id>https://github.com/4ch12dy/4ch12dy.github.io.git/2020/01/24/2020-01-24-chinese-newyear-eve/2020-01-24-chinese-newyear-eve/</id>
    <published>2020-01-24T01:54:08.000Z</published>
    <updated>2020-04-24T07:06:26.121Z</updated>
    
    <content type="html"><![CDATA[<script src="//cdn.bootcss.com/jquery/1.11.3/jquery.min.js"></script><div id="hbe-security">  <div class="hbe-input-container">  <input type="password" class="hbe-form-control" id="pass" placeholder="give me the secret code ;)">    <label for="pass">give me the secret code ;)</label>    <div class="bottom-line"></div>  </div></div><div id="decryptionError" style="display: none;">Incorrect Password!</div><div id="noContentError" style="display: none;">No content to display!</div><div id="encrypt-blog" style="display:none">U2FsdGVkX18v5ULRRo98PwElzZA9RmrQgInwNHiAF0nxOeVK4CDfkJNOFv+a+JwFz1cQ09Nckc2uSB2zTrh61z/pTMAsfq93V9fIqozFjEQCF3B6Ce3W1pyrcYCA04y42U+rjY1Y1bJtm5sTOT13Jh66f4icRVej/yb671d1KJBooQBHDDs70fe3Y0crtYwP6UDXVCxy22c49s8vswNakW5IjXDJJAwoMtjpvQgvkJZwEPos99rQL2dMI+NeqpPCRaiMYnCu1MIY3669hf/+JBAZsbDkbjh9/9i8E5yzpb1Npz8OSaY/LG6OW3FPP3FM</div><script src="/lib/crypto-js.js"></script><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      something you can not kown 
    
    </summary>
    
      <category term="misc" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/categories/misc/"/>
    
    
      <category term="coronavirus" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/coronavirus/"/>
    
  </entry>
  
  <entry>
    <title>go逆向分析笔记</title>
    <link href="https://github.com/4ch12dy/4ch12dy.github.io.git/2020/01/06/go-and-go-reversing/go-and-go-reversing/"/>
    <id>https://github.com/4ch12dy/4ch12dy.github.io.git/2020/01/06/go-and-go-reversing/go-and-go-reversing/</id>
    <published>2020-01-06T09:31:24.000Z</published>
    <updated>2020-04-24T07:06:26.134Z</updated>
    
    <content type="html"><![CDATA[<script src="//cdn.bootcss.com/jquery/1.11.3/jquery.min.js"></script><div id="hbe-security">  <div class="hbe-input-container">  <input type="password" class="hbe-form-control" id="pass" placeholder="give me the secret code ;)">    <label for="pass">give me the secret code ;)</label>    <div class="bottom-line"></div>  </div></div><div id="decryptionError" style="display: none;">Incorrect Password!</div><div id="noContentError" style="display: none;">No content to display!</div><div id="encrypt-blog" style="display:none">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</div><script src="/lib/crypto-js.js"></script><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      something you can not kown 
    
    </summary>
    
      <category term="RE" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/categories/RE/"/>
    
    
      <category term="RE" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/RE/"/>
    
      <category term="go" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/go/"/>
    
  </entry>
  
  <entry>
    <title>在ARM64下的花指令对抗</title>
    <link href="https://github.com/4ch12dy/4ch12dy.github.io.git/2019/12/11/arm64-flower-insn-war/arm64-flower-insn-war/"/>
    <id>https://github.com/4ch12dy/4ch12dy.github.io.git/2019/12/11/arm64-flower-insn-war/arm64-flower-insn-war/</id>
    <published>2019-12-11T05:51:29.000Z</published>
    <updated>2020-04-24T07:06:26.300Z</updated>
    
    <content type="html"><![CDATA[<script src="//cdn.bootcss.com/jquery/1.11.3/jquery.min.js"></script><div id="hbe-security">  <div class="hbe-input-container">  <input type="password" class="hbe-form-control" id="pass" placeholder="give me the secret code ;)">    <label for="pass">give me the secret code ;)</label>    <div class="bottom-line"></div>  </div></div><div id="decryptionError" style="display: none;">Incorrect Password!</div><div id="noContentError" style="display: none;">No content to display!</div><div id="encrypt-blog" style="display:none">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</div><script src="/lib/crypto-js.js"></script><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      something you can not kown 
    
    </summary>
    
      <category term="RE" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/categories/RE/"/>
    
    
      <category term="RE" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/RE/"/>
    
      <category term="ida" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/ida/"/>
    
      <category term="arm64" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/arm64/"/>
    
      <category term="instruction" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/instruction/"/>
    
  </entry>
  
  <entry>
    <title>unity3d il2cpp原理解析及逆向分析</title>
    <link href="https://github.com/4ch12dy/4ch12dy.github.io.git/2019/11/06/unity3d-il2cpp-analyse/unity3d-il2cpp-analyse/"/>
    <id>https://github.com/4ch12dy/4ch12dy.github.io.git/2019/11/06/unity3d-il2cpp-analyse/unity3d-il2cpp-analyse/</id>
    <published>2019-11-06T12:38:25.000Z</published>
    <updated>2020-03-06T08:18:24.212Z</updated>
    
    <content type="html"><![CDATA[<h3><a href="#unity3d-il2cpp-yuan-li-jie-xi-ji-ni-xiang-fen-xi" class="header-anchor">#</a><span id="unity3d-il2cpp-yuan-li-jie-xi-ji-ni-xiang-fen-xi">unity3d il2cpp原理解析及逆向分析</span></h3><blockquote><p>本文可能写得有点乱，主要完整记录了我去逆向原理的流程，所以保留了很多分析过程中的信息，第一部分逆向分析如果对逆向过程不感兴趣简单看下就行</p></blockquote><h4><a href="#bei-jing" class="header-anchor">#</a><span id="bei-jing">背景</span></h4><p>介绍il2cpp以及mono</p><p><a href="https://gameinstitute.qq.com/community/detail/126815" target="_blank" rel="external">https://gameinstitute.qq.com/community/detail/126815</a></p><p>一篇官方文档介绍il2cpp的内部实现</p><p><a href="https://blogs.unity3d.com/2015/05/06/an-introduction-to-ilcpp-internals/" target="_blank" rel="external">https://blogs.unity3d.com/2015/05/06/an-introduction-to-ilcpp-internals/</a></p><h4><a href="#metadata-jia-zai-liu-cheng-ni-xiang-fen-xi" class="header-anchor">#</a><span id="metadata-jia-zai-liu-cheng-ni-xiang-fen-xi">metadata加载流程-逆向分析</span></h4><blockquote><p>将介绍我是怎么从逆向的角度去分析metadata的加载流程</p></blockquote><p>这个文件可以说在unity3d中有重要的作用，也是il2cpp实现并不可少的。但是在源码中并没有搜到对这个文件的引用，<del>猜测unity3d对该部分的实现并没有开源</del>（il2cpp的源代码在unity应用目录里面），于是我编译完以后的游戏的可执行文件中在ida中去搜索<code>global-metadata.dat</code>发现只有一处引用即<code>il2cpp::vm::MetadataCache::Initialize</code>函数。从名字上看得出来应该就是在初始化il2cpp虚拟机。于是对该函数下断点，然后得到如下调用链</p><pre><code>(lldb) bt* thread #1, queue = &#39;com.apple.main-thread&#39;, stop reason = breakpoint 4.1  * frame #0: 0x00000001007998ec ProductName`il2cpp::vm::MetadataCache::Initialize() at MetadataCache.cpp:163 [opt]    frame #1: 0x0000000100793364 ProductName`il2cpp::vm::Runtime::Init(filename=&quot;IL2CPP Root Domain&quot;, runtime_version=&lt;unavailable&gt;) at Runtime.cpp:145:9 [opt]    frame #2: 0x0000000100498164 ProductName`::InitializeIl2CppFromMain() at MonoManager_Il2Cpp.cpp:255:5 [opt]    frame #3: 0x00000001005b1efc ProductName`::UnityInitApplicationNoGraphics() at LibEntryPoint.mm:183:5 [opt]    frame #4: 0x00000001000ede90 ProductName`::-[UnityAppController application:didFinishLaunchingWithOptions:](self=0x0000000157570560, _cmd=&lt;unavailable&gt;, application=&lt;unavailable&gt;, launchOptions=&lt;unavailable&gt;) at UnityAppController.mm:259:5 [opt]    frame #5: 0x00000001875628a8 UIKit`-[UIApplication _handleDelegateCallbacksWithOptions:isSuspended:restoreState:] + 400    frame #6: 0x0000000187792094 UIKit`-[UIApplication _callInitializationDelegatesForMainScene:transitionContext:] + 2904    frame #7: 0x0000000187796500 UIKit`-[UIApplication _runWithMainScene:transitionContext:completion:] + 1684    frame #8: 0x0000000187793674 UIKit`-[UIApplication workspaceDidEndTransaction:] + 168    frame #9: 0x0000000183d437ac FrontBoardServices`__FBSSERIALQUEUE_IS_CALLING_OUT_TO_A_BLOCK__ + 36    frame #10: 0x0000000183d43618 FrontBoardServices`-[FBSSerialQueue _performNext] + 168    frame #11: 0x0000000183d439c8 FrontBoardServices`-[FBSSerialQueue _performNextFromRunLoopSource] + 56    frame #12: 0x0000000182359124  CoreFoundation`__CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE0_PERFORM_FUNCTION__ + 24    frame #13: 0x0000000182358bb8 CoreFoundation`__CFRunLoopDoSources0 + 540    frame #14: 0x00000001823568b8 CoreFoundation`__CFRunLoopRun + 724    frame #15: 0x0000000182280d10 CoreFoundation`CFRunLoopRunSpecific + 384    frame #16: 0x000000018755b834 UIKit`-[UIApplication _run] + 460    frame #17: 0x0000000187555f70 UIKit`UIApplicationMain + 204    frame #18: 0x00000001000d8d30 ProductName`main(argc=1, argv=0x000000016fd2bb98) at main.mm:41:9 [opt]    frame #19: 0x0000000181e1e8b8 libdyld.dylib`start + 4</code></pre><p>简单整理下在<code>-[UnityAppController application:didFinishLaunchingWithOptions:]</code>之后的调用过程</p><pre><code>UnityInitApplicationNoGraphics()--InitializeIl2CppFromMain()----il2cpp_init(&quot;IL2CPP Root Domain&quot;);------il2cpp::vm::Runtime::Init()--------il2cpp::vm::MetadataCache::Initialize()</code></pre><p>这里的<code>UnityInitApplicationNoGraphics</code>和<code>InitializeIl2CppFromMain</code>都在<code>libiPhone-lib.a</code>这个静态库之中，搜索了一下发下这个库貌似没开源，我们从ida的反汇编代码中去分析下这两个函数</p><p><code>UnityInitApplicationNoGraphics</code>的伪代码如下</p><pre><code class="c++">__int64 __fastcall UnityInitApplicationNoGraphics(__int64 a1){  AssetCatalogFileSystemHandler *v1; // x19  __int64 v2; // x0  ScreenManager *v3; // x0  int v4; // w19  __int64 v5; // x0  ScreenManager *v6; // x0  char v8; // [xsp+8h] [xbp-118h]  char v9; // [xsp+30h] [xbp-F0h]  char v10; // [xsp+58h] [xbp-C8h]  char v11; // [xsp+80h] [xbp-A0h]  char v12; // [xsp+A8h] [xbp-78h]  char v13; // [xsp+D0h] [xbp-50h]  core::basic_string&lt;char,core::StringStorageDefault&lt;char&gt;&gt;::basic_string(&amp;v13, a1);  core::basic_string&lt;char,core::StringStorageDefault&lt;char&gt;&gt;::basic_string(&amp;v11, &quot;Data&quot;);  AppendPathName(&amp;v13, &amp;v11);  core::StringStorageDefault&lt;char&gt;::~StringStorageDefault(&amp;v11);  core::basic_string&lt;char,core::StringStorageDefault&lt;char&gt;&gt;::basic_string(&amp;v9, &quot;Managed&quot;);  AppendPathName(&amp;v12, &amp;v9);  core::StringStorageDefault&lt;char&gt;::~StringStorageDefault(&amp;v9);  core::basic_string&lt;char,core::StringStorageDefault&lt;char&gt;&gt;::basic_string(&amp;v8, &amp;v13);  if ( !(InitializeIl2CppFromMain((signed __int64 *)&amp;v10, (signed __int64 *)&amp;v10, 1LL, (__int64)&amp;s_EmptyArgv) &amp; 1) )  {    printf_console(&quot;   %s\n&quot;);    exit(1);  }  v1 = (AssetCatalogFileSystemHandler *)operator new(48LL, 7LL, 8LL, &quot;&quot;, 185LL);  AssetCatalogFileSystemHandler::AssetCatalogFileSystemHandler(v1, &quot;res:&quot;);  gAssetCatalogFS = (__int64)v1;  v2 = GetFileSystem();  FileSystem::MountHandler(v2, gAssetCatalogFS);  if ( !(PlayerInitEngineNoGraphics(&amp;v12, &amp;v8) &amp; 1) )  {    printf_console(&quot;   %s\n&quot;);    exit(1);  }  v3 = (ScreenManager *)GetScreenManager();  ScreenManager::EnableOrientationsFromPlayerSettings(v3);  v4 = *(_DWORD *)(GetPlayerSettings() + 476LL);  if ( v4 == 4 )  {    v5 = GetScreenManager();    (*(void (**)(void))(*(_QWORD *)v5 + 224LL))();  }  else  {    v6 = (ScreenManager *)GetScreenManager();    ScreenManager::RequestConcreteOrientationFromPlayerSettings(v6, v4);  }  core::StringStorageDefault&lt;char&gt;::~StringStorageDefault(&amp;v8);  core::StringStorageDefault&lt;char&gt;::~StringStorageDefault(&amp;v10);  core::StringStorageDefault&lt;char&gt;::~StringStorageDefault(&amp;v12);  return core::StringStorageDefault&lt;char&gt;::~StringStorageDefault(&amp;v13);}</code></pre><p>这里主要做了两件事，一是去<code>InitializeIl2CppFromMain</code>初始化il2cpp，解密metadata就是在这里完成的；二是去<code>PlayerInitEngineNoGraphics</code>初始化游戏相关。现在分析加载matedata的具体细节</p><pre><code class="c++">static Il2CppMetadataCache s_MetadataCache;static Il2CppClass** s_TypeInfoTable = NULL;static Il2CppClass** s_TypeInfoDefinitionTable = NULL;static const MethodInfo** s_MethodInfoDefinitionTable = NULL;static Il2CppString** s_StringLiteralTable = NULL;static const Il2CppGenericMethod** s_GenericMethodTable = NULL;static int32_t s_ImagesCount = 0;static Il2CppImage* s_ImagesTable = NULL;static int32_t s_AssembliesCount = 0;static Il2CppAssembly* s_AssembliesTable = NULL;void MetadataCache::Initialize(){  //map global-metadata.dat to memory and change to Il2CppGlobalMetadataHeader*    s_GlobalMetadata = vm::MetadataLoader::LoadMetadataFile(&quot;global-metadata.dat&quot;);  s_GlobalMetadataHeader = (const Il2CppGlobalMetadataHeader*)s_GlobalMetadata;  // check   IL2CPP_ASSERT(s_GlobalMetadataHeader-&gt;sanity == 0xFAB11BAF);  IL2CPP_ASSERT(s_GlobalMetadataHeader-&gt;version == 24);    s_TypeInfoTable = calloc(s_Il2CppMetadataRegistration-&gt;typesCount, sizeof(Il2CppClass*));  s_TypeInfoDefinitionTable = calloc(s_GlobalMetadataHeader-&gt;typeDefinitionsCount / sizeof(Il2CppTypeDefinition), sizeof(Il2CppClass*));}</code></pre><p>这里有个问题在于<code>s_Il2CppMetadataRegistration</code>在哪里初始化的呢？跟一下</p><pre><code class="c++">void MetadataCache::Register(const Il2CppCodeRegistration* const codeRegistration, const Il2CppMetadataRegistration* const metadataRegistration, const Il2CppCodeGenOptions* const codeGenOptions){    s_Il2CppCodeRegistration = codeRegistration;    s_Il2CppMetadataRegistration = metadataRegistration;    s_Il2CppCodeGenOptions = codeGenOptions;    for (int32_t j = 0; j &lt; metadataRegistration-&gt;genericClassesCount; j++)        if (metadataRegistration-&gt;genericClasses[j]-&gt;typeDefinitionIndex != kTypeIndexInvalid)            metadata::GenericMetadata::RegisterGenericClass(metadataRegistration-&gt;genericClasses[j]);    for (int32_t i = 0; i &lt; metadataRegistration-&gt;genericInstsCount; i++)        s_GenericInstSet.insert(metadataRegistration-&gt;genericInsts[i]);    s_InteropData.assign_external(codeRegistration-&gt;interopData, codeRegistration-&gt;interopDataCount);}</code></pre><p>这里发现是在<code>MetadataCache::Register</code>这里初始化的，这又要取决于函数被谁调用的？调试了一下，其实就是在<code>MetadataCache::Initialize()</code>前一个函数里面初始化的。</p><pre><code class="c++">void Runtime::Init(const char* filename, const char *runtime_version){  ...    il2cpp::utils::RegisterRuntimeInitializeAndCleanup::ExecuteInitializations();  MetadataCache::Initialize();  ...}</code></pre><p>继续跟</p><pre><code class="c++">RegisterRuntimeInitializeAndCleanup::RegisterRuntimeInitializeAndCleanup(CallbackFunction Initialize, CallbackFunction Cleanup, int order){    if (!_registrationCallbacks)        _registrationCallbacks = new RegistrationCallbackSet();    (*_registrationCallbacks).insert(Initialize);}void RegisterRuntimeInitializeAndCleanup::ExecuteInitializations(){    if (_registrationCallbacks == NULL)        return;    for (RegistrationCallbackSet::iterator iter = (*_registrationCallbacks).begin(); iter != (*_registrationCallbacks).end(); ++iter)    {        (*iter)();    }}</code></pre><p>这里可以发现是调用的回调函数，所以需要继续跟在哪里注册的回调函数，以及回调函数是什么？这里继续调试，</p><p>对<code>RegisterRuntimeInitializeAndCleanup::RegisterRuntimeInitializeAndCleanup</code>函数下断点</p><pre><code>* thread #1, queue = &#39;com.apple.main-thread&#39;, stop reason = breakpoint 1.2  * frame #0: 0x00000001006c73b8 ProductName`il2cpp::utils::RegisterRuntimeInitializeAndCleanup::RegisterRuntimeInitializeAndCleanup(this=0x0000000100e13dd0, Initialize=(ProductName`s_Il2CppCodegenRegistration() [inlined] il2cpp_codegen_register(Il2CppCodeRegistration const*, Il2CppMetadataRegistration const*, Il2CppCodeGenOptions const*) at Il2CppCodeRegistration.cpp:59ProductName`s_Il2CppCodegenRegistration() at Il2CppCodeRegistration.cpp:59), Cleanup=0x0000000000000000, order=0)(), void (*)(), int) at RegisterRuntimeInitializeAndCleanup.cpp:14:5 [opt]    frame #1: 0x00000001200788d8 dyld`ImageLoaderMachO::doModInitFunctions(ImageLoader::LinkContext const&amp;) + 260    frame #2: 0x0000000120078a78 dyld`ImageLoaderMachO::doInitialization(ImageLoader::LinkContext const&amp;) + 36    frame #3: 0x00000001200740dc dyld`ImageLoader::recursiveInitialization(ImageLoader::LinkContext const&amp;, unsigned int, char const*, ImageLoader::InitializerTimingList&amp;, ImageLoader::UninitedUpwards&amp;) + 368    frame #4: 0x0000000120073280 dyld`ImageLoader::processInitializers(ImageLoader::LinkContext const&amp;, unsigned int, ImageLoader::InitializerTimingList&amp;, ImageLoader::UninitedUpwards&amp;) + 144    frame #5: 0x0000000120073334 dyld`ImageLoader::runInitializers(ImageLoader::LinkContext const&amp;, ImageLoader::InitializerTimingList&amp;) + 84    frame #6: 0x0000000120066088 dyld`dyld::initializeMainExecutable() + 220    frame #7: 0x000000012006a130 dyld`dyld::_main(macho_header const*, unsigned long, int, char const**, char const**, char const**, unsigned long*) + 3784    frame #8: 0x0000000120065044 dyld`_dyld_start + 68</code></pre><p>发现会注册<code>s_Il2CppCodegenRegistration</code>这个函数，然而这个函数并不在il2cpp之中，在<code>Il2CppCodeRegistration.cpp</code>这个文件里面，这个文件却在游戏的<code>./Classes/Native/Il2CppCodeRegistration.cpp</code>文件之中。当然还有个重要的全局变量<code>g_MetadataRegistration</code>在<code>Classes/Native/Il2CppMetadataRegistration.cpp</code>之中</p><pre><code class="c++">extern const Il2CppMetadataRegistration g_MetadataRegistration;static const Il2CppCodeGenOptions s_Il2CppCodeGenOptions = {    true,};void s_Il2CppCodegenRegistration(){    il2cpp_codegen_register (&amp;g_CodeRegistration, &amp;g_MetadataRegistration, &amp;s_Il2CppCodeGenOptions);}#if RUNTIME_IL2CPPstatic il2cpp::utils::RegisterRuntimeInitializeAndCleanup s_Il2CppCodegenRegistrationVariable (&amp;s_Il2CppCodegenRegistration, NULL);#endif</code></pre><p>这里的<code>il2cpp_codegen_register</code>函数其实是一个inline的函数</p><pre><code class="c++">// TODO: This file should contain all the functions and type declarations needed for the generated code.// Hopefully, we stop including everything in the generated code and know exactly what dependencies we have.// Note that all parameter and return types should match the generated types not the runtime types.inline void il2cpp_codegen_register(const Il2CppCodeRegistration* const codeRegistration, const Il2CppMetadataRegistration* const metadataRegistration, const Il2CppCodeGenOptions* const codeGenOptions){    il2cpp::vm::MetadataCache::Register(codeRegistration, metadataRegistration, codeGenOptions);}</code></pre><p>也就是说会直接传给<code>il2cpp::vm::MetadataCache::Register</code>到这里就和前面的对上了。至于为什么要这么设计，可以看这个函数的注释。我的理解在于像所有函数以及类型是需要在实际游戏项目build出来以后才能知道的。这里为了模块独立，将这部分的代码放到了游戏本身代码之中，然后il2cpp提供接口去初始化这些数据。</p><p>看下<code>g_MetadataRegistration</code>的初始值(这里是我游戏的数据，每个游戏数据不同)</p><pre><code class="c++">extern const Il2CppMetadataRegistration g_MetadataRegistration = {    4524,    s_Il2CppGenericTypes,    805,    g_Il2CppGenericInstTable,    5892,    s_Il2CppGenericMethodFunctions,    12345,    g_Il2CppTypeTable,    6412,    g_Il2CppMethodSpecTable,    2479,    g_FieldOffsetTable,    2479,    g_Il2CppTypeDefinitionSizesTable,    7998,    g_MetadataUsages,};</code></pre><p>这个<code>Il2CppMetadataRegistration</code>结构体如下</p><pre><code class="c++">typedef struct Il2CppMetadataRegistration{    int32_t genericClassesCount;    Il2CppGenericClass* const * genericClasses;    int32_t genericInstsCount;    const Il2CppGenericInst* const * genericInsts;    int32_t genericMethodTableCount;    const Il2CppGenericMethodFunctionsDefinitions* genericMethodTable;    int32_t typesCount;    const Il2CppType* const * types;    int32_t methodSpecsCount;    const Il2CppMethodSpec* methodSpecs;    FieldIndex fieldOffsetsCount;    const int32_t** fieldOffsets;    TypeDefinitionIndex typeDefinitionsSizesCount;    const Il2CppTypeDefinitionSizes** typeDefinitionsSizes;    const size_t metadataUsagesCount;    void** const* metadataUsages;} Il2CppMetadataRegistration;</code></pre><p>比如这里，一共有12345种类型的<code>typesCount</code></p><h4><a href="#metadata-jia-zai-liu-cheng-zong-jie" class="header-anchor">#</a><span id="metadata-jia-zai-liu-cheng-zong-jie">metadata加载流程-总结</span></h4><blockquote><p>将从正向以及源代码的角度去分析metadata加载的过程总结</p></blockquote><p>前面主要从逆向分析和调试的角度去分析了加载的整体流程，下面我们从正向流程总结下函数是什么调用执行的。</p><p>程序最开始执行在<code>mod_init_func</code>之中，即模块初始化函数（从上面的调试堆栈上也能看出来）</p><pre><code>_mod_init_func:0000000100CF54A0             __GLOBAL__sub_I_Il2CppCodeRegistration.cpp</code></pre><p>函数如下</p><pre><code class="c++">__int64 _GLOBAL__sub_I_Il2CppCodeRegistration_cpp(){  return il2cpp::utils::RegisterRuntimeInitializeAndCleanup::RegisterRuntimeInitializeAndCleanup(           (il2cpp::utils::RegisterRuntimeInitializeAndCleanup *)&amp;s_Il2CppCodegenRegistrationVariable,           (void (*)(void))s_Il2CppCodegenRegistration,           0LL,           0);}</code></pre><p>然后下面就执行了<code>il2cpp::utils::RegisterRuntimeInitializeAndCleanup::RegisterRuntimeInitializeAndCleanup</code>函数，这里会去注册回调函数<code>s_Il2CppCodegenRegistration</code>，然而这个函数定义在<code>Classes/Native/Il2CppCodeRegistration.cpp</code>里面</p><pre><code class="c++">void s_Il2CppCodegenRegistration(){    il2cpp_codegen_register (&amp;g_CodeRegistration, &amp;g_MetadataRegistration, &amp;s_Il2CppCodeGenOptions);}</code></pre><p>当然这里仅仅是注册，后面并没有立即执行这个函数。执行的时机是在之前分析的调用链之中</p><pre><code>UnityInitApplicationNoGraphics()--InitializeIl2CppFromMain()----il2cpp_init(&quot;IL2CPP Root Domain&quot;);------il2cpp::vm::Runtime::Init()--------il2cpp::utils::RegisterRuntimeInitializeAndCleanup::ExecuteInitializations()----------s_Il2CppCodegenRegistration()</code></pre><p>这里才会去执行<code>s_Il2CppCodegenRegistration</code>函数，我们继续分析。这个函数会调用<code>il2cpp_codegen_register</code>函数并传入三个重要的参数。三个参数数据如下</p><p>首先<code>g_CodeRegistration</code>是在<code>Classes/Native/Il2CppCodeRegistration.cpp</code>中初始化的，类似下面</p><pre><code class="c++">extern const Il2CppCodeRegistration g_CodeRegistration = {    12950,    g_MethodPointers,    0,    NULL,    5063,    g_Il2CppGenericMethodPointers,    1911,    g_Il2CppInvokerPointers,    3103,    g_AttributeGenerators,    306,    g_UnresolvedVirtualMethodPointers,    195,    g_Il2CppInteropData,};</code></pre><p>然后<code>g_MetadataRegistration</code>是在<code>Classes/Native/Il2CppMetadataRegistration.cpp</code>中初始化的，类似下面</p><pre><code class="c++">extern const Il2CppMetadataRegistration g_MetadataRegistration = {    4524,    s_Il2CppGenericTypes,    805,    g_Il2CppGenericInstTable,    5892,    s_Il2CppGenericMethodFunctions,    12345,    g_Il2CppTypeTable,    6412,    g_Il2CppMethodSpecTable,    2479,    g_FieldOffsetTable,    2479,    g_Il2CppTypeDefinitionSizesTable,    7998,    g_MetadataUsages,};</code></pre><p>最后<code>s_Il2CppCodeGenOptions</code>在<code>Classes/Native/Il2CppCodeRegistration.cpp</code>之中，类似下面</p><pre><code class="c++">static const Il2CppCodeGenOptions s_Il2CppCodeGenOptions = {    true,};</code></pre><p>这样三个参数就准备好了，然后调用<code>il2cpp_codegen_register</code>，这个函数其实是一个inline函数，在<code>/il2cpp/libil2cpp/codegen/il2cpp-codegen-il2cpp.h</code>文件里面</p><pre><code class="c++">inline void il2cpp_codegen_register(const Il2CppCodeRegistration* const codeRegistration, const Il2CppMetadataRegistration* const metadataRegistration, const Il2CppCodeGenOptions* const codeGenOptions){    il2cpp::vm::MetadataCache::Register(codeRegistration, metadataRegistration, codeGenOptions);}</code></pre><p>也就是说是调用了<code>il2cpp::vm::MetadataCache::Register</code>函数，这个函数在<code>il2cpp/libil2cpp/vm/MetadataCache.cpp</code>文件里面</p><pre><code class="c++">void MetadataCache::Register(const Il2CppCodeRegistration* const codeRegistration, const Il2CppMetadataRegistration* const metadataRegistration, const Il2CppCodeGenOptions* const codeGenOptions){    s_Il2CppCodeRegistration = codeRegistration;    s_Il2CppMetadataRegistration = metadataRegistration;    s_Il2CppCodeGenOptions = codeGenOptions;    for (int32_t j = 0; j &lt; metadataRegistration-&gt;genericClassesCount; j++)        if (metadataRegistration-&gt;genericClasses[j]-&gt;typeDefinitionIndex != kTypeIndexInvalid)            metadata::GenericMetadata::RegisterGenericClass(metadataRegistration-&gt;genericClasses[j]);    for (int32_t i = 0; i &lt; metadataRegistration-&gt;genericInstsCount; i++)        s_GenericInstSet.insert(metadataRegistration-&gt;genericInsts[i]);    s_InteropData.assign_external(codeRegistration-&gt;interopData, codeRegistration-&gt;interopDataCount);}</code></pre><p>这里就看到了我们熟悉的变量<code>s_Il2CppMetadataRegistration</code>到这里<code>il2cpp::utils::RegisterRuntimeInitializeAndCleanup::ExecuteInitializations</code>就执行完了，下面将会执行最重要的metadata加载函数<code>MetadataCache::Initialize()</code>函数调用结构如下</p><pre><code>UnityInitApplicationNoGraphics()--InitializeIl2CppFromMain()----il2cpp_init(&quot;IL2CPP Root Domain&quot;);------il2cpp::vm::Runtime::Init()--------il2cpp::utils::RegisterRuntimeInitializeAndCleanup::ExecuteInitializations()----------s_Il2CppCodegenRegistration()--------MetadataCache::Initialize()</code></pre><p>函数体如下</p><pre><code class="c++">void MetadataCache::Initialize(){    s_GlobalMetadata = vm::MetadataLoader::LoadMetadataFile(&quot;global-metadata.dat&quot;);    s_GlobalMetadataHeader = (const Il2CppGlobalMetadataHeader*)s_GlobalMetadata;    IL2CPP_ASSERT(s_GlobalMetadataHeader-&gt;sanity == 0xFAB11BAF);    IL2CPP_ASSERT(s_GlobalMetadataHeader-&gt;version == 24);    ...}</code></pre><p>这里全部流程就结束了，也就是所有初始的变量值我们都知道从哪里来的。接下来将会重点分析<code>MetadataCache::Initialize()</code>加载的具体实现细节。</p><h4><a href="#shi-yan-jie-xi-il2cpp-codegen-initialize-method-guo-cheng" class="header-anchor">#</a><span id="shi-yan-jie-xi-il2cpp-codegen-initialize-method-guo-cheng">实验（解析il2cpp_codegen_initialize_method过程）</span></h4><blockquote><p>主要分析<code>il2cpp_codegen_initialize_method</code>函数的执行流程</p><p>以下需要建议结合我写的010Editor对metadata的模板来分析</p></blockquote><p>这个函数其实是一个inline的函数，实际编译完以后并不存在。由于每个方法第一次初始化的时候都回去调用一次相当重要，所以我们分析一下这个函数主要干了什么。</p><p>下面是随便找的一个函数为例子说明</p><pre><code class="c++">// System.Void click1::Click()extern &quot;C&quot; IL2CPP_METHOD_ATTR void click1_Click_mADA9E988D60543553FB6489103DE368DDF13AA0A (click1_tBA7675B5632245C8DFC65538FFA3D8F5AC215128 * __this, const RuntimeMethod* method){    static bool s_Il2CppMethodInitialized;    if (!s_Il2CppMethodInitialized)    {        il2cpp_codegen_initialize_method (click1_Click_mADA9E988D60543553FB6489103DE368DDF13AA0A_MetadataUsageId);        s_Il2CppMethodInitialized = true;    }  ...}</code></pre><p>基本所有方法在第一次执行的时候都会调用<code>il2cpp_codegen_initialize_method</code>，即如下代码</p><pre><code class="c++">inline void il2cpp_codegen_initialize_method(uint32_t index){    il2cpp::vm::MetadataCache::InitializeMethodMetadata(index);}</code></pre><p>这个方法就比较熟悉了，这里传入的是方法的id，即<code>click1_Click_mADA9E988D60543553FB6489103DE368DDF13AA0A_MetadataUsageId</code></p><p>这个id在<code>Classes/Native/Il2CppMetadataUsage.cpp</code>文件之中定义了值为</p><pre><code class="c">extern const uint32_t click1_Click_mADA9E988D60543553FB6489103DE368DDF13AA0A_MetadataUsageId = 7967;</code></pre><p>而且数量和metadata里面的<code>metadataHeader.metadataUsageListsCount / sizeof(Il2CppMetadataUsageList)</code>的数量相等，因为就是去这个表里面索引的。如下代码</p><pre><code class="c++">void MetadataCache::InitializeMethodMetadata(uint32_t index){    IL2CPP_ASSERT(s_GlobalMetadataHeader-&gt;metadataUsageListsCount &gt;= 0 &amp;&amp; index &lt;= static_cast&lt;uint32_t&gt;(s_GlobalMetadataHeader-&gt;metadataUsageListsCount));    const Il2CppMetadataUsageList* metadataUsageLists = MetadataOffset&lt;const Il2CppMetadataUsageList*&gt;(s_GlobalMetadata, s_GlobalMetadataHeader-&gt;metadataUsageListsOffset, index);    uint32_t start = metadataUsageLists-&gt;start;    uint32_t count = metadataUsageLists-&gt;count;    utils::dynamic_array&lt;Il2CppMetadataUsage&gt; acceptAllUsages;    IntializeMethodMetadataRange(start, count, acceptAllUsages);}</code></pre><p>从这个表中会得到开始的地址以及数量，这里解释下这里的数量的意思：一个方法里面往往会用到其他类，类型或者字符串。这里的数量就是用到的所有类型的总和。</p><p>这里方法的值如下：</p><pre><code>start:27517 count:8</code></pre><p>然后调用<code>IntializeMethodMetadataRange</code>函数</p><pre><code class="c++">void MetadataCache::IntializeMethodMetadataRange(uint32_t start, uint32_t count, const utils::dynamic_array&lt;Il2CppMetadataUsage&gt;&amp; expectedUsages){    for (uint32_t i = 0; i &lt; count; i++)    {        uint32_t offset = start + i;        IL2CPP_ASSERT(s_GlobalMetadataHeader-&gt;metadataUsagePairsCount &gt;= 0 &amp;&amp; offset &lt;= static_cast&lt;uint32_t&gt;(s_GlobalMetadataHeader-&gt;metadataUsagePairsCount));        const Il2CppMetadataUsagePair* metadataUsagePairs = MetadataOffset&lt;const Il2CppMetadataUsagePair*&gt;(s_GlobalMetadata, s_GlobalMetadataHeader-&gt;metadataUsagePairsOffset, offset);        uint32_t destinationIndex = metadataUsagePairs-&gt;destinationIndex;        uint32_t encodedSourceIndex = metadataUsagePairs-&gt;encodedSourceIndex;        Il2CppMetadataUsage usage = GetEncodedIndexType(encodedSourceIndex);        if (IsMatchingUsage(usage, expectedUsages))        {            uint32_t decodedIndex = GetDecodedMethodIndex(encodedSourceIndex);            switch (usage)            {                case kIl2CppMetadataUsageTypeInfo:                    *s_Il2CppMetadataRegistration-&gt;metadataUsages[destinationIndex] = GetTypeInfoFromTypeIndex(decodedIndex);                    break;                case kIl2CppMetadataUsageIl2CppType:                    *s_Il2CppMetadataRegistration-&gt;metadataUsages[destinationIndex] = const_cast&lt;Il2CppType*&gt;(GetIl2CppTypeFromIndex(decodedIndex));                    break;                case kIl2CppMetadataUsageMethodDef:                case kIl2CppMetadataUsageMethodRef:                    *s_Il2CppMetadataRegistration-&gt;metadataUsages[destinationIndex] = const_cast&lt;MethodInfo*&gt;(GetMethodInfoFromIndex(encodedSourceIndex));                    break;                case kIl2CppMetadataUsageFieldInfo:                    *s_Il2CppMetadataRegistration-&gt;metadataUsages[destinationIndex] = GetFieldInfoFromIndex(decodedIndex);                    break;                case kIl2CppMetadataUsageStringLiteral:                    *s_Il2CppMetadataRegistration-&gt;metadataUsages[destinationIndex] = GetStringLiteralFromIndex(decodedIndex);                    break;                default:                    IL2CPP_NOT_IMPLEMENTED(MetadataCache::InitializeMethodMetadata);                    break;            }        }    }}</code></pre><p>这个方法会依据传入的数量进行遍历，这里遍历的其实是<code>metadataUsagePairs</code>这张表。这里数量为8，所以这8个数据如下</p><table><thead><tr><th>i</th><th>destinationIndex</th><th>encodedSourceIndex</th><th>usage</th><th>decodedIndex</th><th>value</th></tr></thead><tbody><tr><td>0</td><td>1728</td><td>536883176</td><td>kIl2CppMetadataUsageTypeInfo</td><td>12264</td><td>info_il2cpp_TypeInfo_var</td></tr><tr><td>1</td><td>352</td><td>536876564</td><td>kIl2CppMetadataUsageTypeInfo</td><td>5652</td><td>Mathil2cpp_TypeInfo_var</td></tr><tr><td>2</td><td>261</td><td>536871137</td><td>kIl2CppMetadataUsageTypeInfo</td><td>225</td><td>Int32_il2cpp_TypeInfo_var</td></tr><tr><td>3</td><td>1341</td><td>536881179</td><td>kIl2CppMetadataUsageTypeInfo</td><td>10267</td><td>Debug_il2cpp_TypeInfo_var</td></tr><tr><td>4</td><td>1793</td><td>3221227325</td><td>kIl2CppMetadataUsageMethodRef</td><td>1853</td><td>GameObject_GetComponent_TisText__RuntimeMethod_var</td></tr><tr><td>5</td><td>9565</td><td>2684358272</td><td>kIl2CppMetadataUsageStringLiteral</td><td>3712</td><td>stringLiteral77E95373…(“background/Canvas/error”)</td></tr><tr><td>6</td><td>6161</td><td>2684354738</td><td>kIl2CppMetadataUsageStringLiteral</td><td>178</td><td>stringLiteralB858CB28…(“”)</td></tr><tr><td>7</td><td>9566</td><td>2684358273</td><td>kIl2CppMetadataUsageStringLiteral</td><td>3713</td><td>stringLiteral070E659B…(“英雄战斗力不足，请修炼或者重生增加战斗力”)</td></tr></tbody></table><p>上表就是解析一个方法id得到的数据，可以看到有type、method、string等信息。其中destinationIndex的值就是在对应表中去查的地址值，也就是这里将metadata里面的数据读取出来以后和内存中的地址关联了起来。那么下面去做字符串恢复是不是就很简单了，就是遍历所有的方法id，即遍历metadataUsageLists把所有的方法中用到的数据都dump出来。</p><h4><a href="#ni-xiang" class="header-anchor">#</a><span id="ni-xiang">逆向</span></h4><ul><li><p><strong>il2CppDumper</strong></p><p><a href="https://github.com/Perfare/Il2CppDumper">https://github.com/Perfare/Il2CppDumper</a></p></li><li><p><strong>Global-Metadata Hiding</strong></p><p><a href="https://floe-ice.cn/archives/55" target="_blank" rel="external">https://floe-ice.cn/archives/55</a></p></li><li><p><strong>unity_metadata_loader</strong> （ida python plugin）</p><p><a href="https://github.com/nevermoe/unity_metadata_loader">https://github.com/nevermoe/unity_metadata_loader</a></p></li><li><p><strong>unity3d-metadata-010editor</strong>（解析metadata的模板）</p><p><a href="https://github.com/4ch12dy/unity3d-metadata-010editor">https://github.com/4ch12dy/unity3d-metadata-010editor</a></p></li></ul><h4><a href="#xil2cppdumper" class="header-anchor">#</a><span id="xil2cppdumper">XIL2CppDumper</span></h4><pre><code> __  _____ _     ____   ____             ____                                   \ \/ /_ _| |   |___ \ / ___|_ __  _ __ |  _ \ _   _ _ __ ___  _ __   ___ _ __   \  / | || |     __) | |   | &#39;_ \| &#39;_ \| | | | | | | &#39;_ ` _ \| &#39;_ \ / _ \ &#39;__|  /  \ | || |___ / __/| |___| |_) | |_) | |_| | |_| | | | | | | |_) |  __/ |    /_/\_\___|_____|_____|\____| .__/| .__/|____/ \__,_|_| |_| |_| .__/ \___|_|                               |_|   |_|                         |_|            +--------------------------------------------------------------------------------------+| XIL2CppDumper | a tool of C++ version IL2CppDumper made by xia0@2019                 |+--------------------------------------------------------------------------------------+| Info          | version: 0.2 support: iOS[arm64] Android[arm64] il2cpp[24.1/24.0]    |+--------------------------------------------------------------------------------------+| Usage         | XIL2CppDumper unity_metadata_file_path il2cpp_so_or_macho_file_path  |+--------------------------------------------------------------------------------------+| Blog          | http://4ch12dy.site                                                  |+--------------------------------------------------------------------------------------+| Github        | https://github.com/4ch12dy                                           |+--------------------------------------------------------------------------------------+| Specail thanks to Perfare&#39;s Il2CppDumper:https://github.com/Perfare/Il2CppDumper     |+--------------------------------------------------------------------------------------+</code></pre><p>基于分析的原理，我写了一个C++版本的dump工具：XIL2Cppdumper</p><p>目前支持的平台有Android和iOS，理论上支持所有的il2cpp版本（适配新版本十分方便）</p><p>项目地址：<a href="https://github.com/4ch12dy/XIL2CppDumper">https://github.com/4ch12dy/XIL2CppDumper</a></p><h4><a href="#can-kao" class="header-anchor">#</a><span id="can-kao">参考</span></h4><ul><li><p><a href="https://blogs.unity3d.com/2015/05/06/an-introduction-to-ilcpp-internals/" target="_blank" rel="external">https://blogs.unity3d.com/2015/05/06/an-introduction-to-ilcpp-internals/</a> 一些il2cpp的历史原因</p></li><li><p><a href="https://github.com/d4wu/unity3d-android-reverse-demo">https://github.com/d4wu/unity3d-android-reverse-demo</a>  本文测试的游戏demo</p></li><li><a href="https://www.nevermoe.com/2016/08/10/unity-metadata-loader/" target="_blank" rel="external">https://www.nevermoe.com/2016/08/10/unity-metadata-loader/</a> 还原使用IL2CPP编译的unity游戏的symbol（一）</li><li><a href="https://www.nevermoe.com/2016/09/08/还原使用il2cpp的symbol（二）/" target="_blank" rel="external">https://www.nevermoe.com/2016/09/08/%e8%bf%98%e5%8e%9f%e4%bd%bf%e7%94%a8il2cpp%e7%9a%84symbol%ef%bc%88%e4%ba%8c%ef%bc%89/</a></li><li><a href="https://github.com/anydream/il2cpp">https://github.com/anydream/il2cpp</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3&gt;&lt;a href=&quot;#unity3d-il2cpp-yuan-li-jie-xi-ji-ni-xiang-fen-xi&quot; class=&quot;header-anchor&quot;&gt;#&lt;/a&gt;&lt;span id=&quot;unity3d-il2cpp-yuan-li-jie-xi-ji-ni-xia
      
    
    </summary>
    
      <category term="RE" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/categories/RE/"/>
    
    
      <category term="RE" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/RE/"/>
    
      <category term="unity3d" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/unity3d/"/>
    
      <category term="il2cpp" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/il2cpp/"/>
    
  </entry>
  
  <entry>
    <title>cocos2d-x游戏逆向分析实践</title>
    <link href="https://github.com/4ch12dy/4ch12dy.github.io.git/2019/10/17/cocos2d-x-game-re/cocos2d-x-game-re/"/>
    <id>https://github.com/4ch12dy/4ch12dy.github.io.git/2019/10/17/cocos2d-x-game-re/cocos2d-x-game-re/</id>
    <published>2019-10-17T11:53:11.000Z</published>
    <updated>2019-10-17T12:58:54.785Z</updated>
    
    <content type="html"><![CDATA[<h3><a href="#cocos2d-x-you-xi-ni-xiang-fen-xi-shi-jian" class="header-anchor">#</a><span id="cocos2d-x-you-xi-ni-xiang-fen-xi-shi-jian">cocos2d-x游戏逆向分析实践</span></h3><blockquote><p>本文将以一款简单的cocos2d-x的iOS版游戏《PassItThough》来进行简单的逆向分析以及外挂编写</p></blockquote><h4><a href="#ru-he-xia-shou" class="header-anchor">#</a><span id="ru-he-xia-shou">如何下手？</span></h4><p>这是我分析的第一个cocos2d-x的游戏，也是我第一次分析游戏。就我目前的搜索到的资料来看，关于cocos2d-x游戏的逆向分析文章可以说几乎没有，所以我准备写一篇自己在分析cocos2d-x游戏过程中的一些理解和技巧。如何下手确实是我或者大多数刚进行游戏分析的最关键的问题。我会尽可能的描述清楚我从对游戏一无所知到最后成功破解一个游戏的过程，从我学习cocos2d-x游戏框架到最终破解完成耗时差不多6天时间，在这些时间里面前面4天都主要在学习cocos2d-x这个游戏引擎，后面对《PassItThough》游戏的逆向破解反而只用了两天，这里我要说明的一点在于，只有你对这个引擎或者框架足够熟悉了解以后才能有方向的进行逆向，瞎猜或者乱撞运气好可能会成功，但我坚持的观点是逆向不是全靠猜的，而是有方向的。所以如果在看这篇文章之前对cocosd-x这个游戏引擎还不熟悉的话，建议先学习一下这个引擎之后再回来看这篇文章。</p><h4><a href="#you-xi-jie-shao" class="header-anchor">#</a><span id="you-xi-jie-shao">游戏介绍</span></h4><p>这是一个十分简单的游戏，如下所示</p><p><img src="https://github.com/4ch12dy/4ch12dy.github.io/blob/master/articlePic/cocos2d-x-game-re/PassItThough.jpeg?raw=true" alt="PassItThough"></p><p>游戏玩法就是拖动红环到另一端即可进入下一关，默认只有过关以后才能进入下一关，其他关卡都是没有解锁的。但是在拖动过程之中不能触碰到海草，一旦触碰就会游戏失败。</p><p>这里有两种破解选择：</p><ul><li>忽略海草触碰，不触发游戏失败</li><li>解锁关卡，使其能够玩后面的关卡</li></ul><h4><a href="#ni-xiang-fen-xi-si-lu" class="header-anchor">#</a><span id="ni-xiang-fen-xi-si-lu">逆向分析思路</span></h4><p>先说结果，我最终实现的是解锁关卡，再进入一个关卡的时候直接游戏通关，能够解锁下一个关卡。</p><p>由于cocos2d-x是c++编写的游戏，在进行逆向的时候如果没有目的盲目的分析，你可能会怀疑人生，拖到ida里面会发现没有函数符号，全是指针偏移等，可以说无从下手。在这里，我们还是从最终目的出发，假设我们想实现触碰海草不会触发游戏失败的外挂，这里应该怎么思考实现这个功能呢？</p><p>从我学习cocos2d-x的经验来看，这里需要解决的是如何找到碰撞检测函数，一旦我们找到的话直接patch掉这个函数不就可以实现目的了吗？但是怎么去找这个函数还是十分麻烦的，我的想法是可能这个函数在点击和拖动事件的回调之中，也就是在拖动的过程中去判断环和海草是否碰撞。那么接下来的问题就是怎么找到拖动的回调函数？</p><p>熟悉cocos2d-x就知道，一般实现逻辑就是在Scene中注册点击事件回调函数来处理屏幕中的点击事件，通常的代码如下：</p><pre><code class="c++">void HelloWorld::registerWithTouchDispatcher(){    auto touchListener = EventListenerTouchOneByOne::create();    touchListener-&gt;onTouchBegan = CC_CALLBACK_2(HelloWorld::onTouchBegan, this);    touchListener-&gt;onTouchMoved = CC_CALLBACK_2(HelloWorld::onTouchMoved, this);    touchListener-&gt;onTouchEnded = CC_CALLBACK_2(HelloWorld::onTouchEnded,this);    _eventDispatcher-&gt;addEventListenerWithSceneGraphPriority(touchListener, this);    this-&gt;schedule(schedule_selector(HelloWorld::updatePoint));}bool HelloWorld::onTouchBegan(Touch *touch,  Event*event){    CCLOG(&quot;touch Began.&quot;);    return true;}void HelloWorld::onTouchMoved(Touch *touch,  Event*event){       CCLOG(&quot;touch moved.&quot;);    // 这里编写碰撞逻辑}void HelloWorld::onTouchEnded(Touch *touch,  Event*event){    CCLOG(&quot;touch ended.&quot;);}</code></pre><p>将<code>registerWithTouchDispatcher</code>函数放到Scene的create函数或init函数即可。虽然游戏的符号都是strip的，但是我们还是可以通过C++虚函数表能够拿到一些类的信息，这里我们就去ida中搜索<code>EventListenerTouchOneByOne</code> 会得到如下结果</p><pre><code class="assembly">__const:00000001005DD670 ; `vtable for&#39;cocos2d::EventListenerTouchOneByOne__const:00000001005DD670 _ZTVN7cocos2d26EventListenerTouchOneByOneE DCQ 0 ; offset to this__const:00000001005DD678                 DCQ _ZTIN7cocos2d26EventListenerTouchOneByOneE ; `typeinfo for&#39;cocos2d::EventListenerTouchOneByOne__const:00000001005DD680 off_1005DD680   DCQ sub_100344E10       ; DATA XREF: sub_100344D24+10↑o__const:00000001005DD680                                         ; sub_100344D24+14↑o ...__const:00000001005DD688                 DCQ sub_100344E14__const:00000001005DD690                 DCQ sub_100344FAC__const:00000001005DD698                 DCQ sub_100344FBC</code></pre><p>这里直接看第一个虚函数的交叉引用，因为如果熟悉c++逆向的话就知道，在初始化一个类的时候，紧接着就会将第一个地址出写入虚函数地址表首项地址。拿到了初始化代码的位置，再进行一次交叉引用就能拿到调用这个类的位置。这里第一次交叉引用得到如下</p><pre><code class="c++">_QWORD *EventListenerTouchOneByOne::create(){  __int64 v0; // x0  _QWORD *v1; // x19  v0 = operator new(256LL, &amp;std::nothrow);  v1 = (_QWORD *)v0;  if ( v0 )  {    sub_1003B8154(v0);    *v1 = off_1005DD6B0;    v1[19] = 0LL;    v1[23] = 0LL;    v1[27] = 0LL;    v1[31] = 0LL;    if ( (unsigned int)sub_1003452D4(v1) )    {      sub_1003C8778((__int64)v1);    }    else    {      (*(void (__fastcall **)(_QWORD *))(*v1 + 8LL))(v1);      v1 = 0LL;    }  }  return v1;</code></pre><p>这里的<code>off_1005DD6B0</code>就是虚函数表首地址，可以明显的看出来这是<code>EventListenerTouchOneByOne</code>的构造函数。（所以一些启示就是如果一个类有虚函数，那么在new内存之后马上就会设置虚函数表，所以可以根据此来找到关键代码），找到了构造函数那么我们在进行一次交叉引用去拿到调用的位置</p><pre><code class="c++">v273 = EventListenerTouchOneByOne::create(v272);*(_OWORD *)v304 = (unsigned __int64)sub_1000155BC;v305 = v1;sub_1000158F0(v273 + 128, v304);*(_OWORD *)v304 = (unsigned __int64)sub_1000159AC;v305 = v1;sub_1000158F0(v273 + 192, v304);*(_OWORD *)v304 = (unsigned __int64)sub_1000159FC;v305 = v1;sub_1000158F0(v273 + 160, v304);*(_OWORD *)v304 = (unsigned __int64)sub_100015BE8;</code></pre><p>这里我们就知道了那个函数就是<code>EventListenerTouchOneByOne::create</code>，所以我对其进行了重命名。再观察下面的代码以及和前面<code>EventListenerTouchOneByOne</code>的代码一结合就知道下面应该是在设置touch的事件，这里有一个比较快速的方法知道点击事件对应的方法，通过对下面的几个函数下断点，然后点击屏幕看断点的触发顺序知道分别对应的点击函数，这里我得到的如下</p><pre><code>v273 = EventListenerTouchOneByOne::create(v272);*(_OWORD *)v304 = (unsigned __int64)onTouchMoved;v305 = v1;sub_1000158F0(v273 + 128, v304);*(_OWORD *)v304 = (unsigned __int64)onTouchEnded;v305 = v1;sub_1000158F0(v273 + 192, v304);*(_OWORD *)v304 = (unsigned __int64)onTouchBegan;v305 = v1;sub_1000158F0(v273 + 160, v304);*(_OWORD *)v304 = (unsigned __int64)j_onTouchBegan;</code></pre><p>那么我们现在分析哪一个函数呢，直接点进去分析逆向分析还是很困难，必须缩小范围。接下来我将介绍一种技巧去找到关键函数。</p><p>游戏的代码虽然是没有符号的，但是一般资源文件是明文的，我们可以解包以后得到资源，再结合界面信息很容易去找到资源名，然后再ida中搜索资源的代码调用位置就能拿到一些线索。由于这个游戏拖动的是下面的拖动按钮。解包以后发现资源为<code>handle.png</code>在ida中搜索得到以下</p><pre><code>__cstring:000000010051314F                                         ; sub_100012134+185C↑o ...__cstring:0000000100513168 aCommonRing2Png DCB &quot;common/ring2.png&quot;,0__cstring:0000000100513168                                         ; DATA XREF: sub_100012134:loc_100013A3C↑o__cstring:0000000100513168                                         ; sub_100012134+190C↑o ...__cstring:0000000100513179 aCommonRingUp2P DCB &quot;common/ring_up2.png&quot;,0__cstring:0000000100513179                                         ; DATA XREF: sub_100012134+1B20↑o__cstring:0000000100513179                                         ; sub_100012134+1B24↑o ...__cstring:000000010051318D aCommonHandlePn DCB &quot;common/handle.png&quot;,0__cstring:000000010051318D                                         ; DATA XREF: sub_100012134+1EBC↑o__cstring:000000010051318D                                         ; sub_100012134+1EC0↑o ...__cstring:000000010051319F aCommonWinPanel DCB &quot;common/win_panel.png&quot;,0</code></pre><p>然后交叉引用得到如下</p><pre><code class="c++">sub_100014CA8(v303, &quot;common/handle.png&quot;);v225 = sub_10039FAD4((__int64)v303);*(_QWORD *)(v1 + 1120) = v225;if ( SHIBYTE(v304) &amp; 0x80000000 ){  operator delete(v303[0]);  v225 = *(_QWORD *)(v1 + 1120);}sub_1000062CC(v225);v226 = *(_QWORD *)(v1 + 1120);(*(void (__fastcall **)(_QWORD))(*(_QWORD *)v226 + 136LL))(*(_QWORD *)(v1 + 1120));(*(void (__fastcall **)(__int64))(*(_QWORD *)v226 + 128LL))(v226);v227 = *(_QWORD *)(v1 + 1120);*(float *)v303 = (float)(*(float *)&amp;dword_1006DDC94 * 30.0) * *(float *)&amp;dword_1006DDCAC;*((float *)v303 + 1) = *((float *)&amp;qword_1006DDC9C + 1) * 0.37;(*(void (__cdecl **)(__int64, void **, __int64, __int64))(*(_QWORD *)v227 + 152LL))(v227, v303, v228, v229);(*(void (__fastcall **)(__int64, _QWORD, signed __int64))(*(_QWORD *)v1 + 528LL))(  v1,  *(_QWORD *)(v1 + 1120),  4LL);</code></pre><p>稍加分析就发现，就是将<code>common/handle.png</code>图片初始化为<code>Sprite</code>，也就是说那个按钮就是一个<code>Sprite</code>类，像这种类一般肯定会在<code>Scene</code>中保存其引用也就是这行代码</p><pre><code class="c++">*(_QWORD *)(v1 + 1120) = v225;</code></pre><p>分析这个的原因在于，我们可以去全局搜索调用这个类成员变量的位置，一般对其引用的就是关键代码。但是这里不能直接搜索，只能搜索汇编代码，所以得到这个类对象的汇编代码如下</p><pre><code>__text:0000000100013FF0                 ADRP            X1, #aCommonHandlePn@PAGE ; &quot;common/handle.png&quot;__text:0000000100013FF4                 ADD             X1, X1, #aCommonHandlePn@PAGEOFF ; &quot;common/handle.png&quot;__text:0000000100013FF8                 ADD             X0, SP, #0x160+var_100__text:0000000100013FFC                 BL              sub_100014CA8__text:0000000100014000                 ADD             X0, SP, #0x160+var_100__text:0000000100014004                 BL              sub_10039FAD4__text:0000000100014008                 STR             X0, [X19,#0x460]   // 关键点__text:000000010001400C                 LDRSB           W8, [SP,#0x160+anonymous_0+7]__text:0000000100014010                 TBZ             W8, #0x1F, loc_100014020__text:0000000100014014                 LDR             X0, [SP,#0x160+var_100] ; void *__text:0000000100014018                 BL              __ZdlPv ; operator delete(void *)</code></pre><p>这个地址<code>00100014008</code>就是我们需要的代码，<code>x0</code>就是<code>Sprite</code>，保存到<code>Scene</code>的0x460偏移处。既然如此，我们全局搜索<code>#0x460</code>这个偏移，我是写的一个简单的ida Python脚本搜索得到如下结果</p><pre><code>----------------- [xda] search-dism-str ----------------0x100014008    STR             X0, [X19,#0x460]    sub_1000121340x10001401c    LDR             X0, [X19,#0x460]    sub_1000121340x100014024    LDR             X20, [X19,#0x460]    sub_1000121340x10001404c    LDR             X0, [X19,#0x460]    sub_1000121340x100014084    LDR             X1, [X19,#0x460]    sub_1000121340x10001560c    LDR             X0, [X19,#0x460]    sub_1000155BC   // 点击回调函数0x100015644    LDR             X0, [X19,#0x460]    sub_1000155BC0x100015a54    LDR             X0, [X19,#0x460]    sub_1000159FC   // 点击回调函数0x100015ad4    LDR             X0, [X19,#0x460]    sub_1000159FC0x100017564    LDR             X20, [X19,#0x460]    sub_1000174DC0x100017e3c    LDR             X0, [X19,#0x460]    sub_100017A180x100017ec0    LDR             X0, [X19,#0x460]    sub_100017A180x100019bbc    STR             X0, [X19,#0x460]    sub_10001934C0x100019bd0    LDR             X20, [X19,#0x460]    sub_10001934C0x100019c00    LDR             X0, [X19,#0x460]    sub_10001934C0x100019c28    LDR             X1, [X19,#0x460]    sub_10001934C0x100019c40    LDR             X0, [X19,#0x460]    sub_10001934C0x10001be20    LDR             X1, [X19,#0x460]    sub_10001BDBC0x10001bf9c    LDR             X0, [X19,#0x460]    sub_10001BDBC0x100380a18    STR             S0, [X19,#0x460]    sub_10038095C0x100381c70    LDR             S2, [X19,#0x460]    sub_100381BB00x100381cc4    LDR             S2, [X19,#0x460]    sub_100381BB00x10039b588    LDR             S0, [X19,#0x460]    sub_10039B5400x1003a00b4    STR             XZR, [X19,#0x460]    sub_1003A00240x1003ead04    LDR             X8, [X19,#0x460]    sub_1003EACC40x1003eb58c    LDR             X8, [X19,#0x460]    sub_1003EB5600x10042a690    STR             W10, [X19,#0x460]    sub_10042A5D80x10042a698    LDR             W10, [X19,#0x460]    sub_10042A5D80x100458c48    STR             XZR, [X19,#0x460]    sub_100458B74--------------------------------------------------------</code></pre><p>结合之前那几个点击函数，会发现有两处相同的函数，即上面的回调函数。经过分析发现就是<code>onTouchMoved</code>和<code>onTouchBegan</code>对<code>Sprite</code>进行了引用。这也很合理，在这两个时间中肯定会对该<code>Sprite</code>进行操作。所以接下来重点分析这两个函数。不过我对其进行大量分析和调试发现，这两个函数中并没有进行碰撞检测。由于对游戏开发不熟悉，如果不是在拖动事件函数中检测，那又会在哪里检测呢？</p><h4><a href="#huan-ge-si-lu" class="header-anchor">#</a><span id="huan-ge-si-lu">换个思路</span></h4><p>前面说到检测碰撞的函数并不在拖动事件函数中，那还可能是怎么检测碰撞的呢？想象一下可能是用一个线程去循环检测是否发生碰撞以及游戏是否结束的。那我们又应该怎么去分析呢？虽然检测是在单独的线程之中，但检测碰撞本身肯定需要对环本身操作，所以用上面同样的方法去找到环的代码调用位置。</p><p>环初始化位置</p><pre><code class="c++">sub_100014CA8(v303, &quot;common/ring2.png&quot;);v145 = sub_10039FAD4((__int64)v303);if ( SHIBYTE(v304) &amp; 0x80000000 )  operator delete(v303[0]);v146 = (_QWORD *)(*(__int64 (__fastcall **)(__int64))(*(_QWORD *)v145 + 360LL))(v145);sub_1003A9470(&amp;v299, v146);sub_100014CA8(v303, &quot;common/ring2.png&quot;);sub_1003A9500(&amp;v301);v147 = sub_10039FB6C((__int64)v303, (__int64)&amp;v301);v148 = (__int64 *)(v1 + 824);*(_QWORD *)(v1 + 824) = v147;</code></pre><p>根据如下代码拿到在<code>Scene</code>中的偏移</p><pre><code class="assembly">__text:0000000100013ABC                 STR             X0, [X19,#0x338]</code></pre><p>然后用脚本去搜索</p><pre><code>----------------- [xda] search-dism-str ----------------0x100009138    MOV             W0, #0x338    sub_1000091240x100009148    MOV             W1, #0x338; size_t    sub_1000091240x100013ab8    ADD             X26, X19, #0x338    sub_1000121340x100013abc    STR             X0, [X19,#0x338]    sub_1000121340x100013b6c    LDR             X1, [X19,#0x338]    sub_1000121340x100013c18    LDR             X0, [X19,#0x338]    sub_1000121340x100013eb0    LDR             X21, [X19,#0x338]    sub_1000121340x1000150c4    LDR             X21, [X19,#0x338]    sub_1000150640x100015100    LDR             X21, [X19,#0x338]    sub_1000150640x1000151b0    LDR             X20, [X19,#0x338]    sub_1000150640x100015240    LDR             X0, [X19,#0x338]    sub_1000150640x100015258    LDR             X0, [X19,#0x338]    sub_1000150640x10001526c    LDR             X0, [X19,#0x338]    sub_1000150640x100015284    LDR             X0, [X19,#0x338]    sub_1000150640x100015b14    LDR             X0, [X19,#0x338]    onTouchBegan0x100015b2c    LDR             X21, [X19,#0x338]    onTouchBegan0x100015b68    LDR             X21, [X19,#0x338]    onTouchBegan0x1000175e8    LDR             X20, [X19,#0x338]    sub_1000174DC0x100017614    LDR             X21, [X19,#0x338]    sub_1000174DC0x100017650    LDR             X21, [X19,#0x338]    sub_1000174DC0x100017a3c    LDR             X21, [X0,#0x338]    sub_100017A180x100017a78    LDR             X21, [X19,#0x338]    sub_100017A180x100017e1c    LDR             X0, [X19,#0x338]    sub_100017A180x100017e5c    LDR             X0, [X19,#0x338]    sub_100017A180x100017ea0    LDR             X0, [X19,#0x338]    sub_100017A180x100017f08    LDR             X1, [X19,#0x338]    sub_100017A180x10001a0a8    STR             X0, [X19,#0x338]    sub_10001934C0x10001a0bc    LDR             X0, [X19,#0x338]    sub_10001934C0x10001a0c4    LDR             X0, [X19,#0x338]    sub_10001934C0x10001a0dc    LDR             X20, [X19,#0x338]    sub_10001934C0x10001a104    LDR             X20, [X19,#0x338]    sub_10001934C0x10001a12c    LDR             X1, [X19,#0x338]    sub_10001934C0x10001bc2c    LDR             X20, [X19,#0x338]    sub_10001BBA00x10001bec8    LDR             X20, [X19,#0x338]    sub_10001BDBC0x10001bf10    LDR             X26, [X19,#0x338]    sub_10001BDBC0x10001c100    LDR             X20, [X19,#0x338]    sub_10001C05C0x10001d2a8    LDR             X0, [X19,#0x338]    sub_10001D2440x10001d50c    LDR             X0, [X20,#0x338]    sub_10001D44C0x1002fa0b8    STR             W9, [X0,#0x338]    sub_1002F44380x1002fd610    LDR             W9, [X0,#0x338]    sub_1002FB5880x1002fd624    STR             W9, [X0,#0x338]    sub_1002FB5880x1002fd634    LDR             W10, [X0,#0x338]    sub_1002FB5880x1002fd640    STR             W9, [X0,#0x338]    sub_1002FB5880x1002fdfe4    LDR             W9, [X0,#0x338]    sub_1002FB5880x10030ba80    STR             W9, [X0,#0x338]    sub_1003098540x10030ba90    LDR             W10, [X0,#0x338]    sub_1003098540x10030d1f4    LDR             W9, [X0,#0x338]    sub_1003098540x10031115c    LDR             W9, [X0,#0x338]    sub_1003109140x100311170    STR             W9, [X0,#0x338]    sub_1003109140x100311180    LDR             W10, [X0,#0x338]    sub_1003109140x100311198    LDR             W9, [X0,#0x338]    sub_1003109140x1003111ec    LDR             W9, [X0,#0x338]    sub_1003109140x100311204    STR             W9, [X0,#0x338]    sub_1003109140x100311214    LDR             W10, [X0,#0x338]    sub_1003109140x100311220    STR             W9, [X0,#0x338]    sub_1003109140x100311230    LDR             W10, [X0,#0x338]    sub_1003109140x10031123c    STR             W9, [X0,#0x338]    sub_1003109140x10031124c    LDR             W10, [X0,#0x338]    sub_1003109140x100311258    STR             W9, [X0,#0x338]    sub_1003109140x100311268    LDR             W10, [X0,#0x338]    sub_1003109140x100311274    STR             W9, [X0,#0x338]    sub_1003109140x100311284    LDR             W10, [X0,#0x338]    sub_1003109140x100311290    STR             W9, [X0,#0x338]    sub_1003109140x100311298    LDR             W9, [X0,#0x338]    sub_1003109140x10034bdd0    LDR             X8, [X8,#0x338]    sub_10034BD500x1003597dc    LDR             X8, [X8,#0x338]    sub_1003597B00x10035991c    LDR             X8, [X8,#0x338]    sub_1003598E80x10035a044    LDR             X8, [X8,#0x338]    sub_100359FEC0x10037eae4    STR             XZR, [X19,#0x338]    sub_10037EA340x10038d3d8    MOV             W0, #0x338    sub_10038D2800x100392094    LDR             X8, [X8,#0x338]    sub_1003920400x100392288    STRB            W8, [X20,#0x338]    sub_1003922200x1003987d4    STR             XZR, [X19,#0x338]    sub_10039872C0x1003989f4    LDR             X0, [X0,#0x338]    sub_1003989D80x100398ec0    LDR             X0, [X19,#0x338]    sub_100398C240x100398ed0    LDR             X0, [X19,#0x338]    sub_100398C240x100398ee8    LDR             X0, [X19,#0x338]    sub_100398C240x100398f18    LDR             X1, [X19,#0x338]    sub_100398C240x10039906c    LDR             X0, [X20,#0x338]    sub_10039904C0x100399078    STR             X19, [X20,#0x338]    sub_10039904C0x1003994d0    LDR             X0, [X20,#0x338]    sub_1003994740x1003998a8    LDR             X8, [X19,#0x338]    sub_10039980C0x10039aaa0    ADD             X22, X19, #0x338    sub_10039AA540x10039ac48    ADD             X0, X19, #0x338    sub_10039ABE80x10039acf8    ADD             X20, X19, #0x338    sub_10039ACD40x1003e42b0    LDR             X1, [X19,#0x338]    sub_1003E41CC0x1003e42bc    STR             XZR, [X19,#0x338]    sub_1003E41CC0x100406318    LDR             X8, [X19,#0x338]    sub_1004062EC0x100407328    STR             X8, [X0,#0x338]    sub_10040728C0x100407458    STR             X9, [X0,#0x338]    sub_1004073680x100408428    LDR             X8, [X19,#0x338]    sub_1004079900x100409c1c    LDR             X8, [X19,#0x338]    sub_100409B580x10041265c    LDR             X8, [X20,#0x338]    sub_10041000C0x100414318    STR             X8, [X19,#0x338]    sub_1004141E00x1004217f4    STR             X8, [X19,#0x338]    sub_1004217140x100423de0    STR             X8, [X19,#0x338]    sub_100423D340x10042a724    STR             W8, [X19,#0x338]    sub_10042A5D80x10042aa04    ADD             X9, X27, #0x338    sub_10042A8A40x10042b548    LDR             W13, [X19,#0x338]    sub_10042B1AC0x100468170    STR             X8, [X20,#0x338]    sub_1004678F00x10046a948    LDR             X10, [X19,#0x338]    sub_100468D4C0x10046a964    LDR             X9, [X19,#0x338]    sub_100468D4C0x10046ede4    LDR             X9, [X19,#0x338]    sub_10046ECA00x10046fda0    STR             X8, [X19,#0x338]    sub_10046FCB80x10047dedc    ADD             X8, X8, #0x338    sub_10047DE000x10047e030    ADD             X8, X8, #0x338    sub_10047DE000x10047e380    ADD             X2, X2, #0x338    sub_10047DE000x10047e9d8    ADD             X2, X2, #0x338    sub_10047DE000x100480438    ADD             X2, X2, #0x338    sub_10047DE000x1004844a8    MOV             W1, #0x338; size_t    sub_10048445C0x1004845cc    MOV             W1, #0x338; size_t    sub_10048445C0x1004847f4    LDR             X11, [X21,#0x338]    sub_1004846C40x100484a9c    LDR             X23, [X19,#0x338]    sub_100484A640x100484e58    LDR             X20, [X19,#0x338]    sub_100484E300x100484fd0    LDR             X21, [X20,#0x338]    sub_100484FA40x100485088    LDR             X22, [X19,#0x338]    sub_1004850580x10048ede8    STR             X10, [X19,#0x338]    sub_10048EC380x10049c594    LDR             W13, [X1,#0x338]    sub_10049BAAC0x10049cdf8    ADD             X25, X20, #0x338    sub_10049CCA80x10049d50c    LDR             W12, [X21,#0x338]    sub_10049D46C0x10049dd94    ADD             X22, X20, #0x338    sub_10049DBDC0x10049df1c    STR             WZR, [X8,#0x338]    sub_10049DF08--------------------------------------------------------</code></pre><p>这里得到的结果有好多处，但其实没多少函数，我们对这些函数下断点。会发现总会断在如下位置</p><pre><code>==========================================xia0LLDB===========================================  BlockSymbolFile    Not Set The Block Symbol Json File, Try &#39;sbt -f&#39;  =============================================================================================  frame #0: [file:0x100017a18 mem:0x10215ba18] PassItThrough-mobile`Maybe c function? Distance:53664 &gt;= 2500 # Symbol:-[RootViewController didReceiveMemoryWarning] + 53664  frame #1: [file:0x100343c44 mem:0x102487c44] PassItThrough-mobile`Maybe c function? Distance:28352 &gt;= 2500 # Symbol:-[CDSoundEngineFader _allowableType] + 28352  frame #2: [file:0x10034bb48 mem:0x10248fb48] PassItThrough-mobile`Maybe c function? Distance:60868 &gt;= 2500 # Symbol:-[CDSoundEngineFader _allowableType] + 60868  frame #3: [file:0x10034d1e4 mem:0x1024911e4] PassItThrough-mobile`Maybe c function? Distance:66656 &gt;= 2500 # Symbol:-[CDSoundEngineFader _allowableType] + 66656  frame #4: [file:0x18540b058 mem:0x1d1e9b058] QuartzCore`CA::Display::DisplayLink::dispatch_items(unsigned long long, unsigned long long, unsigned long long) + 808   frame #5: [file:0x1854d49cc mem:0x1d1f649cc] QuartzCore`display_timer_callback(__CFMachPort*, void*, long, void*) + 276   frame #6: [file:0x180e14a94 mem:0x1cd8a4a94] CoreFoundation`__CFMachPortPerform + 192   frame #7: [file:0x180e3d0ec mem:0x1cd8cd0ec] CoreFoundation`__CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE1_PERFORM_FUNCTION__ + 60   frame #8: [file:0x180e3c7f4 mem:0x1cd8cc7f4] CoreFoundation`__CFRunLoopDoSource1 + 444   frame #9: [file:0x180e37384 mem:0x1cd8c7384] CoreFoundation`__CFRunLoopRun + 2088   frame #10: [file:0x180e36844 mem:0x1cd8c6844] CoreFoundation`CFRunLoopRunSpecific + 452   frame #11: [file:0x1830e5be8 mem:0x1cfb75be8] GraphicsServices`GSEventRunModal + 104   frame #12: [file:0x1ae78431c mem:0x1fb21431c] UIKitCore`UIApplicationMain + 216   frame #13: [file:0x10000cc00 mem:0x102150c00] PassItThrough-mobile`main + 56  frame #14: [file:0x1808ec020 mem:0x1cd37c020] libdyld.dylib`start + 4</code></pre><p>从堆栈上分析来看，这应该是一个timer事件，也就是会循环执行的一个函数，当游戏进入<code>Scene</code>以后这个函数就会一直循环执行。应该就是我们想找的函数了，接下来就重点分析<code>0x100017a18</code>这个函数。</p><p>在分析前，为了更加确实是检测碰撞的函数，我在调试器中动态patch了第一条指令改为<code>ret</code>。发现就算环和海草碰撞甚至脱到外面游戏也不会失败。验证了我们的猜想，但是由于把整个函数干掉了，所以就算拖到末尾也不会游戏通关。所以还得进一步分析，最终我找到一个patch点</p><pre><code class="assembly">__text:0000000100017C50                 FMUL            S2, S2, S3__text:0000000100017C54                 FADD            S1, S1, S2__text:0000000100017C58                 FCMP            S0, S1__text:0000000100017C5C                 B.GT            loc_100017C88__text:0000000100017C60                 LDR             X0, [X19,#0x340]__text:0000000100017C64                 LDR             X8, [X0]__text:0000000100017C68                 LDR             X8, [X8,#0xE0]__text:0000000100017C6C                 BLR             X8__text:0000000100017C70                 LDR             S1, [X19,#0x5D0]__text:0000000100017C74                 LDR             S2, [X21]__text:0000000100017C78                 FMUL            S2, S2, S8__text:0000000100017C7C                 FADD            S1, S1, S2__text:0000000100017C80                 FCMP            S0, S1__text:0000000100017C84                 B.LE            loc_100017DDC  // patch 为nop__text:0000000100017C88__text:0000000100017C88 loc_100017C88                           ; CODE XREF: sub_100017A18+244↑j__text:0000000100017C88                 MOV             X0, X19__text:0000000100017C8C                 BL              sub_100357FA8__text:0000000100017C90                 MOV             X0, X19__text:0000000100017C94                 BL              sub_100357F94__text:0000000100017C98                 BL              cocos2d__Director__getInstance____text:0000000100017C9C                 LDR             X0, [X0,#0xB0]__text:0000000100017CA0                 MOV             W2, #0__text:0000000100017CA4                 MOV             X1, X19__text:0000000100017CA8                 BL              sub_1003BB150__text:0000000100017CAC                 BL              getUserDefault__text:0000000100017CB0                 LDR             X8, [X0]__text:0000000100017CB4                 LDR             X8, [X8,#8]__text:0000000100017CB8                 ADRP            X1, #aTotalCompleteC@PAGE ; &quot;total_complete_chapter&quot;__text:0000000100017CBC                 ADD             X1, X1, #aTotalCompleteC@PAGEOFF ; &quot;total_complete_chapter&quot;__text:0000000100017CC0                 MOV             W2, #0__text:0000000100017CC4                 BLR             X8__text:0000000100017CC8                 STR             W0, [X19,#0x5B8]__text:0000000100017CCC                 LDR             W8, [X19,#0x5BC]__text:0000000100017CD0                 ADD             W8, W8, #1__text:0000000100017CD4                 STR             W8, [X19,#0x5BC]</code></pre><p>将那个位置patch为nop以后，发现游戏直接通过了，进入下一关又直接通关，回到主菜单发现后面的游戏关卡也都解锁了。有点暴力，游戏不玩就直接通关了，没啥游戏体验，但终究能够解锁后面的关卡和通关，所以也能接受了。</p><p>关于在调试中patch的代码在我写的lldb调试工具中的<code>patcher</code>命令</p><p><a href="https://github.com/4ch12dy/xia0LLDB">https://github.com/4ch12dy/xia0LLDB</a></p><h4><a href="#zong-jie" class="header-anchor">#</a><span id="zong-jie">总结</span></h4><p>这个游戏算是比较完整的分析完了，在这过程之中，学习到了很多，也发现了与一般app逆向的区别。由于是C++代码，使得逆向分析十分困难，只能用一些分析技巧才能找到关键代码。cocos2d-x引擎游戏算是游戏逆向分析里面比较麻烦的一类了，在腾讯那本游戏安全里面针对这种游戏也没有很好地逆向方法，只提及了字符串搜索，更多可能是猜的过程。但就我分析的思路来看，还是有规律和经验可循的。</p><h4><a href="#todo" class="header-anchor">#</a><span id="todo">Todo</span></h4><p>后面可能会做一个对于C++虚函数表恢复的插件以及编写这个游戏的外挂代码</p><h4><a href="#can-kao" class="header-anchor">#</a><span id="can-kao">参考</span></h4><ul><li><p><a href="https://www.cnblogs.com/Antiver/p/10173474.html" target="_blank" rel="external">https://www.cnblogs.com/Antiver/p/10173474.html</a></p></li><li><p><a href="https://github.com/4ch12dy/xia0LLDB">https://github.com/4ch12dy/xia0LLDB</a></p></li><li><a href="https://www.cnblogs.com/luorende/p/5988947.html" target="_blank" rel="external">https://www.cnblogs.com/luorende/p/5988947.html</a></li><li><a href="https://www.cnblogs.com/Antiver/p/10173474.html" target="_blank" rel="external">https://www.cnblogs.com/Antiver/p/10173474.html</a></li><li><a href="https://github.com/0xgalz/Virtuailor">https://github.com/0xgalz/Virtuailor</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3&gt;&lt;a href=&quot;#cocos2d-x-you-xi-ni-xiang-fen-xi-shi-jian&quot; class=&quot;header-anchor&quot;&gt;#&lt;/a&gt;&lt;span id=&quot;cocos2d-x-you-xi-ni-xiang-fen-xi-shi-jian&quot;&gt;coc
      
    
    </summary>
    
      <category term="RE" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/categories/RE/"/>
    
    
      <category term="RE" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/RE/"/>
    
      <category term="cocos2d" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/cocos2d/"/>
    
  </entry>
  
  <entry>
    <title>cocos2d-x引擎学习笔记</title>
    <link href="https://github.com/4ch12dy/4ch12dy.github.io.git/2019/10/14/cocos2d-x-dev-note/cocos2d-x-dev-note/"/>
    <id>https://github.com/4ch12dy/4ch12dy.github.io.git/2019/10/14/cocos2d-x-dev-note/cocos2d-x-dev-note/</id>
    <published>2019-10-14T09:10:09.000Z</published>
    <updated>2020-04-24T07:07:43.947Z</updated>
    
    <content type="html"><![CDATA[<script src="//cdn.bootcss.com/jquery/1.11.3/jquery.min.js"></script><div id="hbe-security">  <div class="hbe-input-container">  <input type="password" class="hbe-form-control" id="pass" placeholder="give me the secret code ;)">    <label for="pass">give me the secret code ;)</label>    <div class="bottom-line"></div>  </div></div><div id="decryptionError" style="display: none;">Incorrect Password!</div><div id="noContentError" style="display: none;">No content to display!</div><div id="encrypt-blog" style="display:none">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</div><script src="/lib/crypto-js.js"></script><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      something you can not kown 
    
    </summary>
    
      <category term="dev" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/categories/dev/"/>
    
    
      <category term="cocos2d-x" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/cocos2d-x/"/>
    
  </entry>
  
  <entry>
    <title>arm64中C++的逆向分析基础</title>
    <link href="https://github.com/4ch12dy/4ch12dy.github.io.git/2019/10/14/cpp-in-iOS-arm64/cpp-in-iOS-arm64/"/>
    <id>https://github.com/4ch12dy/4ch12dy.github.io.git/2019/10/14/cpp-in-iOS-arm64/cpp-in-iOS-arm64/</id>
    <published>2019-10-14T07:33:19.000Z</published>
    <updated>2020-04-24T07:06:26.246Z</updated>
    
    <content type="html"><![CDATA[<script src="//cdn.bootcss.com/jquery/1.11.3/jquery.min.js"></script><div id="hbe-security">  <div class="hbe-input-container">  <input type="password" class="hbe-form-control" id="pass" placeholder="give me the secret code ;)">    <label for="pass">give me the secret code ;)</label>    <div class="bottom-line"></div>  </div></div><div id="decryptionError" style="display: none;">Incorrect Password!</div><div id="noContentError" style="display: none;">No content to display!</div><div id="encrypt-blog" style="display:none">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</div><script src="/lib/crypto-js.js"></script><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      something you can not kown 
    
    </summary>
    
      <category term="RE" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/categories/RE/"/>
    
    
      <category term="RE" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/RE/"/>
    
      <category term="C++" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/C/"/>
    
      <category term="arm64" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/arm64/"/>
    
  </entry>
  
  <entry>
    <title>又又又又一个脱壳工具来了</title>
    <link href="https://github.com/4ch12dy/4ch12dy.github.io.git/2019/09/23/lldb-dumpdecrypted/lldb-dumpdecrypted/"/>
    <id>https://github.com/4ch12dy/4ch12dy.github.io.git/2019/09/23/lldb-dumpdecrypted/lldb-dumpdecrypted/</id>
    <published>2019-09-22T17:12:12.000Z</published>
    <updated>2019-09-22T17:36:43.000Z</updated>
    
    <content type="html"><![CDATA[<h3><a href="#you-you-you-you-yi-ge-tuo-ke-gong-ju-lai-liao" class="header-anchor">#</a><span id="you-you-you-you-yi-ge-tuo-ke-gong-ju-lai-liao">又又又又一个脱壳工具来了</span></h3><p>是的，又又又又一个脱壳工具来了：LLDB调试器版本的脱壳工具</p><h4><a href="#chang-jing" class="header-anchor">#</a><span id="chang-jing">场景</span></h4><p>我能想到的场景就是最近分析一个app的时候会在<code>mod_init_func</code>的时候crash，这样导致现有的脱壳工具无法正常脱壳，或者之前Frida没兼容iOS12以及其他特殊场景。所以就做了LLDB中的脱壳工具。</p><h4><a href="#shi-yong" class="header-anchor">#</a><span id="shi-yong">使用</span></h4><p>由于在LLDB中脱壳的特殊性，所以这样我介绍下如何去使用这个脱壳工具</p><blockquote><p>以下命令已集成到<a href="https://github.com/4ch12dy/xia0LLDB">xia0LLDB</a>或<a href="https://github.com/4ch12dy/issh">issh</a></p></blockquote><h5><a href="#yi-hou-tai-mo-shi-qi-dong-mu-biao-app" class="header-anchor">#</a><span id="yi-hou-tai-mo-shi-qi-dong-mu-biao-app">以后台模式启动目标app</span></h5><pre><code>xia0 ~ $ issh debug -x backboard /var/containers/Bundle/Application/86E712C8-84CA-49AF-B2EA-01C37395A746/WeChat.app/WeChat[*]:iproxy process for 2222 port alive, pid=1830[*]:++++++++++++++++++ Nice to Work :) +++++++++++++++++++++[*]:iOSRE dir exist[*]:iproxy process for 1234 port alive, pid=14885[*]:Run ps -e | grep debugserver | grep -v grep; [[ 0 == 0 ]] &amp;&amp; (killall -9 debugserver 2&gt; /dev/null)[*]:/iOSRE/tools/debugserver file exist, Start debug...[*]:Run /iOSRE/tools/debugserver 127.0.0.1:1234 -x backboard /var/containers/Bundle/Application/86E712C8-84CA-49AF-B2EA-01C37395A746/WeChat.app/WeChat</code></pre><h5><a href="#lian-jie-dao-yuan-duan-debugserver" class="header-anchor">#</a><span id="lian-jie-dao-yuan-duan-debugserver">连接到远端debugserver</span></h5><pre><code>(lldb) pccProcess 19633 stopped  thread #1, stop reason = signal SIGSTOP    frame #0: 0x00000001200f5000 dyld`_dyld_startdyld`_dyld_start:    0x1200f5000 &lt;+0&gt;:  mov    x28, sp    0x1200f5004 &lt;+4&gt;:  and    sp, x28, #0xfffffffffffffff0    0x1200f5008 &lt;+8&gt;:  mov    x0, #0x0    0x1200f500c &lt;+12&gt;: mov    x1, #0x0    0x1200f5010 &lt;+16&gt;: stp    x1, x0, [sp, #-0x10]!    0x1200f5014 &lt;+20&gt;: mov    x29, sp    0x1200f5018 &lt;+24&gt;: sub    sp, sp, #0x10             ; =0x10    0x1200f501c &lt;+28&gt;: ldr    x0, [x28]Target 0: (dyld) stopped.</code></pre><h5><a href="#yi-xie-duan-dian-she-zhi-qing-kuang" class="header-anchor">#</a><span id="yi-xie-duan-dian-she-zhi-qing-kuang">一些断点设置情况</span></h5><pre><code>(lldb) b getpidBreakpoint 1: no locations (pending).WARNING:  Unable to resolve breakpoint to any actual locations.(lldb) cProcess 19633 resuming1 location added to breakpoint 1Process 19633 stopped  thread #1, queue = &#39;com.apple.main-thread&#39;, stop reason = breakpoint 1.1    frame #0: 0x0000000181ceb570 libsystem_kernel.dylib getpidlibsystem_kernel.dylib getpid:    0x181ceb570 &lt;+0&gt;:  adrp   x9, 124120    0x181ceb574 &lt;+4&gt;:  add    x9, x9, #0x90             ; =0x90    0x181ceb578 &lt;+8&gt;:  ldr    w0, [x9]    0x181ceb57c &lt;+12&gt;: cmp    w0, #0x0                  ; =0x0    0x181ceb580 &lt;+16&gt;: b.ls   0x181ceb588               ; &lt;+24&gt;    0x181ceb584 &lt;+20&gt;: ret    0x181ceb588 &lt;+24&gt;: mov    x16, #0x14    0x181ceb58c &lt;+28&gt;: svc    #0x80Target 0: (WeChat) stopped.(lldb) xbr -E init[*] breakpoint at mod int first function:0x1034c7db8Breakpoint 2: where = WeChat ___lldb_unnamed_symbol143521$$WeChat, address = 0x00000001034c7db8(lldb) br disable 11 breakpoints disabled.(lldb) cProcess 19633 resuming</code></pre><p>这里解释一下为什么需要这么设置断点：<code>b getpid</code>这个断点主要是保证<code>xbr -E init</code>这个命令在断点触发的时候能够顺利执行，<code>xbr -E init</code>这个命令能够解析内存中的MachO格式找到<code>mod_init_func</code>然后对第一个init函数下断点，这样保证是目前app的最早执行时机，另外还能指定下断点到main函数<code>xbr -E main</code>，由于main函数在init之后，所以一般就对init下断点（有种情况在于app可能没有init函数，这时候就需要对main下断点，这里按实际情况处理）。<br>这样下好断点以后，禁用或者删除第一个断点（第一个断点调用很频繁且后面不再需要），这样让程序继续执行，等待断点触发。</p><h5><a href="#zhi-xing-dumpdecrypted-ming-ling-jin-xing-tuo-ke" class="header-anchor">#</a><span id="zhi-xing-dumpdecrypted-ming-ling-jin-xing-tuo-ke">执行dumpdecrypted命令进行脱壳</span></h5><pre><code>(lldb) dumpdecrypted[+] Dumping WeChat[+] detected 64bit ARM binary in memory.[+] offset to cryptid found: @0x100018d48(from 0x100018000) = d48[+] Found encrypted data at address 00004000 of length 101662720 bytes - type 1.[+] Opening /private/var/containers/Bundle/Application/86E712C8-84CA-49AF-B2EA-01C37395A746/WeChat.app/WeChat for reading.[+] Reading header[+] Detecting header type[+] Executable is a plain MACH-O image[+] Opening /var/mobile/Containers/Data/Application/9649276C-C413-4916-B5AB-AE13C8D7B652/Documents/WeChat.decrypted for writing.[+] Copying the not encrypted start of the file[+] Dumping the decrypted data into the file[+] Copying the not encrypted remainder of the file[+] Setting the LC_ENCRYPTION_INFO-&gt;cryptid to 0 at offset d48[+] Closing original file[+] Closing dump file[*] This mach-o file decrypted done.Developed By xia0@2019</code></pre><p>如果一切顺利，就能顺利完成脱壳，这里目标文件在 <code>/var/mobile/Containers/Data/Application/9649276C-C413-4916-B5AB-AE13C8D7B652/Documents/WeChat.decrypted</code></p><h5><a href="#qu-hui-tuo-ke-hou-de-wen-jian-dao-ben-di-zhe-li-yong-dao-liao-issh-yi-tiao-ming-ling-qu-hui" class="header-anchor">#</a><span id="qu-hui-tuo-ke-hou-de-wen-jian-dao-ben-di-zhe-li-yong-dao-liao-issh-yi-tiao-ming-ling-qu-hui">取回脱壳后的文件到本地，这里用到了issh一条命令取回</span></h5><pre><code>xia0 ~ $ issh scp /var/mobile/Containers/Data/Application/9649276C-C413-4916-B5AB-AE13C8D7B652/Documents/WeChat.decrypted /tmp[*]:iproxy process for 2222 port alive, pid=1830[*]:++++++++++++++++++ Nice to Work :) +++++++++++++++++++++[*]:/var/mobile/Containers/Data/Application/9649276C-C413-4916-B5AB-AE13C8D7B652/Documents/WeChat.decrypted is remote file, so cp it from deviceWeChat.decrypted                                                                                             100%  122MB  11.7MB/s   00:10</code></pre><h4><a href="#qi-ta-zhu-yi-shi-xiang" class="header-anchor">#</a><span id="qi-ta-zhu-yi-shi-xiang">其他注意事项</span></h4><p>目标App文件过大，可能会出现加密段会有内存读取错误，解决办法就是手动在LLDB里面读取一下这个段内容，然后再执行就没问题了。</p><p>用到两个工具：</p><ul><li><a href="https://github.com/4ch12dy/issh">https://github.com/4ch12dy/issh</a></li><li><a href="https://github.com/4ch12dy/xia0LLDB">https://github.com/4ch12dy/xia0LLDB</a></li></ul><h4><a href="#can-kao" class="header-anchor">#</a><span id="can-kao">参考</span></h4><ul><li><a href="https://github.com/stefanesser/dumpdecrypted">https://github.com/stefanesser/dumpdecrypted</a></li><li><a href="https://github.com/AloneMonkey/dumpdecrypted">https://github.com/AloneMonkey/dumpdecrypted</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3&gt;&lt;a href=&quot;#you-you-you-you-yi-ge-tuo-ke-gong-ju-lai-liao&quot; class=&quot;header-anchor&quot;&gt;#&lt;/a&gt;&lt;span id=&quot;you-you-you-you-yi-ge-tuo-ke-gong-ju-lai-l
      
    
    </summary>
    
      <category term="RE" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/categories/RE/"/>
    
    
      <category term="RE" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/RE/"/>
    
      <category term="lldb" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/lldb/"/>
    
  </entry>
  
  <entry>
    <title>深入理解iOS动态链接</title>
    <link href="https://github.com/4ch12dy/4ch12dy.github.io.git/2019/09/14/iOS-dyld-dynamic-link/iOS-dyld-dynamic-link/"/>
    <id>https://github.com/4ch12dy/4ch12dy.github.io.git/2019/09/14/iOS-dyld-dynamic-link/iOS-dyld-dynamic-link/</id>
    <published>2019-09-14T00:12:55.000Z</published>
    <updated>2019-10-17T11:58:34.880Z</updated>
    
    <content type="html"><![CDATA[<h3><a href="#shen-ru-li-jie-ios-dong-tai-lian-jie" class="header-anchor">#</a><span id="shen-ru-li-jie-ios-dong-tai-lian-jie">深入理解iOS动态链接</span></h3><blockquote><p>本文将通过objc_msgsend来介绍iOS平台上面的动态链接</p></blockquote><h4><a href="#kai-shi" class="header-anchor">#</a><span id="kai-shi">开始</span></h4><p>动态链接有很多好处这里就不再叙述，本文主要分析动态链接一些平时忽略的细节。在2年前写过<a href="http://4ch12dy.site/2017/04/10/macho-dyld-link/macho-dyld-link/" target="_blank" rel="external">macho动态链接</a>文章去分析过动态链接相关，但是之前分析得平台是x64的mac平台，而且分析得并不是很详细。由于需要对这块知识有一个比较深刻的理解，分析了在iOS平台动态链接的一些细节。本文就是我在分析过程中的一些心得和理解，希望能够有所帮组。</p><h4><a href="#wai-bu-fu-hao-diao-yong-guo-cheng" class="header-anchor">#</a><span id="wai-bu-fu-hao-diao-yong-guo-cheng">外部符号调用过程</span></h4><p>这里以<code>objc_msgsend</code>这个常见的符号为例，首先我们在ida中找到该符号的桩代码</p><pre><code class="assembly">__stubs:000000010000A2E8 ; void *objc_msgSend(void *, const char *, ...)__stubs:000000010000A2E8 _objc_msgSend  __stubs:000000010000A2E8                                       __stubs:000000010000A2E8                 NOP__stubs:000000010000A2EC                 LDR             X16, =__imp__objc_msgSend__stubs:000000010000A2F0                 BR              X16     ; __imp__objc_msgSend</code></pre><p>可以看出仅仅是一个跳转，由于ida这里识别出来为一个外部符号，所以生成了一个imp段，实际上跳转的地址并不是<code>__imp__objc_msgSend</code>，所以我们在调试器中跟一下</p><pre><code>Process 6478 stopped* thread #1, queue = &#39;com.apple.main-thread&#39;, stop reason = instruction step into    frame #0: 0x000000010000a3e4 TestAPP-&gt;  0x10000a3e4: ldr    w16, 0x10000a3ec    0x10000a3e8: b      0x10000a384    0x10000a3ec: .long  0x00000246                ; unknown opcode    0x10000a3f0: ldr    w16, 0x10000a3f8    0x10000a3f4: b      0x10000a384    0x10000a3f8: .long  0x0000025b                ; unknown opcode    0x10000a3fc: ldr    w16, 0x10000a404    0x10000a400: b      0x10000a384</code></pre><p>发现跳转到了<code>0x10000a3e4</code>地址，在ida中查看该地址发现在<code>stub_helper</code>这个区</p><pre><code class="assembly">__stub_helper:000000010000A3E4                 LDR             W16, =0x246__stub_helper:000000010000A3E8                 B               loc_10000A384__stub_helper:000000010000A3EC dword_10000A3EC DCD 0x246</code></pre><p>下面就会跳转到<code>loc_10000A384</code>其实所有的外部符号第一次调用的时候都会跳到这里进行符号绑定，还需要说明的一点在于，这里会将一个数加载到<code>w16</code>这个寄存器之中。这个数事实上和后面的符号绑定相关</p><pre><code class="assembly">__stub_helper:000000010000A384 ; Segment type: Pure code__stub_helper:000000010000A384                 AREA __stub_helper, CODE, READWRITE__stub_helper:000000010000A384                 ; ORG 0x10000A384__stub_helper:000000010000A384                 CODE64__stub_helper:000000010000A384                 ADR             X17, off_10000C030__stub_helper:000000010000A388                 NOP__stub_helper:000000010000A38C                 STP             X16, X17, [SP,#-0x10]!__stub_helper:000000010000A390                 NOP__stub_helper:000000010000A394                 LDR             X16, =dyld_stub_binder__stub_helper:000000010000A398                 BR              X16     ; dyld_stub_binder</code></pre><p>随后就会调用<code>dyld_stub_binder</code>函数进行符号绑定，这也是一个外部符号。当然你可能会说这样的话不就死循环了吗？其实不是，这个符号并不是lazy的即在初始化过程中就确定了地址。这里<code>dyld_stub_binder</code>的代码如下</p><pre><code class="assembly">libdyld.dylib`dyld_stub_binder:-&gt;  0x181bccb64 &lt;+0&gt;:   stp    x29, x30, [sp, #-0x10]!    0x181bccb68 &lt;+4&gt;:   mov    x29, sp    0x181bccb6c &lt;+8&gt;:   sub    sp, sp, #0xf0             ; =0xf0    0x181bccb70 &lt;+12&gt;:  stp    x0, x1, [x29, #-0x10]    0x181bccb74 &lt;+16&gt;:  stp    x2, x3, [x29, #-0x20]    0x181bccb78 &lt;+20&gt;:  stp    x4, x5, [x29, #-0x30]    0x181bccb7c &lt;+24&gt;:  stp    x6, x7, [x29, #-0x40]    0x181bccb80 &lt;+28&gt;:  stp    x8, x9, [x29, #-0x50]    0x181bccb84 &lt;+32&gt;:  stp    q0, q1, [x29, #-0x80]    0x181bccb88 &lt;+36&gt;:  stp    q2, q3, [x29, #-0xa0]    0x181bccb8c &lt;+40&gt;:  stp    q4, q5, [x29, #-0xc0]    0x181bccb90 &lt;+44&gt;:  stp    q6, q7, [x29, #-0xe0]    0x181bccb94 &lt;+48&gt;:  ldr    x0, [x29, #0x18]    0x181bccb98 &lt;+52&gt;:  ldr    x1, [x29, #0x10]    0x181bccb9c &lt;+56&gt;:  bl     0x181bcd8b8        ; _dyld_fast_stub_entry(void*, long)    0x181bccba0 &lt;+60&gt;:  mov    x16, x0    0x181bccba4 &lt;+64&gt;:  ldp    x0, x1, [x29, #-0x10]    0x181bccba8 &lt;+68&gt;:  ldp    x2, x3, [x29, #-0x20]    0x181bccbac &lt;+72&gt;:  ldp    x4, x5, [x29, #-0x30]    0x181bccbb0 &lt;+76&gt;:  ldp    x6, x7, [x29, #-0x40]    0x181bccbb4 &lt;+80&gt;:  ldp    x8, x9, [x29, #-0x50]    0x181bccbb8 &lt;+84&gt;:  ldp    q0, q1, [x29, #-0x80]    0x181bccbbc &lt;+88&gt;:  ldp    q2, q3, [x29, #-0xa0]    0x181bccbc0 &lt;+92&gt;:  ldp    q4, q5, [x29, #-0xc0]    0x181bccbc4 &lt;+96&gt;:  ldp    q6, q7, [x29, #-0xe0]    0x181bccbc8 &lt;+100&gt;: mov    sp, x29    0x181bccbcc &lt;+104&gt;: ldp    x29, x30, [sp], #0x10    0x181bccbd0 &lt;+108&gt;: add    sp, sp, #0x10             ; =0x10    0x181bccbd4 &lt;+112&gt;: br     x16</code></pre><p>然后调用了<code>_dyld_fast_stub_entry</code>函数，由于<code>dyld</code>本身开源的，这里下载源码去看下这个函数的实现</p><pre><code class="c++">uintptr_t fastBindLazySymbol(ImageLoader** imageLoaderCache, uintptr_t lazyBindingInfoOffset){    uintptr_t result = 0;    // get image     if ( *imageLoaderCache == NULL ) {        // save in cache        *imageLoaderCache = dyld::findMappedRange((uintptr_t)imageLoaderCache);        if ( *imageLoaderCache == NULL ) {            const char* message = &quot;fast lazy binding from unknown image&quot;;            dyld::log(&quot;dyld: %s\n&quot;, message);            halt(message);        }    }    // bind lazy pointer and return it    try {        result = (*imageLoaderCache)-&gt;doBindFastLazySymbol((uint32_t)lazyBindingInfoOffset, gLinkContext,                                 (dyld::gLibSystemHelpers != NULL) ? dyld::gLibSystemHelpers-&gt;acquireGlobalDyldLock : NULL,                                (dyld::gLibSystemHelpers != NULL) ? dyld::gLibSystemHelpers-&gt;releaseGlobalDyldLock : NULL);    }    catch (const char* message) {        dyld::log(&quot;dyld: lazy symbol binding failed: %s\n&quot;, message);        halt(message);    }    // return target address to glue which jumps to it with real parameters restored    return result;}</code></pre><p>然后这里调用了<code>ImageLoaderMachOCompressed::doBindFastLazySymbol</code>去完成符号绑定</p><pre><code class="c++">uintptr_t ImageLoaderMachOCompressed::doBindFastLazySymbol(uint32_t lazyBindingInfoOffset, const LinkContext&amp; context,                                                            void (*lock)(), void (*unlock)()){    // &lt;rdar://problem/8663923&gt; race condition with flat-namespace lazy binding    if ( this-&gt;usesTwoLevelNameSpace() ) {        // two-level namespace lookup does not require lock because dependents can&#39;t be unloaded before this image    }    else {        // acquire dyld global lock        if ( lock != NULL )            lock();    }    const uint8_t* const start = fLinkEditBase + fDyldInfo-&gt;lazy_bind_off;    const uint8_t* const end = &amp;start[fDyldInfo-&gt;lazy_bind_size];    if ( lazyBindingInfoOffset &gt; fDyldInfo-&gt;lazy_bind_size ) {        dyld::throwf(&quot;fast lazy bind offset out of range (%u, max=%u) in image %s&quot;,             lazyBindingInfoOffset, fDyldInfo-&gt;lazy_bind_size, this-&gt;getPath());    }    uint8_t type = BIND_TYPE_POINTER;    uintptr_t address = 0;    const char* symbolName = NULL;    uint8_t symboFlags = 0;    long libraryOrdinal = 0;    bool done = false;    uintptr_t result = 0;    const uint8_t* p = &amp;start[lazyBindingInfoOffset];    while ( !done &amp;&amp; (p &lt; end) ) {        uint8_t immediate = *p &amp; BIND_IMMEDIATE_MASK;        uint8_t opcode = *p &amp; BIND_OPCODE_MASK;        ++p;        switch (opcode) {            case BIND_OPCODE_DONE:                done = true;                break;            case BIND_OPCODE_SET_DYLIB_ORDINAL_IMM:                libraryOrdinal = immediate;                break;            case BIND_OPCODE_SET_DYLIB_ORDINAL_ULEB:                libraryOrdinal = read_uleb128(p, end);                break;            case BIND_OPCODE_SET_DYLIB_SPECIAL_IMM:                // the special ordinals are negative numbers                if ( immediate == 0 )                    libraryOrdinal = 0;                else {                    int8_t signExtended = BIND_OPCODE_MASK | immediate;                    libraryOrdinal = signExtended;                }                break;            case BIND_OPCODE_SET_SYMBOL_TRAILING_FLAGS_IMM:                symbolName = (char*)p;                symboFlags = immediate;                while (*p != &#39;\0&#39;)                    ++p;                ++p;                break;            case BIND_OPCODE_SET_TYPE_IMM:                type = immediate;                break;            case BIND_OPCODE_SET_SEGMENT_AND_OFFSET_ULEB:                if ( immediate &gt;= fSegmentsCount )                    dyld::throwf(&quot;BIND_OPCODE_SET_SEGMENT_AND_OFFSET_ULEB has segment %d which is too large (0..%d)&quot;,                             immediate, fSegmentsCount-1);                address = segActualLoadAddress(immediate) + read_uleb128(p, end);                break;            case BIND_OPCODE_DO_BIND:                result = this-&gt;bindAt(context, address, type, symbolName, 0, 0, libraryOrdinal, &quot;lazy &quot;, NULL, true);                break;            case BIND_OPCODE_SET_ADDEND_SLEB:            case BIND_OPCODE_ADD_ADDR_ULEB:            case BIND_OPCODE_DO_BIND_ADD_ADDR_ULEB:            case BIND_OPCODE_DO_BIND_ADD_ADDR_IMM_SCALED:            case BIND_OPCODE_DO_BIND_ULEB_TIMES_SKIPPING_ULEB:            default:                dyld::throwf(&quot;bad lazy bind opcode %d&quot;, *p);        }    }        if ( !this-&gt;usesTwoLevelNameSpace() ) {        // release dyld global lock        if ( unlock != NULL )            unlock();    }    return result;}</code></pre><p>这里面有个十分熟悉但之前都没去深入研究的一个东西，即<code>__LINKEDIT</code>段。这里可以看出用用到这个段里面的一个数据去完成符号绑定。之前仅仅是知道这个段用作符号绑定，现在终于知道了原来就是这里用到了这个段的信息。这里先不去解释其中的<code>opcode</code>含义，关于这块的知识可以看这里<a href="http://www.newosxbook.com/articles/DYLD.html#footnote" target="_blank" rel="external">DYLD Detailed</a>。调试看下下一次调用时候，会不会直接返回绑定后的地址</p><pre><code>TestAPP`objc_msgSend:-&gt;  0x10000a2e8 &lt;+0&gt;: nop    0x10000a2ec &lt;+4&gt;: ldr    x16, #0x1e1c       ; (void *)0x00000001817c9b80: objc_msgSend    0x10000a2f0 &lt;+8&gt;: br     x16</code></pre><p>从这里就能看出已经找到了<code>objc_msgSend</code>符号的地址</p><pre><code>(lldb) p/x 0x10000a2ec+0x1e1c(long) $9 = 0x000000010000c108(lldb) x/g 0x000000010000c1080x10000c108: 0x00000001817c9b80</code></pre><p>那么这里的<code>0x000000010000c108</code>地址在macho文件在是什么地址呢？这里其实是一个指针，保存了外部符号的地址。这个地址在<code>__DATA,__la_symbol_ptr</code>这个区之中。初始值是<code>__TEXT,__stub_helper</code>中的某个地址。</p><h4><a href="#wai-bu-fu-hao-diao-yong-zong-jie" class="header-anchor">#</a><span id="wai-bu-fu-hao-diao-yong-zong-jie">外部符号调用总结</span></h4><p>上面的过程有一点绕，这里从宏哥来解释下整个过程</p><ul><li><p>程序调用一个外部符号（<code>objc_msgsend</code>）这里就是<code>-[AppDelegate class]</code>方法</p><pre><code class="assembly">__text:0000000100008C34                 LDR             X30, [X30] ; _OBJC_CLASS_$_AppDelegate__text:0000000100008C38                 LDR             X1, [X1] ; &quot;class&quot;__text:0000000100008C3C                 STR             X0, [SP,#0x30+var_18]__text:0000000100008C40                 MOV             X0, X30 ; void *__text:0000000100008C44                 STR             W8, [SP,#0x30+var_1C]__text:0000000100008C48                 STR             X9, [SP,#0x30+var_28]__text:0000000100008C4C                 BL              _objc_msgSend</code></pre></li><li><p>然后跳转到<code>__TEXT, __stubs</code>这个区</p><pre><code class="assembly">__stubs:000000010000A2E8 _objc_msgSend  __stubs:000000010000A2E8                                       __stubs:000000010000A2E8                 NOP__stubs:000000010000A2EC                 LDR          X16, =__imp__objc_msgSend__stubs:000000010000A2F0                 BR           X16</code></pre></li><li><p>这里x16寄存器的默认值就是<code>objc_msgSend</code>在<code>__TEXT,__stub_helper</code>中对应的地址</p><pre><code class="assembly">__stub_helper:000000010000A3E4                 LDR             W16, =0x246__stub_helper:000000010000A3E8                 B               loc_10000A384__stub_helper:000000010000A3EC dword_10000A3EC DCD 0x246</code></pre></li><li><p>接着就是去调用<code>dyld_stub_binder</code>函数进行符号绑定，第一次找到该符号地址以后直接返回给调用处，并且将<code>__DATA,__la_symbol_ptr</code>中<code>objc_msgSend</code>的指针值更改为找到的符号地址。这样下一次就不会跳转到<code>__TEXT,__stub_helper</code>里面，而是直接跳转到正确的函数地址。</p><pre><code class="assembly">__stub_helper:000000010000A384 ; Segment type: Pure code__stub_helper:000000010000A384                 AREA __stub_helper, CODE, READWRITE__stub_helper:000000010000A384                 ; ORG 0x10000A384__stub_helper:000000010000A384                 CODE64__stub_helper:000000010000A384                 ADR             X17, off_10000C030__stub_helper:000000010000A388                 NOP__stub_helper:000000010000A38C                 STP             X16, X17, [SP,#-0x10]!__stub_helper:000000010000A390                 NOP__stub_helper:000000010000A394                 LDR             X16, =dyld_stub_binder__stub_helper:000000010000A398                 BR              X16     ; dyld_stub_binder</code></pre></li><li><p>最后一个函数符号的地址绑定就完成了</p></li></ul><h4><a href="#can-kao" class="header-anchor">#</a><span id="can-kao">参考</span></h4><ul><li><a href="http://www.newosxbook.com/articles/DYLD.html#footnote" target="_blank" rel="external">http://www.newosxbook.com/articles/DYLD.html#footnote</a></li><li><a href="https://github.com/opensource-apple/dyld">https://github.com/opensource-apple/dyld</a></li><li><a href="https://github.com/gdbinit/MachOView">https://github.com/gdbinit/MachOView</a></li><li><a href="https://blog.gocy.tech/2018/08/01/behindthescenes-symbol-resolve/" target="_blank" rel="external">https://blog.gocy.tech/2018/08/01/behindthescenes-symbol-resolve/</a></li><li><a href="https://blog.gocy.tech/2019/07/08/hook-msgSend-advance/" target="_blank" rel="external">https://blog.gocy.tech/2019/07/08/hook-msgSend-advance/</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3&gt;&lt;a href=&quot;#shen-ru-li-jie-ios-dong-tai-lian-jie&quot; class=&quot;header-anchor&quot;&gt;#&lt;/a&gt;&lt;span id=&quot;shen-ru-li-jie-ios-dong-tai-lian-jie&quot;&gt;深入理解iOS动态链接&lt;/
      
    
    </summary>
    
      <category term="wiki" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/categories/wiki/"/>
    
    
      <category term="iOS" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/iOS/"/>
    
      <category term="wiki" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/wiki/"/>
    
  </entry>
  
  <entry>
    <title>iOS微信快速备注好友插件分析与实现</title>
    <link href="https://github.com/4ch12dy/4ch12dy.github.io.git/2019/09/11/appre-wechat-rename/appre-wechat-rename/"/>
    <id>https://github.com/4ch12dy/4ch12dy.github.io.git/2019/09/11/appre-wechat-rename/appre-wechat-rename/</id>
    <published>2019-09-11T09:31:37.000Z</published>
    <updated>2020-04-24T07:06:26.372Z</updated>
    
    <content type="html"><![CDATA[<script src="//cdn.bootcss.com/jquery/1.11.3/jquery.min.js"></script><div id="hbe-security">  <div class="hbe-input-container">  <input type="password" class="hbe-form-control" id="pass" placeholder="give me the secret code ;)">    <label for="pass">give me the secret code ;)</label>    <div class="bottom-line"></div>  </div></div><div id="decryptionError" style="display: none;">Incorrect Password!</div><div id="noContentError" style="display: none;">No content to display!</div><div id="encrypt-blog" style="display:none">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</div><script src="/lib/crypto-js.js"></script><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      something you can not kown 
    
    </summary>
    
      <category term="RE" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/categories/RE/"/>
    
    
      <category term="RE" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/RE/"/>
    
      <category term="tweak" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/tweak/"/>
    
  </entry>
  
  <entry>
    <title>iOS inlinehook绕过反调试</title>
    <link href="https://github.com/4ch12dy/4ch12dy.github.io.git/2019/09/10/anti-anti-debug-pro/anti-anti-debug-pro/"/>
    <id>https://github.com/4ch12dy/4ch12dy.github.io.git/2019/09/10/anti-anti-debug-pro/anti-anti-debug-pro/</id>
    <published>2019-09-10T08:02:54.000Z</published>
    <updated>2019-09-10T09:14:15.000Z</updated>
    
    <content type="html"><![CDATA[<h2><a href="#ios-inlinehook-rao-guo-fan-diao-shi" class="header-anchor">#</a><span id="ios-inlinehook-rao-guo-fan-diao-shi">iOS inlinehook绕过反调试</span></h2><h3><a href="#kai-shi" class="header-anchor">#</a><span id="kai-shi">开始</span></h3><p>之前写过一篇<a href="http://4ch12dy.site/2019/08/12/xia0lldb-anti-anti-debug/xia0lldb-anti-anti-debug/" target="_blank" rel="external">iOS LLDB中基于内存单指令patch实现反反调试</a>介绍了在LLDB中如何通过单指令patch的方式去绕过<code>ptrace</code>来反调试。但后面还有一些情况没有解决：如果不是调用<code>ptrace</code>函数，而是直接编写内联汇编的方式，调用对应的系统调用来间接实现反调试，那么这种方式之前的那种办法就不再可行。本文就准备解决那种用内联汇编的反调试方式。</p><h3><a href="#liang-chong-rao-guo-fang-an" class="header-anchor">#</a><span id="liang-chong-rao-guo-fang-an">两种绕过方案</span></h3><p>这里有两种方案去绕过这种反调试：</p><ul><li>静态内存匹配特征patch</li><li>实现一个简单的inlinehook动态hook绕过</li></ul><h3><a href="#jing-tai-nei-cun-pi-pei-te-zheng-patch" class="header-anchor">#</a><span id="jing-tai-nei-cun-pi-pei-te-zheng-patch">静态内存匹配特征patch</span></h3><p>在介绍思路之前，先看下一遍内联汇编去实现反调试的代码</p><pre><code class="assembly">    asm volatile(                 &quot;mov x0,#31\n&quot;                 &quot;mov x1,#0\n&quot;                 &quot;mov x2,#0\n&quot;                 &quot;mov x3,#0\n&quot;                 &quot;mov x16,#26\n&quot;                 &quot;svc #128\n&quot;                 );</code></pre><p>这里可以看出原理就是调用了26号系统调用，那么我们是不是可以去代码段里面去搜索，找到满足该特征的代码位置，然后直接将<code>svc</code>置为 <code>nop</code>不就可以了？下面引出两个问题，如何去遍历代码段以及如何去修改？</p><h4><a href="#huo-qu-dai-ma-duan-wei-zhi-yi-ji-da-xiao" class="header-anchor">#</a><span id="huo-qu-dai-ma-duan-wei-zhi-yi-ji-da-xiao">获取代码段位置以及大小</span></h4><pre><code class="c">void getTextSegmentAddr(struct segmentRange *textSegRange){    int offset = 0;    struct mach_header_64* header = (struct mach_header_64*)_dyld_get_image_header(0);    if(header-&gt;magic != MH_MAGIC_64) {        return ;    }    offset = sizeof(struct mach_header_64);    int ncmds = header-&gt;ncmds;    while(ncmds--) {        /* go through all load command to find __TEXT segment*/        struct load_command * lcp = (struct load_command *)((uint8_t*)header + offset);        offset += lcp-&gt;cmdsize;        if(lcp-&gt;cmd == LC_SEGMENT_64) {            struct segment_command_64 * curSegment = (struct segment_command_64 *)lcp;            struct section_64* curSection = (struct section_64*)((uint8_t*)curSegment + sizeof(struct segment_command_64));            // check current section of segment is __TEXT?            if(!strcmp(curSection-&gt;segname, &quot;__TEXT&quot;) &amp;&amp; !strcmp(curSection-&gt;sectname, &quot;__text&quot;)){                uint64_t memAddr = curSection-&gt;addr;                textSegRange-&gt;start = memAddr + _dyld_get_image_vmaddr_slide(0);                textSegRange-&gt;end = textSegRange-&gt;start + curSection-&gt;size;                break;            }        }    }    return ;}</code></pre><p>代码不复杂，就是动态解析了自身内存里面的macho文件，根据macho文件格式找到代码段<code>LC_SEGMENT_64(_TEXT)</code>然后就能得到<code>__text</code>的开始位置以及大小。</p><h4><a href="#nei-cun-sou-suo-pi-pei-ptrace-nei-lian-hui-bian-dai-ma" class="header-anchor">#</a><span id="nei-cun-sou-suo-pi-pei-ptrace-nei-lian-hui-bian-dai-ma">内存搜索匹配ptrace内联汇编代码</span></h4><pre><code class="c">void* lookup_ptrace_svc(void* target_addr, uint64_t size){    uint8_t * p = (uint8_t*)target_addr;    for(int i = 0; i &lt; size ;i++ ){        /*         mov       x16, #0x1a -&gt; 0xd2800350         svc        #0x80 -&gt; 0xd4001001         */        if (*((uint32_t*)p) == 0xd2800350 &amp;&amp; *((uint32_t*)p+1) == 0xd4001001) {            return p;        }        p++;    }    return NULL;}</code></pre><p>传入的就是代码段的地址以及大小，然后遍历整个代码段，找到满足以下ptrace特征汇编代码</p><pre><code class="assembly"> mov       x16, #0x1a -&gt; 0xd2800350 svc        #0x80 -&gt; 0xd4001001</code></pre><p>然后就返回该地址。</p><h4><a href="#patch-dai-ma-jiang-svc-gai-wei-nop" class="header-anchor">#</a><span id="patch-dai-ma-jiang-svc-gai-wei-nop">patch代码（将svc改为nop）</span></h4><p><a href="http://4ch12dy.site/2019/08/12/xia0lldb-anti-anti-debug/xia0lldb-anti-anti-debug/" target="_blank" rel="external">iOS LLDB中基于内存单指令patch实现反反调试</a>这篇文章介绍了如何去patch代码的原理，但当时遇到一个bug：在iOS11/12上面patch会失败，后面我花了一段时间去分析了失败的原因，后来也写了一篇文章去记录了分析的过程，感兴趣的可以访问<a href="http://4ch12dy.site/2019/08/16/iOS12-remap-bug-analyze/iOS12-remap-bug-analyze/" target="_blank" rel="external">iOS12内存patch remap bug分析</a></p><p>这里我就直接给出patch的代码</p><pre><code class="c">uint8_t patch_ins_data[4] = {0x1f, 0x20, 0x03, 0xd5}; // noppatchCode(ptrace_svc_p+4, patch_ins_data , 4);</code></pre><p>完整流程代码如下</p><pre><code class="c">- (void)kill_anti_debug{    struct segmentRange textSegRange;    getTextSegmentAddr(&amp;textSegRange);    void* ptrace_svc_p = lookup_ptrace_svc((void*)textSegRange.start, textSegRange.end-textSegRange.start);    if (!ptrace_svc_p) {        ADDLOG(@&quot;[-] not found ptrace svc&quot;);        return;    }    ADDXLOG(@&quot;[+] found ptrace svc # address=%p&quot;, ptrace_svc_p);    char* ptrace_bytes = hex_dump((void*)ptrace_svc_p, 8);    ADDXLOG(@&quot;[+] read ptrace svc ins address:%p size:0x%x inst_bytes:%s&quot;, ptrace_svc_p, 8, ptrace_bytes);    free(ptrace_bytes);    ADDLOG(@&quot;[*] start to ptach ptrace svc to ret&quot;);    uint8_t patch_ins_data[4] = {0x1f, 0x20, 0x03, 0xd5};    patchCode(ptrace_svc_p+4, patch_ins_data , 4);    ADDLOG(@&quot;[*] ptach ptrace svc to nop done, read new value&quot;);    ptrace_bytes = hex_dump((void*)ptrace_svc_p, 8);    ADDXLOG(@&quot;[+] read ptrace svc ins address:%p size:0x%x inst_bytes:%s&quot;, ptrace_svc_p, 8, ptrace_bytes);    free(ptrace_bytes);}</code></pre><p>通过比对前后的代码就发现<code>svc</code>出地址的代码已经变成了<code>nop</code>从而绕过了反调试</p><h3><a href="#inlinehook-dong-tai-hook-rao-guo" class="header-anchor">#</a><span id="inlinehook-dong-tai-hook-rao-guo">inlinehook动态hook绕过</span></h3><p>这种方式主要针对那些混淆了系统调用号或者其他编译版本，其绕过原理是直接hook svc指令，然后判断是否为26号系统调用（让其他系统调用正常执行），若满足就直接跳过svc指令。</p><p>整体流程代码如下</p><pre><code class="c">  struct segmentRange textSegRange;  getTextSegmentAddr(&amp;textSegRange);  void* svc_p = lookup_svc_ins((void*)textSegRange.start, textSegRange.end-textSegRange.start);  if (!svc_p) {      ADDLOG(@&quot;[-] not found svc&quot;);      return;  }  ADDXLOG(@&quot;[+] found svc # address=%p&quot;, svc_p);  char* svc_bytes = hex_dump((void*)svc_p, 4);  ADDXLOG(@&quot;[+] read ptrace svc ins address:%p size:0x%x inst_bytes:%s&quot;, svc_p, 4, svc_bytes);  free(svc_bytes);  xia0Hook(svc_p);</code></pre><p>同样遍历代码段找到所有的svc指令，然后进行hook，下面看hook的具体实现</p><pre><code class="c">bool xia0Hook(void* target_addr){     int len = (int)sysconf(_SC_PAGESIZE);    // 1. get target address page and patch offset    unsigned long page_start = (unsigned long) (target_addr) &amp; ~PAGE_MASK;    unsigned long patch_offset = (unsigned long)target_addr - page_start;    printf(&quot;[*] Target address:%p Page start:%p Patch offset:%p&quot;, target_addr, (void*)page_start, (void*)patch_offset);    // 2. map new page for patch    void *new = mmap(NULL, len, PROT_READ | PROT_WRITE, MAP_ANON | MAP_SHARED, -1, 0);    if (!new ){        printf(&quot;[-] mmap failed!&quot;);        return false;    }    // 3.copy target 4 ins to new page    int copy_size = 4*4;    void* copy_from_addr = target_addr - copy_size;    memcpy((void *)(new), copy_from_addr, copy_size);    /*     cmp x16, #0x1a     b.ne loc_not_ptrace_svc_jmp     ldr x17, #0x8     br x17     orig_svc_next_addr_1     orig_svc_next_addr_2     ldr x17, #0x8     br x17     orig_svc_addr_1     orig_svc_addr_2     */    uint64_t orig_svc_addr = (uint64_t)target_addr;    uint64_t orig_svc_next_addr = (uint64_t)(target_addr+1*4);    uint8_t check_jmp_data[] = {0x1f, 0x6a, 0x00, 0xf1, 0x51, 0x00, 0x00, 0x58, 0x20, 0x02, 0x1f, 0xd6, orig_svc_next_addr&amp;0xff, (orig_svc_next_addr&gt;&gt;8*1)&amp;0xff,  (orig_svc_next_addr&gt;&gt;8*2)&amp;0xff,  (orig_svc_next_addr&gt;&gt;8*3)&amp;0xff,  (orig_svc_next_addr&gt;&gt;8*4)&amp;0xff,  (orig_svc_next_addr&gt;&gt;8*5)&amp;0xff,  (orig_svc_next_addr&gt;&gt;8*6)&amp;0xff,  (orig_svc_next_addr&gt;&gt;8*7)&amp;0xff, 0x51, 0x00, 0x00, 0x58, 0x20, 0x02, 0x1f, 0xd6, orig_svc_addr&amp;0xff, (orig_svc_addr&gt;&gt;8*1)&amp;0xff,  (orig_svc_addr&gt;&gt;8*2)&amp;0xff,  (orig_svc_addr&gt;&gt;8*3)&amp;0xff,  (orig_svc_addr&gt;&gt;8*4)&amp;0xff,  (orig_svc_addr&gt;&gt;8*5)&amp;0xff,  (orig_svc_addr&gt;&gt;8*6)&amp;0xff,  (orig_svc_addr&gt;&gt;8*7)&amp;0xff};    int check_jmp_data_size = 10*4;    memcpy((void *)(new+4*4), check_jmp_data, check_jmp_data_size);    // 4.patch target address to jmp hook code    void* patch_addr = copy_from_addr;    uint64_t new_p = (uint64_t)new;    /*     ldr x16, #0x8     br x16     hook_code_addr_1     hook_code_addr_2     */    uint8_t patch_data[] = {0x50, 0x00, 0x00, 0x58, 0x00, 0x02, 0x1f, 0xd6,new_p&amp;0xff, (new_p&gt;&gt;8*1)&amp;0xff,  (new_p&gt;&gt;8*2)&amp;0xff,  (new_p&gt;&gt;8*3)&amp;0xff,  (new_p&gt;&gt;8*4)&amp;0xff,  (new_p&gt;&gt;8*5)&amp;0xff,  (new_p&gt;&gt;8*6)&amp;0xff,  (new_p&gt;&gt;8*7)&amp;0xff};    int patch_data_size = 4*4;    patchCode(patch_addr, patch_data, patch_data_size);    // 5. set new page to r-x    mprotect(new, len, PROT_READ | PROT_EXEC);    return true;}</code></pre><p>这里代码比较复杂，大致分为以下步骤</p><ul><li><p>map一页内存new，后面会将hook的代码写到里面</p></li><li><p>copy原svc前的四条指令保存到new页（目前没有进行相对寻址修复）</p></li><li><p>将hook判断的代码写到紧接着前面四条指令的后面，汇编代码大致如下</p><pre><code class="assembly"> cmp x16, #0x1a b.ne loc_not_ptrace_svc_jmp ldr x17, #0x8 br x17 orig_svc_next_addr_1 orig_svc_next_addr_2 ldr x17, #0x8 br x17 orig_svc_addr_1 orig_svc_addr_2</code></pre><p>就是简单的判断了系统调用号是否为26，若满足就跳到svc的下一条指令，若不是则跳回原svc指令以保证其他系统调用正常执行。</p></li><li><p>patch目标地址进行hook跳转，由于进行任意地址跳转需要4条指令大小，所以这里覆盖了svc前的四条指令</p><pre><code class="assembly"> ldr x16, #0x8 br x16 hook_code_addr_1 hook_code_addr_2</code></pre><p>这里就是在执行svc指令前使其跳转到我们的hook代码</p></li><li><p>最后将new这页设置为可读不可写可执行的页属性</p></li></ul><h3><a href="#zong-jie-todo" class="header-anchor">#</a><span id="zong-jie-todo">总结/Todo</span></h3><p>其实对于这种inlinehook去绕过调试，后面发现已经有人已经实现了，因为只要实现了inlinehook，肯定能hook代码绕过。不过我这里主要是想去自己分析以及实现这里面的很多细节。因为hook框架由于要考虑到稳定，兼容等等因素，所以往往代码不是很直接。而这里通过仅仅实现绕过反调试的需求，所以代码都比较通俗易懂，原理来说都是一样的。只有自己去动手写了代码才发现里面的乐趣所在，比如如何去实现系统调用的判断？如何解决寄存器污染?如何去实现代码段patch？当然还有很多汇编级别的坑存在，踩坑解决坑同样有意思，这里就不一一介绍。</p><p>后面主要还有两个事需要做：</p><ul><li>相对寻址指令的修复问题，以及hook代码的稳定兼容扩展问题。</li><li>抽离相关代码，集成到<a href="https://github.com/4ch12dy/xia0LLDB">xia0LLDB</a>之中，真正实现调试器中一键绕过反调试。</li></ul><h3><a href="#can-kao" class="header-anchor">#</a><span id="can-kao">参考</span></h3><ul><li><a href="https://stackoverflow.com/questions/25286221/how-to-find-text-segment-range-in-ios" target="_blank" rel="external">https://stackoverflow.com/questions/25286221/how-to-find-text-segment-range-in-ios</a></li><li><a href="https://github.com/coolstar/substitute">https://github.com/coolstar/substitute</a></li><li><a href="http://jmpews.github.io/2017/08/09/darwin/反调试及绕过/" target="_blank" rel="external">http://jmpews.github.io/2017/08/09/darwin/%E5%8F%8D%E8%B0%83%E8%AF%95%E5%8F%8A%E7%BB%95%E8%BF%87/</a></li><li><a href="http://4ch12dy.site/2019/08/16/iOS12-remap-bug-analyze/iOS12-remap-bug-analyze/" target="_blank" rel="external">http://4ch12dy.site/2019/08/16/iOS12-remap-bug-analyze/iOS12-remap-bug-analyze/</a></li><li><a href="http://4ch12dy.site/2019/08/12/xia0lldb-anti-anti-debug/xia0lldb-anti-anti-debug/" target="_blank" rel="external">http://4ch12dy.site/2019/08/12/xia0lldb-anti-anti-debug/xia0lldb-anti-anti-debug/</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2&gt;&lt;a href=&quot;#ios-inlinehook-rao-guo-fan-diao-shi&quot; class=&quot;header-anchor&quot;&gt;#&lt;/a&gt;&lt;span id=&quot;ios-inlinehook-rao-guo-fan-diao-shi&quot;&gt;iOS inlinehook绕
      
    
    </summary>
    
      <category term="RE" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/categories/RE/"/>
    
    
      <category term="RE" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/RE/"/>
    
      <category term="debug" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/debug/"/>
    
      <category term="hook" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/hook/"/>
    
  </entry>
  
  <entry>
    <title>iOS MDM搭建实践指南</title>
    <link href="https://github.com/4ch12dy/4ch12dy.github.io.git/2019/09/02/introduce-MDM-in-iOS/introduce-MDM-in-iOS/"/>
    <id>https://github.com/4ch12dy/4ch12dy.github.io.git/2019/09/02/introduce-MDM-in-iOS/introduce-MDM-in-iOS/</id>
    <published>2019-09-02T04:03:24.000Z</published>
    <updated>2019-09-02T06:33:32.000Z</updated>
    
    <content type="html"><![CDATA[<h3><a href="#ios-mdm-da-jian-shi-jian-zhi-nan" class="header-anchor">#</a><span id="ios-mdm-da-jian-shi-jian-zhi-nan">iOS MDM搭建实践指南</span></h3><blockquote><p>本文只介绍在iOS平台搭建MDM相关</p></blockquote><h4><a href="#kai-shi" class="header-anchor">#</a><span id="kai-shi">开始</span></h4><p>MDM全称是移动设备管理，方便企业对员工的移动设备管理。在iOS中同样支持MDM功能，本文就介绍如何搭建MDM整个架构。实际上在2018年的时候我通过翻阅为数不多的资料，经过一番折腾才最终走通了整个流程。然而当时过于激动并没有写相关文档记录，经过一年没想到签名证书过期了，却忘记了整个搭建流程。于是重新回顾了一下，所以这次记录下整个过程，希望对后面的人有所帮助。</p><h4><a href="#zheng-ti-liu-cheng" class="header-anchor">#</a><span id="zheng-ti-liu-cheng">整体流程</span></h4><ul><li><p>获取Vendor p12证书</p></li><li><p>制作服务端推送证书</p></li><li><p>生成并签名设备描述文件</p></li><li><p>MDM通信指令结构及原理分析</p></li><li><p>企业MDM最佳方案</p></li></ul><h4><a href="#huo-qu-vendor-p12-zheng-shu" class="header-anchor">#</a><span id="huo-qu-vendor-p12-zheng-shu">获取Vendor p12证书</span></h4><ul><li><p>制作MDM Vendor CSR</p><p>1、打开钥匙串</p><p>2、选择钥匙串访问-&gt;证书助理-&gt;从证书颁发机构请求证书</p><p>3、填写相关信息</p><p>4 、保存在本地</p></li><li><p>上传CSR文件到Apple</p><p>访问<a href="https://developer.apple.com/account/ios/certificate/create页面" target="_blank" rel="external">https://developer.apple.com/account/ios/certificate/create页面</a></p><p>将CSR文件上传到页面，等待1-2个工作日。</p><p>这时候你下载<code>.cer</code>文件，保存为<code>mdmvendor.cer</code></p></li><li><p>导出MDM私钥</p><p>在钥匙串中打开<code>mdmvendor.cer</code>文件，然后右键选择导出并保存为<code>private.p12</code>文件</p></li></ul><p><strong>注意：这里生成的文件很重要，建议新建一个MDM目录保存</strong></p><h4><a href="#zhi-zuo-fu-wu-duan-tui-song-zheng-shu" class="header-anchor">#</a><span id="zhi-zuo-fu-wu-duan-tui-song-zheng-shu">制作服务端推送证书</span></h4><h5><a href="#sheng-cheng-zheng-shu-qian-ming-qing-qiu-wen-jian" class="header-anchor">#</a><span id="sheng-cheng-zheng-shu-qian-ming-qing-qiu-wen-jian">生成证书签名请求文件</span></h5><ul><li>选择钥匙串访问-&gt;证书助理-&gt;从证书颁发机构请求证书</li><li>输入邮箱，姓名等信息</li><li>保存到本地为<code>push.csr</code></li></ul><h5><a href="#dao-chu-mdm-si-yao-he-vendor-zheng-shu" class="header-anchor">#</a><span id="dao-chu-mdm-si-yao-he-vendor-zheng-shu">导出MDM私钥和Vendor证书</span></h5><ul><li><p>取出私钥</p><p>执行下面的命令会要求输入<code>private.p12</code>的密码</p><pre><code class="bash">openssl pkcs12 -in private.p12 -nocerts -out key.pem</code></pre></li><li><p>去掉<code>private.p12</code>密码</p><pre><code class="bash">openssl rsa -in key.pem -out private.key</code></pre></li><li><p>取出证书文件</p><p>执行下面的命令会要求输入<code>private.p12</code>的密码</p><pre><code class="bash">openssl pkcs12 -in private.p12 -clcerts -nokeys -out cert.pem</code></pre></li><li><p>转为DES加密</p><pre><code class="bash">openssl x509 -in cert.pem -inform PEM -out mdm.cer -outform DES</code></pre></li></ul><h5><a href="#yong-mdmvendorsign-gong-ju-sheng-cheng-applepush-csr" class="header-anchor">#</a><span id="yong-mdmvendorsign-gong-ju-sheng-cheng-applepush-csr">用mdmvendorsign工具生成applepush.csr</span></h5><p>我们需要<a href="https://github.com/vineetchoudhary/Apple-iOS-MDM-Server">mdmvendorsign</a>工具中的<code>/vendor/</code>的相关代码文件，这里将上面的<code>private.key</code>, <code>push.csr</code>, 以及<code>mdm.cer</code>文件都复制到<code>/vendor/</code>目录。然后执行下面的命令</p><pre><code class="bash">python mdm_vendor_sign.py --key private.key --csr push.csr --mdm mdm.cer --out applepush.csr</code></pre><h5><a href="#cong-apple-huo-qu-tui-song-zheng-shu" class="header-anchor">#</a><span id="cong-apple-huo-qu-tui-song-zheng-shu">从apple获取推送证书</span></h5><p>将上面生成的<code>applepush.csr</code>文件上传到<a href="https://identity.apple.com/pushcert/" target="_blank" rel="external">Apple’s Push Certificates Portal</a></p><p>然后下载推送证书，下载回来的证书在钥匙串中打开，你会看到以下信息</p><p><img src="https://github.com/4ch12dy/4ch12dy.github.io/blob/master/articlePic/introduce-MDM-in-iOS/image-20190829194559215.png?raw=true" alt="image-20190829194559215"></p><p>其中用户ID需要保存下来，后面会用到。并右键导出p12私钥。存为<code>mdm.p12</code></p><p>将导出的p12私钥用下面命令生成服务器推送证书</p><pre><code>openssl pkcs12 -in mdm.p12 -out PushCert.pem -nodes</code></pre><p>然后将<code>PushCert.pem</code>拷贝到<code>./Apple-iOS-MDM-Server/scripts/</code>目录</p><h4><a href="#sheng-cheng-bing-qian-ming-she-bei-miao-shu-wen-jian" class="header-anchor">#</a><span id="sheng-cheng-bing-qian-ming-she-bei-miao-shu-wen-jian">生成并签名设备描述文件</span></h4><h5><a href="#sheng-cheng-she-bei-miao-shu-wen-jian" class="header-anchor">#</a><span id="sheng-cheng-she-bei-miao-shu-wen-jian">生成设备描述文件</span></h5><p> 用这个软件来制作<a href="https://itunes.apple.com/in/app/apple-configurator-2/id1037126344?mt=12" target="_blank" rel="external">Apple Configurator 2</a>描述文件，但是现在新版本不支持直接生产MDM的描述文件，只能先做一个通用的描述文件，然后再增加MDM相关的字段。</p><p>生成的大概模板如下：</p><pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE plist PUBLIC &quot;-//Apple//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&gt;&lt;plist version=&quot;1.0&quot;&gt;&lt;dict&gt;    &lt;key&gt;ConsentText&lt;/key&gt;    &lt;dict&gt;        &lt;key&gt;default&lt;/key&gt;        &lt;string&gt;install to enble DiDi manage your device&lt;/string&gt;    &lt;/dict&gt;    &lt;key&gt;PayloadContent&lt;/key&gt;    &lt;array&gt;        &lt;dict&gt;            &lt;key&gt;PayloadCertificateFileName&lt;/key&gt;            &lt;string&gt;DevAuthCA.cer.der&lt;/string&gt;            &lt;key&gt;PayloadContent&lt;/key&gt;            &lt;data&gt;            MIIEFzCCAv+gAwIBAgIIZylBveTSpRowDQYJKoZIhvcNAQELBQAw            YjELMAkGA1UEBhMCVVMxEzARBgNVBAoTCkFwcGxlIEluYy4xJjAk            BgNVBAsTHUFwcGxlIENlcnRpZmljYXRpb24gQXV0aG9yaXR5MRYw            FAYDVQQDEw1BcHBsZSBSb290IENBMB4XDTEzMDQyOTE4NDA1NFoX            DTI4MDQyOTE4NDA1NFowgYsxOTA3BgNVBAMMMERldmVsb3BlciBB            dXRoZW50aWNhdGlvbiBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eTEs            MCoGA1UECwwjQXBwbGUgV29ybGR3aWRlIERldmVsb3BlciBSZWxh            dGlvbnMxEzARBgNVBAoMCkFwcGxlIEluYy4xCzAJBgNVBAYTAlVT            MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA6rDzm76u            93aLqrS9hopNDa9oIjbzlWn62CLEsB4+GmzBJR6qK+ITfjbh6G0a            /etrPsB/LYqUU4WAJiiZZqMWCLTkvD061OoGQFlZEt7fJu0plH49            08rzTUA4nd81towql+yjYJH9wSGgvDfg2QpsvXd5c2ITTjgSUfZR            wSFHTYHA3Eoj/rpDuuar1RHxZsswxrdB8o8lHJuaShGHWFbsYfNC            FUmFMAxZbA3ppTYwcaAD8/KjUM3AeJbVqToz81QhEYmfMYFpsb8x            I5ae3MNmOlBaL169c+hUHFTtoUmzbRI1gnrXVKhLMsIpCngAvNEp            X85mEOCnN2NCJQrk3Ig5cQIDAQABo4GmMIGjMB0GA1UdDgQWBBRJ            9jYJuBsj+gNbtuqCoNldEBhnBjAPBgNVHRMBAf8EBTADAQH/MB8G            A1UdIwQYMBaAFCvQaUeUdgn+9GuNLkCm90dNfwheMC4GA1UdHwQn            MCUwI6AhoB+GHWh0dHA6Ly9jcmwuYXBwbGUuY29tL3Jvb3QuY3Js            MA4GA1UdDwEB/wQEAwIBBjAQBgoqhkiG92NkBgILBAIFADANBgkq            hkiG9w0BAQsFAAOCAQEA1fKJRhfZZspW9+GqK8+E6ciXbsABciYm            IvGy0snmeRN+e1KuFsoQmOXmdNY7SFvdb+2ZN/doOd5Es8hAih+3            VwHbac8YiFDXphpQshJJrtiOSBSsXBDgz0b4LjRqhtXdU9BB67nD            Q2/zZSNKxvIqXqqsPQiKv/tctQH7kr3ogmZ4GkqjGgHWEocbTfOF            pioDQ1xXP0eF/jn02cp9vnyAuyqpkybJYkaIAVUq2bRWV+9D6WLo            6/3X8AWOCj65GPgx+DLIDAD2yHJu1D9JuSqD5cD1AChpPUregUvi            Uszq4TyJ7LjHi4/w1jbWrlbeObEp2lNcKFTKIkeSZ88IE2b25g==            &lt;/data&gt;            &lt;key&gt;PayloadDescription&lt;/key&gt;            &lt;string&gt;添加 PKCS#1 格式的证书&lt;/string&gt;            &lt;key&gt;PayloadDisplayName&lt;/key&gt;            &lt;string&gt;Developer Authentication Certification Authority&lt;/string&gt;            &lt;key&gt;PayloadIdentifier&lt;/key&gt;            &lt;string&gt;com.apple.security.pkcs1.A742C668-A859-4DB9-B7AD-5913CDACD1C9&lt;/string&gt;            &lt;key&gt;PayloadType&lt;/key&gt;            &lt;string&gt;com.apple.security.pkcs1&lt;/string&gt;            &lt;key&gt;PayloadUUID&lt;/key&gt;            &lt;string&gt;A742C668-A859-4DB9-B7AD-5913CDACD1C9&lt;/string&gt;            &lt;key&gt;PayloadVersion&lt;/key&gt;            &lt;integer&gt;1&lt;/integer&gt;        &lt;/dict&gt;        &lt;dict&gt;            &lt;key&gt;PayloadCertificateFileName&lt;/key&gt;            &lt;string&gt;AppleWWDRCAG2.cer&lt;/string&gt;            &lt;key&gt;PayloadContent&lt;/key&gt;            &lt;data&gt;            MIIC9zCCAnygAwIBAgIIb+/Y9emjp+4wCgYIKoZIzj0EAwIwZzEb            MBkGA1UEAwwSQXBwbGUgUm9vdCBDQSAtIEczMSYwJAYDVQQLDB1B            cHBsZSBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eTETMBEGA1UECgwK            QXBwbGUgSW5jLjELMAkGA1UEBhMCVVMwHhcNMTQwNTA2MjM0MzI0            WhcNMjkwNTA2MjM0MzI0WjCBgDE0MDIGA1UEAwwrQXBwbGUgV29y            bGR3aWRlIERldmVsb3BlciBSZWxhdGlvbnMgQ0EgLSBHMjEmMCQG            A1UECwwdQXBwbGUgQ2VydGlmaWNhdGlvbiBBdXRob3JpdHkxEzAR            BgNVBAoMCkFwcGxlIEluYy4xCzAJBgNVBAYTAlVTMFkwEwYHKoZI            zj0CAQYIKoZIzj0DAQcDQgAE3fC3BkvP3XMEE8RDiQOTgPte9nSt            QmFSWAImUxnIYyIHCVJhysTZV+9tJmiLdJGMxPmAaCj8CWjwENrp            0C7JGqOB9zCB9DBGBggrBgEFBQcBAQQ6MDgwNgYIKwYBBQUHMAGG            Kmh0dHA6Ly9vY3NwLmFwcGxlLmNvbS9vY3NwMDQtYXBwbGVyb290            Y2FnMzAdBgNVHQ4EFgQUhLaEzDqGYnIWWZToGqO9SN863wswDwYD            VR0TAQH/BAUwAwEB/zAfBgNVHSMEGDAWgBS7sN6hWDOImqSKmd6+            veuv2sskqzA3BgNVHR8EMDAuMCygKqAohiZodHRwOi8vY3JsLmFw            cGxlLmNvbS9hcHBsZXJvb3RjYWczLmNybDAOBgNVHQ8BAf8EBAMC            AQYwEAYKKoZIhvdjZAYCDwQCBQAwCgYIKoZIzj0EAwIDaQAwZgIx            ANmxxzHGI/ZPTdDZR8V9GGkRh3En02it4Jtlmr5s3z9GppAJvm6h            OyywUYlBPIfSvwIxAPxkUolLPF2/axzCiZgvcq61m6oaCyNUd1To            FUOixRLal1BzfF7QbrJcYlDXUfE6Wg==            &lt;/data&gt;            &lt;key&gt;PayloadDescription&lt;/key&gt;            &lt;string&gt;添加 PKCS#1 格式的证书&lt;/string&gt;            &lt;key&gt;PayloadDisplayName&lt;/key&gt;            &lt;string&gt;Apple Worldwide Developer Relations CA - G2&lt;/string&gt;            &lt;key&gt;PayloadIdentifier&lt;/key&gt;            &lt;string&gt;com.apple.security.pkcs1.32A40F6B-24FA-4026-9BF6-66AED47CEC40&lt;/string&gt;            &lt;key&gt;PayloadType&lt;/key&gt;            &lt;string&gt;com.apple.security.pkcs1&lt;/string&gt;            &lt;key&gt;PayloadUUID&lt;/key&gt;            &lt;string&gt;32A40F6B-24FA-4026-9BF6-66AED47CEC40&lt;/string&gt;            &lt;key&gt;PayloadVersion&lt;/key&gt;            &lt;integer&gt;1&lt;/integer&gt;        &lt;/dict&gt;        &lt;dict&gt;            &lt;key&gt;PayloadCertificateFileName&lt;/key&gt;            &lt;string&gt;AppleRootCA-G2.cer&lt;/string&gt;            &lt;key&gt;PayloadContent&lt;/key&gt;            &lt;data&gt;            MIIFkjCCA3qgAwIBAgIIAeDltYNno+AwDQYJKoZIhvcNAQEMBQAw            ZzEbMBkGA1UEAwwSQXBwbGUgUm9vdCBDQSAtIEcyMSYwJAYDVQQL            DB1BcHBsZSBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eTETMBEGA1UE            CgwKQXBwbGUgSW5jLjELMAkGA1UEBhMCVVMwHhcNMTQwNDMwMTgx            MDA5WhcNMzkwNDMwMTgxMDA5WjBnMRswGQYDVQQDDBJBcHBsZSBS            b290IENBIC0gRzIxJjAkBgNVBAsMHUFwcGxlIENlcnRpZmljYXRp            b24gQXV0aG9yaXR5MRMwEQYDVQQKDApBcHBsZSBJbmMuMQswCQYD            VQQGEwJVUzCCAiIwDQYJKoZIhvcNAQEBBQADggIPADCCAgoCggIB            ANgREkhI2imKScUcx+xuM23+TfvgHN6sXuI2pyT5f1BrTM65MFQn            5bPW7SXmMLYFN14UIhHF6Kob0vuy0gmVOKTvKkmMXT5xZgM4+xb1            hYjkWpIMBDLyyED7Ul+f9sDx47pFoFDVEovy3d6RhiPw9bZyLgHa            C/YuOQhfGaFjQQscp5TBhsRTL3b2CtcM0YM/GlMZ81fVJ3/8E7j4            ko380yhDPLVoACVdJ2LT3VXdRCCQgzWTxb+4Gftr49wIQuavbfqe            QMpOhYV4SbHXw8EwOTKrfl+q04tvny0aIWhwZ7Oj8ZhBbZF8+Nfb            qOdfIRqMM78xdLe40fTgIvS/cjTf94FNcX1RoeKz8NMoFnNvzcyt            N31O661A4T+B/fc9Cj6i8b0xlilZ3MIZgIxbdMYs0xBTJh0UT8TU            gWY8h2czJxQI6bR3hDRSj4n4aJgXv8O7qhOTH11UL6jHfPsNFL4V            PSQ08prcdUFmIrQB1guvkJ4M6mL4m1k8COKWNORj3rw31OsMiAND            C1CvoDTdUE0V+1ok2Az6DGOeHwOx4e7hqkP0ZmUoNwIx7wHHHtHM            n23KVDpA287PT0aLSmWaasZobNfMmRtHsHLDd4/E92GcdB/O/Wuh            wpyUgquUoue9G7q5cDmVF8Up8zlYNPXEpMZ7YLlmQ1A/bmH8DvmG            qmAMQ0uVAgMBAAGjQjBAMB0GA1UdDgQWBBTEmRNsGAPCe8CjoA1/            coB6HHcmjTAPBgNVHRMBAf8EBTADAQH/MA4GA1UdDwEB/wQEAwIB            BjANBgkqhkiG9w0BAQwFAAOCAgEAUabz4vS4PZO/Lc4Pu1vhVRRO            TtHlznldgX/+tvCHM/jvlOV+3Gp5pxy+8JS3ptEwnMgNCnWefZKV            fhidfsJxaXwU6s+DDuQUQp50DhDNqxq6EWGBeNjxtUVAeKuowM77            fWM3aPbn+6/Gw0vsHzYmE1SGlHKy6gLti23kDKaQwFd1z4xCfVzm            MX3zybKSaUYOiPjjLUKyOKimGY3xn83uamW8GrAlvacp/fQ+onVJ            v57byfenHmOZ4VxG/5IFjPoeIPmGlFYl5bRXOJ3riGQUIUkhOb9i            ZqmxospvPyFgxYnURTbImHy99v6ZSYA7LNKmp4gDBDEZt7Y6YUX6            yfIjyGNzv1aJMbDZfGKnexWoiIqrOEDCzBL/FePwN983csvMmOa/            orz6JopxVtfnJBtIRD6e/J/JzBrsQzwBvDR4yGn1xuZW7AYJNpDr            FEobXsmII9oDMJELuDY++ee1KG++P+w8j2Ud5cAeh6Squpj9kuNs            JnfdBrRkBof0Tta6SqoWqPQFZ2aWuuJVecMsXUmPgEkrihLHdoBR            37q9ZV0+N0djMenl9MU/S60EinpxLK8JQzcPqOMyT/RFtm2XNuyE            9QoB6he7hY1Ck3DDUOUUi78/w0EP3SIEIwiKum1xRKtzCTrJ+VKA            Cd+66eYWyi4uTLLT3OUEVLLUNIAytbwPF+E=            &lt;/data&gt;            &lt;key&gt;PayloadDescription&lt;/key&gt;            &lt;string&gt;添加 CA 根证书&lt;/string&gt;            &lt;key&gt;PayloadDisplayName&lt;/key&gt;            &lt;string&gt;Apple Root CA - G2&lt;/string&gt;            &lt;key&gt;PayloadIdentifier&lt;/key&gt;            &lt;string&gt;com.apple.security.root.A0BB6B15-2A9E-47B8-9EC2-871F1C04DE8E&lt;/string&gt;            &lt;key&gt;PayloadType&lt;/key&gt;            &lt;string&gt;com.apple.security.root&lt;/string&gt;            &lt;key&gt;PayloadUUID&lt;/key&gt;            &lt;string&gt;A0BB6B15-2A9E-47B8-9EC2-871F1C04DE8E&lt;/string&gt;            &lt;key&gt;PayloadVersion&lt;/key&gt;            &lt;integer&gt;1&lt;/integer&gt;        &lt;/dict&gt;        &lt;dict&gt;            &lt;key&gt;Password&lt;/key&gt;            &lt;string&gt;yourPWD&lt;/string&gt;            &lt;key&gt;PayloadCertificateFileName&lt;/key&gt;            &lt;string&gt;Identity.p12&lt;/string&gt;            &lt;key&gt;PayloadContent&lt;/key&gt;            &lt;data&gt;            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            e96ah6AF/AQIVFgg47LiiYwCAggA            &lt;/data&gt;            &lt;key&gt;PayloadDescription&lt;/key&gt;            &lt;string&gt;添加 PKCS#12 格式的证书&lt;/string&gt;            &lt;key&gt;PayloadDisplayName&lt;/key&gt;            &lt;string&gt;Identity.p12&lt;/string&gt;            &lt;key&gt;PayloadIdentifier&lt;/key&gt;            &lt;string&gt;com.apple.security.pkcs12.E61D7ED5-850A-4F2E-B191-F99E40846FF6&lt;/string&gt;            &lt;key&gt;PayloadType&lt;/key&gt;            &lt;string&gt;com.apple.security.pkcs12&lt;/string&gt;            &lt;key&gt;PayloadUUID&lt;/key&gt;            &lt;string&gt;E61D7ED5-850A-4F2E-B191-F99E40846FF6&lt;/string&gt;            &lt;key&gt;PayloadVersion&lt;/key&gt;            &lt;integer&gt;1&lt;/integer&gt;        &lt;/dict&gt;    &lt;/array&gt;    &lt;key&gt;PayloadDescription&lt;/key&gt;    &lt;string&gt;MDM enbale server manage your device&lt;/string&gt;    &lt;key&gt;PayloadDisplayName&lt;/key&gt;    &lt;string&gt;XXX MDM&lt;/string&gt;    &lt;key&gt;PayloadIdentifier&lt;/key&gt;    &lt;string&gt;com.apple.mgmt.External.3a3c70d4-cc4f-4713-xxxx-f38d6fd7xxxx&lt;/string&gt;    &lt;key&gt;PayloadOrganization&lt;/key&gt;    &lt;string&gt;XXX&lt;/string&gt;    &lt;key&gt;PayloadRemovalDisallowed&lt;/key&gt;    &lt;false/&gt;    &lt;key&gt;PayloadType&lt;/key&gt;    &lt;string&gt;Configuration&lt;/string&gt;    &lt;key&gt;PayloadUUID&lt;/key&gt;    &lt;string&gt;D633CDFE-9806-4224-AD38-7FE0CAB12163&lt;/string&gt;    &lt;key&gt;PayloadVersion&lt;/key&gt;    &lt;integer&gt;1&lt;/integer&gt;&lt;/dict&gt;&lt;/plist&gt;</code></pre><p>上面直接用那个工具填写相关信息并导入相关证书就能生成，但是真正的MDM策略相关需要手动添加一个字典如下：</p><pre><code class="xml">&lt;dict&gt;            &lt;key&gt;AccessRights&lt;/key&gt;            &lt;integer&gt;8191&lt;/integer&gt;            &lt;key&gt;CheckInURL&lt;/key&gt;            &lt;string&gt;https://mdmapi.demo.com/checkin&lt;/string&gt;            &lt;key&gt;CheckOutWhenRemoved&lt;/key&gt;            &lt;true/&gt;            &lt;key&gt;IdentityCertificateUUID&lt;/key&gt;            &lt;string&gt;E61D7ED5-850A-4F2E-B191-F99E40846FF6&lt;/string&gt;            &lt;key&gt;PayloadDescription&lt;/key&gt;            &lt;string&gt;Configures MobileDeviceManagement.&lt;/string&gt;            &lt;key&gt;PayloadIdentifier&lt;/key&gt;            &lt;string&gt;com.apple.mdm.2C62A547-9CA9-4D5A-AF86-0DF2467274EF&lt;/string&gt;            &lt;key&gt;PayloadOrganization&lt;/key&gt;            &lt;string&gt;Developer Insider&lt;/string&gt;            &lt;key&gt;PayloadType&lt;/key&gt;            &lt;string&gt;com.apple.mdm&lt;/string&gt;            &lt;key&gt;PayloadUUID&lt;/key&gt;            &lt;string&gt;E7438708-331E-4E68-99BC-3B9B435DF3DC&lt;/string&gt;            &lt;key&gt;PayloadVersion&lt;/key&gt;            &lt;integer&gt;1&lt;/integer&gt;            &lt;key&gt;ServerURL&lt;/key&gt;            &lt;string&gt;https://mdmapi.demo.com/server&lt;/string&gt;            &lt;key&gt;SignMessage&lt;/key&gt;            &lt;true/&gt;            &lt;key&gt;Topic&lt;/key&gt;            &lt;string&gt;com.apple.mgmt.External.3a3c70d4-cc4f-4713-xxxx-f38d6fd7xxxx&lt;/string&gt;            &lt;key&gt;UseDevelopmentAPNS&lt;/key&gt;            &lt;false/&gt;        &lt;/dict&gt;</code></pre><p>这里简单说几个比较重点的字段</p><table><thead><tr><th style="text-align:left">KEY</th><th style="text-align:left">TYPE</th><th style="text-align:left">DESCRIPTION</th></tr></thead><tbody><tr><td style="text-align:left">IdentityCertificateUUID</td><td style="text-align:left">String</td><td style="text-align:left"><em>Mandatory.</em> UUID of the certificate payload for the device’s identity. It may also point to a SCEP payload. You need to use the <code>PayloadUUID</code> of the <code>identity.p12</code> in this field.</td></tr><tr><td style="text-align:left">PayloadUUID</td><td style="text-align:left">String</td><td style="text-align:left"><em>Mandatory.</em> Here you need to generate a UUID. You can use <code>uuidgen</code> to generate an UUID and then copy paste that UUID in this field. UUID looks like this 34995C2E-XXXX-XXXX-XXXX-D6DB637A1D6E</td></tr><tr><td style="text-align:left">PayloadIdentifier</td><td style="text-align:left">String</td><td style="text-align:left">Here you need to append the UUID in after <code>com.apple.mdm.</code> which we generated in last step. Your payload identifier looks like this com.apple.mdm.34995C2E-XXXX-XXXX-XXXX-D6DB637A1D6E</td></tr><tr><td style="text-align:left">Topic</td><td style="text-align:left">String</td><td style="text-align:left"><em>Mandatory.</em> The topic that MDM listens to for push notifications. The certificate that the server uses to send push notifications must have the same topic in its subject. The topic must begin with the <code>com.apple.mgmt.External.hexstuffhere...</code> prefix.</td></tr><tr><td style="text-align:left">ServerURL</td><td style="text-align:left">String</td><td style="text-align:left"><em>Mandatory.</em> The URL that the device contacts to retrieve device management instructions. Must begin with the <code>https://</code> URL scheme, and may contain a port number (<code>https://YOUR_HOSTNAME_OR_IP:PORT/server</code>, for example).</td></tr><tr><td style="text-align:left">CheckInURL</td><td style="text-align:left">String</td><td style="text-align:left"><em>Optional.</em> The URL that the device should use to check in during installation. Must begin with the <code>https://</code> URL scheme and may contain a port number (<code>https://YOUR_HOSTNAME_OR_IP:8080/checkin</code>, for example). If this URL is not given, the <code>ServerURL</code> is used for both purposes.</td></tr><tr><td style="text-align:left">CheckOutWhenRemoved</td><td style="text-align:left">Boolean</td><td style="text-align:left"><em>Optional.</em> If <code>true</code>, the device attempts to send a <code>CheckOut</code>message to the check-in server when the profile is removed. Defaults to <code>false</code>.</td></tr><tr><td style="text-align:left">AccessRights</td><td style="text-align:left">Integer, flags</td><td style="text-align:left"><em>Required.</em> Logical OR of the following bit-flags:1: Allow inspection of installed configuration profiles.2: Allow installation and removal of configuration profiles.4: Allow device lock and passcode removal.8: Allow device erase.16: Allow query of Device Information (device capacity, serial number).32: Allow query of Network Information (phone/SIM numbers, MAC addresses).64: Allow inspection of installed provisioning profiles.128: Allow installation and removal of provisioning profiles.256: Allow inspection of installed applications.512: Allow restriction-related queries.1024: Allow security-related queries.2048: Allow manipulation of settings.4096: Allow app management.May not be zero. If 2 is specified, 1 must also be specified. If 128 is specified, 64 must also be specified.</td></tr><tr><td style="text-align:left">UseDevelopmentAPNS</td><td style="text-align:left">Boolean</td><td style="text-align:left"><em>Optional.</em> If <code>true</code>, the device uses the development APNS servers. Otherwise, the device uses the production servers. Defaults to <code>false</code>. Note that this property must be set to false if your Apple Push Notification Service certificate was issued by the <a href="https://identity.apple.com/pushcert" target="_blank" rel="external">Apple Push Certificate Portal</a>. That portal only issues certificates for the production push environment.</td></tr></tbody></table><ul><li><p>IdentityCertificateUUID：这个UUID是<code>identity.p12</code>的<code>PayloadUUID</code>。关于<code>identity.p12</code>这里其实是一个设备标识的证书，这个证书可能不知道怎么制作。其实用自签的签名就行。制作流程如下</p><p>生成自签证书（生成2046位的加密私钥）</p><pre><code>openssl genrsa -out server.key 2048</code></pre><p>生成自签证书（生成证书签名请求）</p><pre><code>openssl req -new -key server.key -out server.csr</code></pre><p>生成自签证书（生成类型为X509的自签名证书）</p><pre><code>openssl x509 -req -days 3650 -in server.csr -signkey server.key -out server.crt</code></pre><p>这时候我们有<code>server.key</code>、<code>server.csr</code>、<code>server.crt</code>三个文件</p><p>然后将<code>server.crt</code>复制生成两个文件并命名：<code>identity.crt</code>、<code>server.crt</code></p><p>同样将<code>server.key</code>复制生成两个文件并命名：<code>cakey.key</code>、<code>identity.key</code></p><p>最后将<code>server.csr</code>重命名为<code>identity.csr</code></p><p>然后用<a href="https://github.com/vineetchoudhary/Apple-iOS-MDM-Server/blob/master/scripts/make_certs.sh">make_certs.sh</a>生成<code>Identity.p12</code></p></li><li><p>AccessRights：这个字段会在安装描述文件的时候提示申请了哪些权限，并且这里是按位与运算</p></li><li><p>CheckInURL以及ServerURL涉及到后面MDM设备、苹果APNS、服务器三方通信相关</p></li></ul><h5><a href="#qian-ming-miao-shu-wen-jian" class="header-anchor">#</a><span id="qian-ming-miao-shu-wen-jian">签名描述文件</span></h5><p>在签名前建议先对未签名的描述文件进行通信测试，保证在未签名之前安装描述文件以后服务端能够正常发送指令通信。</p><p>这里的签名仅仅是为了部署描述文件，和MDM本身并不相关，所以事实上可以用任意一个证书进行签名，但为了保证是公司发布的描述文件，建议用公司的iOS开发证书即可。这里提供两个工具</p><ul><li><a href="https://github.com/JeremyAgost/Hancock">Hancock App</a></li><li><a href="https://github.com/nmcspadden/ProfileSigner">ProfileSigner</a></li></ul><p>使用比较简单，这里不再介绍。</p><h4><a href="#mdm-tong-xin-zhi-ling-jie-gou-ji-yuan-li-fen-xi" class="header-anchor">#</a><span id="mdm-tong-xin-zhi-ling-jie-gou-ji-yuan-li-fen-xi">MDM通信指令结构及原理分析</span></h4><p>暂位，后面有时间再补充</p><h4><a href="#qi-ye-mdm-zui-jia-fang-an" class="header-anchor">#</a><span id="qi-ye-mdm-zui-jia-fang-an">企业MDM最佳方案</span></h4><p>虽然MDM自身提供了很多远程指令相关的移动设备管理功能，但是在实际上企业管理中还远远不够，所以建议配合一个agent之类的app辅助。在我们实现中，采用安装描述文件的时候就推送安装agent，然后用户后续的所有交互都由app负责。app主要作用在于能够获取定位，账号设备绑定，安全准入，扫码登录等等。以及能够提供公司级的VPN等相关公司配置。这里能做的还有很多，可以和企业实际的管理结合。</p><h4><a href="#can-kao" class="header-anchor">#</a><span id="can-kao">参考</span></h4><ul><li><a href="https://developerinsider.co/how-to-create-a-verified-ios-mobile-device-management-mdm-profile/" target="_blank" rel="external">https://developerinsider.co/how-to-create-a-verified-ios-mobile-device-management-mdm-profile/</a></li><li><a href="https://github.com/vineetchoudhary/Apple-iOS-MDM-Server">https://github.com/vineetchoudhary/Apple-iOS-MDM-Server</a></li><li><a href="https://micromdm.io/blog/certificates/" target="_blank" rel="external">https://micromdm.io/blog/certificates/</a></li><li><a href="https://osxdominion.wordpress.com/2015/04/21/signing-mobileconfig-profiles-with-keychain-certificates/" target="_blank" rel="external">https://osxdominion.wordpress.com/2015/04/21/signing-mobileconfig-profiles-with-keychain-certificates/</a></li><li><a href="https://micromdm.io/blog/certificates/" target="_blank" rel="external">https://micromdm.io/blog/certificates/</a> &gt;!!!&lt;</li><li><a href="https://github.com/micromdm/micromdm">https://github.com/micromdm/micromdm</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3&gt;&lt;a href=&quot;#ios-mdm-da-jian-shi-jian-zhi-nan&quot; class=&quot;header-anchor&quot;&gt;#&lt;/a&gt;&lt;span id=&quot;ios-mdm-da-jian-shi-jian-zhi-nan&quot;&gt;iOS MDM搭建实践指南&lt;/span&gt;&lt;
      
    
    </summary>
    
      <category term="wiki" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/categories/wiki/"/>
    
    
      <category term="wiki" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/wiki/"/>
    
      <category term="MDM" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/MDM/"/>
    
  </entry>
  
  <entry>
    <title>Mac安装Win10完整指南</title>
    <link href="https://github.com/4ch12dy/4ch12dy.github.io.git/2019/08/21/mac-install-windows/mac-install-windows/"/>
    <id>https://github.com/4ch12dy/4ch12dy.github.io.git/2019/08/21/mac-install-windows/mac-install-windows/</id>
    <published>2019-08-21T05:44:54.000Z</published>
    <updated>2019-08-29T04:21:23.000Z</updated>
    
    <content type="html"><![CDATA[<h3><a href="#mac-an-zhuang-win10-wan-zheng-zhi-nan" class="header-anchor">#</a><span id="mac-an-zhuang-win10-wan-zheng-zhi-nan">Mac安装Win10完整指南</span></h3><blockquote><p>关于win10你想要的安装方式，各种姿势以及各种坑和解决方案都在这里</p></blockquote><h4><a href="#kai-shi" class="header-anchor">#</a><span id="kai-shi">开始</span></h4><p>对于某些软件只有win版本或者在win上性能更好，这时候你就会想装win系统了。一般来说有两种选择，一是用虚拟机，二是装双系统。然而虚拟机太慢太卡，而且还和双系统存在同一个问题在于会和mac自身系统占用同一块磁盘，对于256G大小的磁盘空间来说相当限制。如果你现在想装Windows或者正遇到问题，那么这篇笔记应该能解决你的问题。我会尽可能把我在安装过程中遇到的问题以及解决方案都描述清楚。</p><p>那么这里还提供一种方案就是将win装在外置磁盘上面，这样上面的问题都得到的解决，因为现在的外置SSD速度已经相当快，完全能满足将一个操作系统放到外置SSD的需求。不仅如此，我还尝试了在外置SSD上面装双系统，这样可以将一块SSD磁盘的利用率最大化。</p><p>作为对比，我这里会将所有的安装方式都尝试一遍。将会安装以下顺序介绍mac上面安装win的具体方案。</p><ul><li><p>用虚拟机安装win10</p></li><li><p>用BootCamp安装win10</p></li><li><p>用移动SSD安装win10</p></li><li><p>用移动SSD安装装系统</p></li></ul><h4><a href="#xu-ni-ji-an-zhuang-win10" class="header-anchor">#</a><span id="xu-ni-ji-an-zhuang-win10">虚拟机安装win10</span></h4><p>对于虚拟机安装win10，只需要把镜像文件放到VMWare等虚拟机内一直下一步就能安装，这里就不再介绍这种方式。</p><h4><a href="#bootcamp-an-zhuang-win10" class="header-anchor">#</a><span id="bootcamp-an-zhuang-win10">BootCamp安装win10</span></h4><h5><a href="#1-bootcamp-quan-zi-dong-an-zhuang" class="header-anchor">#</a><span id="1-bootcamp-quan-zi-dong-an-zhuang">1 、Bootcamp全自动安装</span></h5><p>早就听说在最新的macOS系统版本中，用BootCamp能很简单的安装Windows，既然如此决定先用BootCamp试试。这里你首先需要下载一个Windows的iso镜像文件，我这里提供几个下载的地址</p><ul><li><a href="https://msdn.itellyou.cn/" target="_blank" rel="external">https://msdn.itellyou.cn/</a> </li><li><a href="https://tb.rg-adguard.net/public.php?lang=zh-CN" target="_blank" rel="external">https://tb.rg-adguard.net/public.php?lang=zh-CN</a></li><li><a href="https://www.microsoft.com/zh-cn/software-download/windows10ISO" target="_blank" rel="external">https://www.microsoft.com/zh-cn/software-download/windows10ISO</a> （我是在官网下载的镜像）</li></ul><p>win10镜像准备好以后，用BootCamp装的时候选择该镜像并分配50G的分区。点击下一步，下载完相关驱动以后（连VPN，不然有点慢）进行分区，结果就提示分区失败了。去网上搜了一下，大多数人都说由于最新分区采用的APFS导致得，一堆解决方案。主要都说采用系统降级的方式，或者由于修复time machine造成的分区错误，或者磁盘加密的缘故。但是很明显我刚装的系统不存在这些问题。</p><p>又重新尝试了几次，还是不行，快怀疑苹果BootCamp的问题了。</p><p>还有人提示可以进入单用户模式（command+s）然后用<code>fsck_apfs</code>或者<code>fsck</code>命令去修复磁盘。</p><p>但是上面的都做了以后还是不行。</p><h5><a href="#2-bootcamp-qi-dong-pan-shou-dong-fen-qu" class="header-anchor">#</a><span id="2-bootcamp-qi-dong-pan-shou-dong-fen-qu">2、Bootcamp+启动盘+手动分区</span></h5><p>既然BootCamp自动安装不了，那选择手动安装吧。这个原理也不复杂，BootCamp最主要工作在于下载驱动+分区+引导win系统。然后这些我们实际上可以手动完成。</p><ul><li><p><strong>制作启动盘</strong></p><p>这里可以找一个U盘来制作win10的启动盘，由于我这里是移动硬盘，所以我分了一个10G的区来作为启动盘。这里制作需要<a href="https://unetbootin.github.io/" target="_blank" rel="external">unetbootin</a>来完成制作，这个软件支持mac、win、linux平台。我下载了mac版的。</p><p><img src="https://github.com/4ch12dy/4ch12dy.github.io/blob/master/articlePic/mac-install-windows/image-20190822003218038.png?raw=true" width="500" hegiht="187"></p><p>分别选择win10的iso镜像，以及选择对应的设备。如果不清楚你的设备是哪一个，可以输入<code>diskutil list</code>去找到对应的设备名，点击ok等待一会，就这样启动盘就制作完成了。</p></li></ul><ul><li><p><strong>手动分区</strong></p><p>这里的分区是指将mac主硬盘分一个区来安装Windows，由于这里需要安装Windows，所以只能用Windows支持的磁盘格式，最开始我分了一个50G的FAT32分区，然后用启动盘安装发现不能选择该磁盘。后面经过一番研究，才发现。Windows磁盘需要NTFS格式的分区，但是这里有个问题在于mac不支持NTFS格式的操作。于是乎，搜索了一番，发现可以安装一些软件、驱动让mac支持NTFS格式。这里提供两种软件供参考<a href="http://www.ntfsformac.cn/xiazai.html" target="_blank" rel="external">ParagonNTFS</a>和<a href="https://www.tuxera.com/products/tuxera-ntfs-for-mac-cn/" target="_blank" rel="external">tuxera-ntfs</a>但都是收费的。安装完以后终于能分NTFS格式的区了，但是有个头疼的问题在于只能分30G以下才会成功，大于30G就提示失败。但是如果分区是30G的话，启动盘选择磁盘的时候又会提示需要大于40G的磁盘，这里不是矛盾了吗。</p></li></ul><h5><a href="#chong-zhuang-mac-xi-tong" class="header-anchor">#</a><span id="chong-zhuang-mac-xi-tong">重装mac系统</span></h5><p>由于上面手动分区也不行，我就重装了mac系统。由于我之前制作了mojave最新系统的mac启动盘，所以重装还是比较快。建议制作一个mac系统盘备用。这里简单说下制作过程。</p><ul><li>同样给硬盘分一个10G的区</li><li>下载macOS系统，这里比如<code>Install macOS Mojave</code></li><li><code>sudo /Applications/Install\ macOS\ Mojave.app/Contents/Resources/createinstallmedia --volume /Volumes/MyVolume</code>执行里面的createinstallmedia命令，选择上面的分区就制作完成了。</li></ul><p>如果还有问题可以点<a href="https://support.apple.com/zh-cn/HT201372" target="_blank" rel="external">这里</a></p><p>重装完以后，我试了下用BootCamp安装，发现一路畅通，直接到引导了Windows系统安装的步骤，但是这里又有问题了。</p><p><img src="https://github.com/4ch12dy/4ch12dy.github.io/blob/master/articlePic/mac-install-windows/image-20190822004521105.png?raw=true" width="500" hegiht="187"></p><p>WTF？你自己刚分好的区，现在又给我说不行了？这里还真没办法。不过我回到macOS用磁盘工具发现，虽然不能安装Windows，但却给我分好了一个NTFS格式的区。既然有了这个区，那我直接用上面制作的启动盘手动安装Windows不就完了。</p><p>重启电脑，按住option按钮，选择那个win启动盘，到选择Windows安装磁盘的步骤，发现BootCamp分的那个区是可以用的，于是我就格式化了那个磁盘，然后选择它，果然安装成功了。这一刻我饱含泪水，终于把Windows安装成功了。经过一番设置，顺利进入win10系统，顺便说下感觉win10还不错，无论是画质还是系统设计，已经比win7好太多。</p><p>当我以为一切就这样结束的时候，发现Windows不能连wifi，不过突然想起，由于我是手动安装的Windows，所以并没有安装相关驱动，导致wifi模块并不能识别。还好BootCamp提供了手动下载驱动支持文件的选项，这里由于需要在win10中访问并运行驱动安装程序，所以我又分了一个FAT32的区专门提供win10访问。把下载的驱动程序放入这个分区，重启进入win10系统，运行里面的安装程序以后，wifi就能连接上了。</p><p>最后我为了体验完整的win10系统，还在淘宝上买了一个激活码，成功激活为正版win10。不过我这里也提供几个免费的key，但不一定可靠，嫌麻烦可以花几块钱去淘宝买。</p><ul><li><a href="https://productkeysdl.com/windows-10-product-key/" target="_blank" rel="external">https://productkeysdl.com/windows-10-product-key/</a></li><li><a href="http://www.ylmfwin100.com/ylmf/8642.html" target="_blank" rel="external">http://www.ylmfwin100.com/ylmf/8642.html</a></li></ul><h5><a href="#shuang-xi-tong-win10-shi-yong-ti-yan" class="header-anchor">#</a><span id="shuang-xi-tong-win10-shi-yong-ti-yan">双系统win10使用体验</span></h5><p>win10装好以后，体验了下IDA，加载dyld_cache后发现是真的比mac和虚拟机装的IDA流畅很多。也不费我这么多精力去装双系统。不过由于我的mac磁盘一共才256G，所以我下一步的打算是买一个移动SSD硬盘来装Windows，整个系统都运行在外置的SSD硬盘，看了下现在移动固态硬盘的速度，应该是没什么问题的。暂选三星T5、500G、540M/s那款。</p><h4><a href="#wai-zhi-ssd-ying-pan-an-zhuang-win10" class="header-anchor">#</a><span id="wai-zhi-ssd-ying-pan-an-zhuang-win10">外置SSD硬盘安装win10</span></h4><p>前面说到了双系统上的win10体验，就速度、性能来说已经很不错了。但是为什么还要用外置SSD来安装win10呢。这里涉及到我的mac只有256G硬盘，还要划分一部分来安装win10，这样两个系统可用空间都很小。我买的三星T5移动固态硬盘到手了，准备把win10直接安装到上面。由于现在移动固态硬盘的速度完全能够支持这样的方式。</p><h5><a href="#zui-kai-shi-wo-de-chang-shi" class="header-anchor">#</a><span id="zui-kai-shi-wo-de-chang-shi">最开始我的尝试</span></h5><p>在这之前，我先按照自己的想法去实现外置SSD安装win10。刚开始想，我之前制作了启动盘，那么我直接从启动盘启动以后把win10选择外置SSD不就行了吗。直到我进行到那一步的时候才发现，win10为了各方面原因是阻止你将系统安装到外置磁盘上面的。</p><h5><a href="#zheng-que-an-zhuang-bu-zou" class="header-anchor">#</a><span id="zheng-que-an-zhuang-bu-zou">正确安装步骤</span></h5><p>这里有个视频演示了整个过程，不熟悉的可以先看下这个视频。</p><p><a href="https://9to5mac.com/2017/08/31/how-windows-10-mac-boot-camp-external-drive-video/" target="_blank" rel="external">https://9to5mac.com/2017/08/31/how-windows-10-mac-boot-camp-external-drive-video/</a></p><p><a href="https://www.youtube.com/watch?v=kR28kVtZYJY&amp;feature=youtu.be" target="_blank" rel="external">https://www.youtube.com/watch?v=kR28kVtZYJY&amp;feature=youtu.be</a></p><p>前提准备：</p><ul><li>win10镜像</li><li>vmware虚拟机或移动硬盘</li><li><a href="http://www.easyuefi.com/wintousb/" target="_blank" rel="external">WinToUSB</a></li><li>WindowsSupport驱动（通过BootCamp下载）</li><li>有线鼠标和键盘（设置win10的时候由于没有驱动，键盘和触控板不能识别）</li></ul><p>下面说下大概需要哪些步骤去完成：</p><ul><li>用虚拟机或者其他win电脑用WinToUSB去制作WINTOGO启动盘，这里WinToUSB使用简单就不再介绍，选择对应的win10镜像文件和外置SSD磁盘等待制作完成就行。</li><li>这里将下载的WindowsSupport复制进上面的WINTOGO启动盘之中或者等安装完以后用其他硬盘拷贝到win10中然后安装驱动也行。</li><li>到这一步直接重启按住option选择WINTOGO启动盘安装win10系统就行，整个过程就是需要连接有线鼠标和键盘。</li><li>当进入win10系统以后，由于没有驱动，导致蓝牙、wifi等等都不能工作。这时候选择WindowsSupport里面的驱动安装重启以后一切都正常了。</li></ul><h5><a href="#wai-zhi-ssd-an-zhuang-win10-shi-yong-gan-shou" class="header-anchor">#</a><span id="wai-zhi-ssd-an-zhuang-win10-shi-yong-gan-shou">外置SSD安装win10使用感受</span></h5><p>首先使用上面来说和内置的磁盘差别不大，依然很流畅。但有以下优势，随身携带了一个系统，只要有一台电脑立马能进入你的工作环境；与内置系统有很好的独立性，且不用担心内置系统和外置系统磁盘空间大小。</p><p>如果说缺点的话就是外置SSD与电脑是用有线连接，存在误触导致系统可能发生panic。不过就三星T5来看，连接的数据线还是比较牢固的。整个三种方式安装来了，我选择了最后这种。满足了性能，独立，空间等方方面面的优势。建议有这方面需求的都采用外置SSD来安装运行win10。</p><h4><a href="#wai-zhi-ssd-ying-pan-an-zhuang-macos-he-win10-shuang-xi-tong" class="header-anchor">#</a><span id="wai-zhi-ssd-ying-pan-an-zhuang-macos-he-win10-shuang-xi-tong">外置SSD硬盘安装macOS和win10双系统</span></h4><p>前面提到，我在买来的三星T5上面装了win10系统，但是整个500G用来只装win10始终觉得有点浪费。于是想着能不能在外置SSD上装双系统。刚开始以为很简单，结果这里坑很多也很大。如果你对磁盘分区，引导系统等不是很熟悉的话，建议一定要谨慎操作并做好数据备份。</p><h5><a href="#zhun-bei-tiao-jian" class="header-anchor">#</a><span id="zhun-bei-tiao-jian">准备条件</span></h5><ul><li>win10镜像</li><li>一台win电脑（最好不要用虚拟机，虚拟机操作很卡很慢）</li><li>一台mac电脑</li><li>两个外置硬盘，一个SSD用作装装系统，一个用作制作引导盘和数据传输（建议使用一般机械硬盘即可，容量大一点）。</li><li>一个macOS系统引导盘</li><li><a href="http://www.easyuefi.com/wintousb/" target="_blank" rel="external">WinToUSB</a> 用作制作win10系统外置SSD引导盘。</li><li><a href="http://www.diskgenius.cn/download.php" target="_blank" rel="external">diskgenius</a> 这个工具十分重要，没有这个磁盘工具无法完成。用作各种细腻化磁盘分区管理</li><li>有线鼠标和键盘（设置win10的时候由于没有驱动，键盘和触控板不能识别）</li><li>WindowsSupport驱动（通过BootCamp下载）</li></ul><h5><a href="#zui-chu-xiang-fa-he-chang-shi" class="header-anchor">#</a><span id="zui-chu-xiang-fa-he-chang-shi">最初想法和尝试</span></h5><ul><li><p>先装win10，失败</p><p>最开始的我想法就是先直接在移动SSD上面装一个win10，然后再进行分区（exFAT、APFS或者其他mac上能识别挂载的文件系统都行）。接着再回到macOS中，用磁盘工具抹掉并设置为APFS格式的分区。这样在用系统引导盘去安装的时候选择该分区不就行了。</p><p>失败原因：在这样操作的时候，回到macOS对这个分区进行格式化的时候会出现错误，而且那个win10系统也不能引导了，原因在于会将win10系统前面的引导分区覆盖。</p></li><li><p>先装macOS，失败</p><p>上面的方案失败以后我就尝试先装macOS，装macOS就十分简单，直接将整个磁盘格式化为APFS格式，然后分一个exFAT或者NTFS的区留着装win10。装macOS就直接用引导盘然后选择APFS那个分区安装就可以了。接下来就回到win系统中，用WinToUSB工具安装win10，然而这个工具并不能按照磁盘分区来进行安装，最小单位是磁盘设备，也就是说，这样会将整个磁盘都格式化安装为win10，这样做的话前面安装的macOS系统就会被删除。</p><p>失败原因：WinToUSB按磁盘设备而不是磁盘分区来安装的win10。</p></li></ul><h5><a href="#zui-zhong-jie-jue-fang-an" class="header-anchor">#</a><span id="zui-zhong-jie-jue-fang-an">最终解决方案</span></h5><p>根据前面的失败情况，理性分析了一下，在没有更好的工具替换WinToUSB的情况下，要想实现在移动SSD安装双系统，只能先装win10。但是前面先装win10却失败了，下面经过大量的尝试，找出了一个很大的坑，也找出了失败的原因。</p><p>装完win10以后，如果你分一个APFS区到mac上面抹掉的时候，出现不能win10不能引导以及磁盘不能挂载的原因是，macOS挂载APFS分区的时候是需要一个200M的EFI分区进行引导。这个是mac系统独有的，在win上面挂载分区是不需要这玩意的。所以出现前面问题的原因是，由于需要200M的EFI引导分区，所以抹掉的时候会将win10的引导分区给覆盖掉，从而导致不能启动win10。而为什么自身的APFS也不能挂载，是因为前面的win10引导分区只有100M，小于200M，所以APFS分区也不能挂载。</p><p>弄清楚原因以后，那么现在就好办了。按照以下步骤</p><ul><li>先用WinToUSB安装win10</li><li>然后用diskgenius备份win10的引导分区，等装完macOS以后再写回去。</li><li>用diskgenius创建一个APFS或者其他mac上能识别的分区。（大小就为磁盘的一半，后面会在上面装macOS）</li><li>然后用diskgenius调整win10前面的EFI引导分区大小，这里只要大于200M都行。此步需要十分谨慎，建议不熟悉的先搜索相关资料，对整个有一个清晰的了解以后再动手。</li><li>接下来回到mac系统中，用磁盘工具抹掉APFS分区，这样这个分区就能挂载了</li><li>随后用引导盘安装macOS系统到这个分区上面，此时的win10还是不能启动的。</li><li>macOS系统装完以后，在回到win系统，将前面备份的win10引导分区数据用diskgenius复制到前面的EFI分区之中。</li><li>重启电脑，验证两个系统是否都能正常启动即可。</li></ul><p>这里说了安装过程中遇到的问题以及解决方法，但没有用截图或者更加详细的步骤。主要还是提供了在外置SSD上安装双系统的思路，如果后面有时间的话，会将整个过程以截图的方式详细的介绍出来。我个人建议就是对磁盘分区和系统引导不是很熟悉的新手来说，建议先不要尝试这种方案，等你熟悉或者我写了更详细的步骤以后再进行尝试。</p><h4><a href="#win10-xia-ida-qi-dong-shi-bai-de-jie-jue-fang-an" class="header-anchor">#</a><span id="win10-xia-ida-qi-dong-shi-bai-de-jie-jue-fang-an">win10下IDA启动失败的解决方案</span></h4><ul><li><p>无法启动IDA，缺少相关DLL</p><p>在安装完win10以后，打开IDA会提示相关的DLL无法找到。这里提供了dll缺失文件下载地址以及Windows 10上msvcp140.dll缺少问题的解决办法。</p><ul><li><p><a href="https://cn.dll-files.com/" target="_blank" rel="external">https://cn.dll-files.com/</a></p></li><li><p><a href="http://www.win10jihuoma.com/archives/8183" target="_blank" rel="external">http://www.win10jihuoma.com/archives/8183</a></p></li></ul></li><li><p>启动后某些DLL加载失败</p><p>在启动IDA的时候我还遇到一个错误是无法加载ida目录下plugins下的DLL，提示跟多<code>._</code>开头的DLL文件加载失败，这些文件是mac系统记录的元数据文件，大小都在4k左右，肯定不能加载。删除了loader  proc 和plugins下面的这些文件就正常了。关于这些文件的解释看<a href="https://zhuanlan.zhihu.com/p/37221636" target="_blank" rel="external">这里</a>。其他IDA启动问题可以看下面官方的文档</p><p><a href="https://www.hexblog.com/?p=1132" target="_blank" rel="external">https://www.hexblog.com/?p=1132</a></p></li></ul><h4><a href="#can-kao" class="header-anchor">#</a><span id="can-kao">参考</span></h4><ul><li><a href="https://apple.stackexchange.com/questions/304623/bootcamp-problem-unable-to-partition-the-disk" target="_blank" rel="external">https://apple.stackexchange.com/questions/304623/bootcamp-problem-unable-to-partition-the-disk</a></li><li><a href="https://www.microsoft.com/zh-cn/software-download/windows10ISO" target="_blank" rel="external">https://www.microsoft.com/zh-cn/software-download/windows10ISO</a></li><li><a href="https://www.hongkiat.com/blog/bootcamp-assistant-cannot-partition/" target="_blank" rel="external">https://www.hongkiat.com/blog/bootcamp-assistant-cannot-partition/</a></li><li><a href="http://www.win10jihuoma.com/archives/category/win10zhuanyeban" target="_blank" rel="external">http://www.win10jihuoma.com/archives/category/win10zhuanyeban</a></li><li><a href="https://discussions.apple.com/thread/6832480" target="_blank" rel="external">https://discussions.apple.com/thread/6832480</a></li><li><a href="https://medium.com/@svenkirsime/install-windows-on-the-external-ssd-hdd-for-your-mac-5d29eefe5d1" target="_blank" rel="external">https://medium.com/@svenkirsime/install-windows-on-the-external-ssd-hdd-for-your-mac-5d29eefe5d1</a></li><li><a href="https://www.cnblogs.com/lonecloud/p/7107063.html" target="_blank" rel="external">https://www.cnblogs.com/lonecloud/p/7107063.html</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3&gt;&lt;a href=&quot;#mac-an-zhuang-win10-wan-zheng-zhi-nan&quot; class=&quot;header-anchor&quot;&gt;#&lt;/a&gt;&lt;span id=&quot;mac-an-zhuang-win10-wan-zheng-zhi-nan&quot;&gt;Mac安装Win10完
      
    
    </summary>
    
      <category term="wiki" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/categories/wiki/"/>
    
    
      <category term="wiki" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/wiki/"/>
    
      <category term="windows" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/windows/"/>
    
  </entry>
  
  <entry>
    <title>iOS12内存patch remap bug分析</title>
    <link href="https://github.com/4ch12dy/4ch12dy.github.io.git/2019/08/16/iOS12-remap-bug-analyze/iOS12-remap-bug-analyze/"/>
    <id>https://github.com/4ch12dy/4ch12dy.github.io.git/2019/08/16/iOS12-remap-bug-analyze/iOS12-remap-bug-analyze/</id>
    <published>2019-08-15T16:22:28.000Z</published>
    <updated>2019-09-21T17:31:17.000Z</updated>
    
    <content type="html"><![CDATA[<h2><a href="#ios12-nei-cun-patch-remap-bug-fen-xi" class="header-anchor">#</a><span id="ios12-nei-cun-patch-remap-bug-fen-xi">iOS12内存patch remap bug分析</span></h2><blockquote><p>之前在做LLDB中的内存patch的时候提到在iOS12(包括iOS11)上面remap会出现bug的问题，一直相当困扰。其他hook框架都能在最新越狱上面正常patch，为什么我写的就不行？所以这篇文章准备一探究竟，<del>但是目前我也还么搞清楚原因。</del>（2019/09/04终于搞清楚了原因）不过这里会先分析最新系统上面两种hook框架对于inlinehook的原理及其相关细节。先看下他们的hook框架是如何实现内存patch和hook的。</p></blockquote><h3><a href="#ios12-mshookfunction-fen-xi-coolstar-yue-yu-gong-ju" class="header-anchor">#</a><span id="ios12-mshookfunction-fen-xi-coolstar-yue-yu-gong-ju">iOS12 MSHookFunction分析(CoolStar越狱工具)</span></h3><blockquote><p>环境：iPhoneXS A12 iOS12 jailbreak by Chimera</p></blockquote><p>在iOS12越狱上面<code>CydiaSubstrate</code>指向的是<code>libsubstrate.dylib</code></p><p><code>/Library/Frameworks/CydiaSubstrate.framework/CydiaSubstrate -&gt; ../../../usr/lib/libsubstrate.dylib</code></p><p>我们常用的<code>MSHookFunction</code>函数的实现就是在<code>libsubstrate.dylib</code>这里面，不过在这里仅仅是<code>SubHookFunction</code>的封装。而<code>SubHookFunction</code>的实现却是在<code>/usr/lib/libsubstitute.0.dylib</code>这里</p><p><code>/usr/lib/libsubstitute.0.dylib</code>是一个软连接指向<code>libsubstitute.dylib</code>。这里的<code>libsubstitute.dylib</code>就是coolstar维护的版本。下面分析<code>libsubstitute.dylib</code>的inlinehook实现细节。</p><p>下面是我写的一个tweak插件代码（<del>没错就是破解Filza的，不过只是部分代码</del>），hook了<code>_ZTL7624417887</code>函数。</p><pre><code class="c">static BOOL (*original_ZTL7624417887)(int a1, int a2, int a3); BOOL new_ZTL7624417887(int a1, int a2, int a3){    NSLog(@&quot;====xxxx===hook ZTL7624417887---&gt;%d&quot;, 0);    return 0;}%ctor{        MSImageRef  image =  MSGetImageByName(&quot;/Applications/Filza.app/Filza&quot;);    NSLog(@&quot;===xxx===image:%p&quot;, image);    void* ZTL7624417887 = (void*)MSFindSymbol(image, &quot;_ZTL7624417887&quot;);    NSLog(@&quot;===xxx===ZTL7624417887:%p&quot;, ZTL7624417887);    MSHookFunction((void*)ZTL7624417887, (void*)new_ZTL7624417887, (void**)&amp;original_ZTL7624417887);}</code></pre><p><strong>调试分析</strong></p><p>对<code>MSHookFunction</code>下断点，发现断在了我们预想的位置。</p><pre><code>CydiaSubstrate`MSHookFunction:-&gt;  0x10550fca0 &lt;+0&gt;:  cbz    x0, 0x10550fca8           ; &lt;+8&gt;    0x10550fca4 &lt;+4&gt;:  b      0x10550fe80               ; symbol stub for: SubHookFunction    0x10550fca8 &lt;+8&gt;:  ret</code></pre><pre><code>(lldb) re re General Purpose Registers:        x0 = 0x000000010489a068  Filza`ZTL7624417887        x1 = 0x00000001055bbbec  xkfilza.dylib`new_ZTL7624417887(int, int, int) at Tweak.xm:19        x2 = 0x00000001055bc148  xkfilza.dylib`original_ZTL7624417887</code></pre><pre><code>* frame #0: 0x000000010550fca0 CydiaSubstrate`MSHookFunction    frame #1: 0x00000001055bbcd0 xkfilza.dylib`_logosLocalCtor_9eb4d9ed(argc=1, argv=0x000000016b657b50, envp=0x000000016b657b60) at Tweak.xm:29    frame #2: 0x00000001055df56c dyld`ImageLoaderMachO::doModInitFunctions(ImageLoader::LinkContext const&amp;) + 424    frame #3: 0x00000001055df7ac dyld`ImageLoaderMachO::doInitialization(ImageLoader::LinkContext const&amp;) + 40</code></pre><p>X0就是hook的函数地址，X1为替换的函数地址，X2为保存的原函数地址。</p><p>先看一下这三个地址的数据，如下所见，此时<code>ZTL7624417887</code>还没有hook，所以前几个指令没有变化。</p><pre><code>// ZTL7624417887 函数指令(lldb) x/5i 0x000000010489a068    0x10489a068: 0xd2800008   mov    x8, #0x0    0x10489a06c: 0xf0003489   adrp   x9, 1683    0x10489a070: 0x911a4129   add    x9, x9, #0x690            ; =0x690     0x10489a074: 0xb868792a   ldr    w10, [x9, x8, lsl #2]    0x10489a078: 0x6b00015f   cmp    w10, w0// new_ZTL7624417887 函数指令(lldb) x/5i 0x00000001055bbbec    0x1055bbbec: 0xd503237f   pacibsp     0x1055bbbf0: 0xd100c3ff   sub    sp, sp, #0x30             ; =0x30     0x1055bbbf4: 0xa9027bfd   stp    x29, x30, [sp, #0x20]    0x1055bbbf8: 0x910083fd   add    x29, sp, #0x20            ; =0x20     0x1055bbbfc: 0xb81fc3a0   stur   w0, [x29, #-0x4]// original_ZTL7624417887 是一个函数指针(lldb) x/5g 0x00000001055bc1480x1055bc148: 0x0000000000000000 0x00000000000000000x1055bc158: 0x0000000000000000 0x00000000000000000x1055bc168: 0x0000000000000000</code></pre><p>这里是我们单步执行两次，使其执行hook函数。这次再观察一下这三个地址的数据</p><pre><code>// ZTL7624417887 函数指令(lldb) x/5i 0x000000010489a068    0x10489a068: 0xb0006911   adrp   x17, 3361    0x10489a06c: 0x912fb231   add    x17, x17, #0xbec          ; =0xbec     0x10489a070: 0xd61f0220   br     x17    0x10489a074: 0xb868792a   ldr    w10, [x9, x8, lsl #2]    0x10489a078: 0x6b00015f   cmp    w10, w0// new_ZTL7624417887 函数指令(lldb) x/5i 0x00000001055bbbec    0x1055bbbec: 0xd503237f   pacibsp     0x1055bbbf0: 0xd100c3ff   sub    sp, sp, #0x30             ; =0x30     0x1055bbbf4: 0xa9027bfd   stp    x29, x30, [sp, #0x20]    0x1055bbbf8: 0x910083fd   add    x29, sp, #0x20            ; =0x20     0x1055bbbfc: 0xb81fc3a0   stur   w0, [x29, #-0x4]// original_ZTL7624417887 是一个函数指针(lldb) x/5g 0x00000001055bc1480x1055bc148: 0x0000000106e38000 0x00000000000000000x1055bc158: 0x0000000000000000 0x00000000000000000x1055bc168: 0x0000000000000000</code></pre><p>这里发现原函数前三个字节和<code>original_ZTL7624417887</code>这个函数指令数据都发生了变化。</p><pre><code class="assembly">0x10489a068: 0xb0006911   adrp   x17, 33610x10489a06c: 0x912fb231   add    x17, x17, #0xbec          ; =0xbec 0x10489a070: 0xd61f0220   br     x17</code></pre><p>这三条指令就是将原始执行流跳转到其他地址（这里也可以发现hook的函数至少大于3条指令，不然会覆盖其他函数）。这里简单计算就可以算出X17目标地址</p><pre><code>(lldb) p/x (0x10489a068 &amp; ~(0x1000-0x1))+ (3361&lt;&lt;12) + 0xbec(long) $3 = 0x00000001055bbbec</code></pre><p>所以会跳转到<code>0x00000001055bbbec</code>这个地址，等等！这个地址不就是<code>new_ZTL7624417887</code>我们hook代码的函数地址吗？所以函数hook就是通过修改前三条指令跳转到我们定义的函数来实现hook的。</p><p>这里还有个问题在于，如果我们在hook代码里面需要执行原函数，那么<code>original_ZTL7624417887</code>处保存的又是什么函数指针？所以这里跟一下<code>0x0000000106e38000</code>这个地址。</p><pre><code>(lldb) x/12i 0x0000000106e38000    0x106e38000: 0xd2800008   mov    x8, #0x0    0x106e38004: 0xd29a0009   mov    x9, #0xd000    0x106e38008: 0xf2a09e49   movk   x9, #0x4f2, lsl #16    0x106e3800c: 0xf2c00029   movk   x9, #0x1, lsl #32    0x106e38010: 0x911a4129   add    x9, x9, #0x690            ; =0x690     0x106e38014: 0xd0fed311   adrp   x17, -9630    0x106e38018: 0x9101d231   add    x17, x17, #0x74           ; =0x74     0x106e3801c: 0xd61f0220   br     x17</code></pre><p>这里可以看出也是一个跳转，可以计算出X17跳转后的地址</p><pre><code>(lldb) p/x (0x106e38014 &amp; ~(0x1000-0x1)) - (9630&lt;&lt;12) + 0x74(long) $4 = 0x000000010489a074</code></pre><p>再等等！这个地址不就是<code>ZTL7624417887</code>函数的第四条指令的地址吗，跳转到这里正好调用了原函数，但是有个问题在于，原函数的前三条指令去哪了？仔细观察上面的指令和原函数的前三条指令</p><pre><code>//原函数前三条指令0x10489a068: 0xd2800008   mov    x8, #0x00x10489a06c: 0xf0003489   adrp   x9, 16830x10489a070: 0x911a4129   add    x9, x9, #0x690            ; =0x690// original_ZTL7624417887函数指针的指令0x106e38000: 0xd2800008   mov    x8, #0x00x106e38004: 0xd29a0009   mov    x9, #0xd0000x106e38008: 0xf2a09e49   movk   x9, #0x4f2, lsl #160x106e3800c: 0xf2c00029   movk   x9, #0x1, lsl #320x106e38010: 0x911a4129   add    x9, x9, #0x690            ; =0x690</code></pre><p>稍加思索就知道，虽然指令不一样，但是结果却是一样的。为什么不直接写入原三条指令呢？这里涉及到<code>adrp</code>这个指令的相对寻址问题。由于<code>adrp</code>会根据当前pc值来计算，这样直接复制的话pc值已经变化，所以这里不得不重新计算X9的值。到这里，<code>MSHookFunction</code>的hook过程我们已经完全清楚了。</p><h3><a href="#ios12-mshookfunction-fen-xi-unc0ver-yue-yu-gong-ju" class="header-anchor">#</a><span id="ios12-mshookfunction-fen-xi-unc0ver-yue-yu-gong-ju">iOS12 MSHookFunction分析(unc0ver越狱工具)</span></h3><blockquote><p>环境：iPhone6+ iOS12 jailbreak by unc0ver</p></blockquote><p>由于saurik不给CoolStar的越狱工具提供substrate和cydia的支持，导致现在越狱工具出现了两种hook框架。以Coolstar团队基于开源代码substitute和pwn20wnd团队的substrate两种hook框架。上面分析了substitute的hook原理。下面分析substrate的hook相关细节。这里多说两句，关于整个事件，可以访问CoolStar的博客<a href="https://coolstarorg.tumblr.com/" target="_blank" rel="external">https://coolstarorg.tumblr.com/</a>他介绍了整个事件以及自己开发移植substitute的完整过程。我个人来说，还是十分崇拜CoolStar那份创新和坚持。自己动手完成了最新越狱的substitute移植，tweak注入，以及Sileo的开发。在这中间的过程，正如他在博客里面提到的那样，十分曲折，令人佩服。</p><p>在unc0ver中有如下dylib和hook相关</p><pre><code>/usr/lib/substrate/SubstrateInserter.dylib/usr/lib/libsubstrate.dylib/Library/MobileSubstrate/MobileSubstrate.dylib/Library/Caches/cy-8lteBy.dylib</code></pre><p>作为对比，这里同样以上面的tweak代码为例，hook了<code>_ZTL7624417887</code>函数。</p><pre><code class="c">static BOOL (*original_ZTL7624417887)(int a1, int a2, int a3); BOOL new_ZTL7624417887(int a1, int a2, int a3){    NSLog(@&quot;====xxxx===hook ZTL7624417887---&gt;%d&quot;, 0);    return 0;}%ctor{        MSImageRef  image =  MSGetImageByName(&quot;/Applications/Filza.app/Filza&quot;);    NSLog(@&quot;===xxx===image:%p&quot;, image);    void* ZTL7624417887 = (void*)MSFindSymbol(image, &quot;_ZTL7624417887&quot;);    NSLog(@&quot;===xxx===ZTL7624417887:%p&quot;, ZTL7624417887);    MSHookFunction((void*)ZTL7624417887, (void*)new_ZTL7624417887, (void**)&amp;original_ZTL7624417887);}</code></pre><p><strong>调试分析</strong></p><p>对<code>MSHookFunction</code>下断点，发现断在了如下位置</p><pre><code>// 调用栈*libsubstrate.dylib`MSHookFunction SubstrateInserter.dylib`___lldb_unnamed_symbol6$$SubstrateInserter.dylib + 76 cy-8lteBy.dylib`ImageLoaderMachO::doModInitFunctions(ImageLoader::LinkContext const&amp;) + 412 cy-8lteBy.dylib`ImageLoaderMachO::doInitialization(ImageLoader::LinkContext const&amp;) + 36//下面可以看出来是hook了posix_spawn这个函数x0 = 0x00000001be287310  libsystem_kernel.dylib`posix_spawnx1 = 0x000000010194a4c0  SubstrateInserter.dylib`___lldb_unnamed_symbol2x2 = 0x0000000101950258</code></pre><p>这里可以暂时不用管，同样下面的hook函数都忽略先。</p><pre><code>//================================ execve ========================================//调用栈*libsubstrate.dylib`MSHookFunction SubstrateInserter.dylib`___lldb_unnamed_symbol6$$SubstrateInserter.dylib + 100 cy-8lteBy.dylib`ImageLoaderMachO::doModInitFunctions(ImageLoader::LinkContext const&amp;) + 412 cy-8lteBy.dylib`ImageLoaderMachO::doInitialization(ImageLoader::LinkContext const&amp;) + 36//下面可以看出来是hook了execve这个函数x0 = 0x00000001be290034  libsystem_kernel.dylib`execvex1 = 0x000000010194a4fc  SubstrateInserter.dylib`___lldb_unnamed_symbol3x2 = 0x0000000101950260  //================================ __vfork ========================================//调用栈*libsubstrate.dylib`MSHookFunction cy-8lteBy.dylib`ImageLoaderMachO::doModInitFunctions(ImageLoader::LinkContext const&amp;) + 412 cy-8lteBy.dylib`ImageLoaderMachO::doInitialization(ImageLoader::LinkContext const&amp;) + 36//下面可以看出来是hook了__vfork这个函数x0 = 0x00000001be28fa80  libsystem_kernel.dylib`__vforkx1 = 0x000000010194a5d4  SubstrateInserter.dylib`___lldb_unnamed_symbol4x2 = 0x0000000101950268</code></pre><p>通过上面可以看出，substrate会hook一些多进程启动相关的函数。这里我们都暂时不用分析，进行执行就到了我们自己写的hook点。</p><pre><code>x0 = 0x0000000100f52068  Filza`ZTL7624417887x1 = 0x0000000104a3fba4  xkfilza.dylib`new_ZTL7624417887(int, int, int) at Tweak.xm:19x2 = 0x0000000104a40148  xkfilza.dylib`original_ZTL7624417887libsubstrate.dylib`MSHookFunction:-&gt;  0x101d244dc &lt;+0&gt;:   stp    x29, x30, [sp, #-0x10]!    0x101d244e0 &lt;+4&gt;:   mov    x29, sp    0x101d244e4 &lt;+8&gt;:   stp    x20, x19, [sp, #-0x10]!    0x101d244e8 &lt;+12&gt;:  stp    x22, x21, [sp, #-0x10]!    0x101d244ec &lt;+16&gt;:  sub    sp, sp, #0x20             ; =0x20     0x101d244f0 &lt;+20&gt;:  mov    x21, x2    0x101d244f4 &lt;+24&gt;:  mov    x19, x1    0x101d244f8 &lt;+28&gt;:  mov    x20, x0    0x101d244fc &lt;+32&gt;:  cbz    x20, 0x101d24514          ; &lt;+56&gt;    0x101d24500 &lt;+36&gt;:  mov    x1, #0x0    0x101d24504 &lt;+40&gt;:  mov    x0, x19    0x101d24508 &lt;+44&gt;:  bl     0x101d29150               ; symbol223$$libsubstrate.dylib    0x101d2450c &lt;+48&gt;:  cmp    x0, #0x0                  ; =0x0     0x101d24510 &lt;+52&gt;:  csel   x19, x0, x19, ne    0x101d24514 &lt;+56&gt;:  adrp   x8, 265    0x101d24518 &lt;+60&gt;:  add    x8, x8, #0x498            ; =0x498     0x101d2451c &lt;+64&gt;:  ldrb   w8, [x8]    0x101d24520 &lt;+68&gt;:  cbz    w8, 0x101d24538           ; &lt;+92&gt;    0x101d24524 &lt;+72&gt;:  str    x19, [sp]    0x101d24528 &lt;+76&gt;:  adr    x1, #0xc8d10              ; &quot;  &lt;=  %p&quot;    0x101d2452c &lt;+80&gt;:  nop        0x101d24530 &lt;+84&gt;:  orr    w0, wzr, #0x2    0x101d24534 &lt;+88&gt;:  bl     0x101d10ad4               ; symbol80$$libsubstrate.dylib    0x101d24538 &lt;+92&gt;:  adrp   x8, 240    0x101d2453c &lt;+96&gt;:  add    x8, x8, #0xa80            ; =0xa80     0x101d24540 &lt;+100&gt;: add    x8, x8, #0x10             ; =0x10     0x101d24544 &lt;+104&gt;: stp    x21, x8, [sp, #0x8]    0x101d24548 &lt;+108&gt;: cmp    x21, #0x0                 ; =0x0     0x101d2454c &lt;+112&gt;: add    x8, sp, #0x8              ; =0x8     0x101d24550 &lt;+116&gt;: csel   x8, xzr, x8, eq    0x101d24554 &lt;+120&gt;: str    x8, [sp, #0x18]    0x101d24558 &lt;+124&gt;: mov    x0, #0x0    0x101d2455c &lt;+128&gt;: add    x4, sp, #0x10             ; =0x10     0x101d24560 &lt;+132&gt;: mov    x1, x20    0x101d24564 &lt;+136&gt;: mov    x2, x20    0x101d24568 &lt;+140&gt;: mov    x3, x19    0x101d2456c &lt;+144&gt;: bl     0x101d23f3c                           ;&lt;----------------hook实现函数    0x101d24570 &lt;+148&gt;: sub    sp, x29, #0x20            ; =0x20     0x101d24574 &lt;+152&gt;: ldp    x22, x21, [sp], #0x10    0x101d24578 &lt;+156&gt;: ldp    x20, x19, [sp], #0x10    0x101d2457c &lt;+160&gt;: ldp    x29, x30, [sp], #0x10    0x101d24580 &lt;+164&gt;: ret</code></pre><p>从这里就可以看出和substitute的差别还是挺大的。先看下hook前三个地址的数据情况</p><pre><code>// ZTL7624417887 函数指令(lldb) x/5i 0x0000000100f52068    0x100f52068: 0xd2800008   mov    x8, #0x0    0x100f5206c: 0xf0003489   adrp   x9, 1683    0x100f52070: 0x911a4129   add    x9, x9, #0x690            ; =0x690     0x100f52074: 0xb868792a   ldr    w10, [x9, x8, lsl #2]    0x100f52078: 0x6b00015f   cmp    w10, w0// new_ZTL7624417887 函数指令(lldb) x/5i 0x0000000104a3fba4    0x104a3fba4: 0xd100c3ff   sub    sp, sp, #0x30             ; =0x30     0x104a3fba8: 0xa9027bfd   stp    x29, x30, [sp, #0x20]    0x104a3fbac: 0x910083fd   add    x29, sp, #0x20            ; =0x20     0x104a3fbb0: 0xb81fc3a0   stur   w0, [x29, #-0x4]    0x104a3fbb4: 0xb81f83a1   stur   w1, [x29, #-0x8]// original_ZTL7624417887 是一个函数指针(lldb) x/5g 0x0000000104a401480x104a40148: 0x0000000000000000 0x00000000000000000x104a40158: 0x0000000000000000 0x00000000000000000x104a40168: 0x0000000000000000</code></pre><p>下面我们执行完这个函数，再观察hook以后三个地址的数据情况</p><pre><code>// ZTL7624417887 函数指令(lldb) x/10i 0x0000000100f52068    0x100f52068: 0x58000050   ldr    x16, #0x8                 ; &lt;+8&gt;    0x100f5206c: 0xd61f0200   br     x16    0x100f52070: 0x7ff00040   .long  0x7ff00040                ; unknown opcode    0x100f52074: 0x00000001   .long  0x00000001                ; unknown opcode    0x100f52078: 0x6b00015f   cmp    w10, w0    0x100f5207c: 0x540000c0   b.eq   0x100f52094               ; &lt;+44&gt;    0x100f52080: 0x91000508   add    x8, x8, #0x1              ; =0x1     0x100f52084: 0xf100311f   cmp    x8, #0xc                  ; =0xc     0x100f52088: 0x54ffff69   b.ls   0x100f52074               ; &lt;+12&gt;    0x100f5208c: 0x52800008   mov    w8, #0x0// new_ZTL7624417887 函数指令(lldb)  x/5i 0x0000000104a3fba4    0x104a3fba4: 0xd100c3ff   sub    sp, sp, #0x30             ; =0x30     0x104a3fba8: 0xa9027bfd   stp    x29, x30, [sp, #0x20]    0x104a3fbac: 0x910083fd   add    x29, sp, #0x20            ; =0x20     0x104a3fbb0: 0xb81fc3a0   stur   w0, [x29, #-0x4]    0x104a3fbb4: 0xb81f83a1   stur   w1, [x29, #-0x8]// original_ZTL7624417887 是一个函数指针(lldb) x/5g 0x0000000104a401480x104a40148: 0x0000000104a53fe8 0x00000000000000000x104a40158: 0x0000000000000000 0x00000000000000000x104a40168: 0x0000000000000000</code></pre><p>这里可以发现，和substitute一样，原函数ZTL7624417887和original_ZTL7624417887函数都发生了变化，但是ZTL7624417887的改动却不一样。substrate这里首先占用了四条指令大小（这里也可以知道用substate进行hook的时候函数至少满足4个字节），其中后两条指令其实是存得一个地址占用8个字节。</p><pre><code>(lldb) x/g 0x100f520700x100f52070: 0x000000017ff00040</code></pre><p>按地址大小解析出来，目标跳转的地址为<code>0x000000017ff00040</code>现在去看下这个地址里面是什么</p><pre><code>(lldb) x/12i 0x000000017ff00040    0x17ff00040: 0x10020010   adr    x16, #0x4000    0x17ff00044: 0xa9404610   ldp    x16, x17, [x16]    0x17ff00048: 0xd61f0220   br     x17    0x17ff0004c: 0xd503201f   nop        0x17ff00050: 0x10020010   adr    x16, #0x4000    0x17ff00054: 0xa9404610   ldp    x16, x17, [x16]    0x17ff00058: 0xd61f0220   br     x17    0x17ff0005c: 0xd503201f   nop        0x17ff00060: 0x10020010   adr    x16, #0x4000    0x17ff00064: 0xa9404610   ldp    x16, x17, [x16]    0x17ff00068: 0xd61f0220   br     x17    0x17ff0006c: 0xd503201f   nop</code></pre><p>这里可以发现又会进行一些跳转</p><pre><code>(lldb) p/x 0x17ff00040+0x4000(long) $2 = 0x000000017ff04040(lldb) x/5g 0x000000017ff040400x17ff04040: 0x0000000000000000 0x0000000104a3fba4</code></pre><p>这里计算出来<code>X16=0 X17=0x0000000104a3fba4</code>所以这里会跳转到<code>0x0000000104a3fba4</code>这个地址。等下！这个地址不就是new_ZTL7624417887的地址吗，这样进过两次跳转就跳到了我们写的hook函数了，完成了对原函数的hook。下面再分析如何又执行原函数，分析original_ZTL7624417887函数数据</p><pre><code>(lldb) x/12i 0x0000000104a53fe8    0x104a53fe8: 0xd2800008   mov    x8, #0x0    0x104a53fec: 0x580000e9   ldr    x9, #0x1c    0x104a53ff0: 0x911a4129   add    x9, x9, #0x690            ; =0x690     0x104a53ff4: 0xb868792a   ldr    w10, [x9, x8, lsl #2]    0x104a53ff8: 0x58000050   ldr    x16, #0x8    0x104a53ffc: 0xd61f0200   br     x16    0x104a54000: 0x00f52078   .long  0x00f52078                ; unknown opcode    0x104a54004: 0x00000001   .long  0x00000001                ; unknown opcode</code></pre><p>从上面可以发现前四条指令正是原函数new_ZTL7624417887的前四条指令等价指令，然后再进行跳转</p><pre><code>0x104a53ff8: 0x58000050   ldr    x16, #0x80x104a53ffc: 0xd61f0200   br     x160x104a54000: 0x00f52078   .long  0x00f52078                ; unknown opcode0x104a54004: 0x00000001   .long  0x00000001                ; unknown opcode(lldb) x/g 0x104a540000x104a54000: 0x0000000100f52078</code></pre><p>这里跳转的地址就是原函数new_ZTL7624417887的第五条指令地址，这样整个调用原函数的过程就结束了。</p><h3><a href="#vm-remap-nei-cun-bug-yuan-yin-yi-ji-jie-jue-ban-fa" class="header-anchor">#</a><span id="vm-remap-nei-cun-bug-yuan-yin-yi-ji-jie-jue-ban-fa">vm_remap内存bug原因以及解决办法</span></h3><p>这个bug困扰了我3周，内心相当难受，每天一有时间就会来尝试解决这个问题。frida、substitute、substrate都能够在iOS11/12上面进行代码段patch。为什么我写的代码就会有问题。</p><p>正如前面的那样，我尝试去分析substitute和substrate进行patch相关的细节，无论从闭源的substrate逆向分析，还是开源的substitute源码分析。最开始以为是代码签名问题，但在这两个框架中都没发现和代码签名相关的代码，于是转向frida，果然发现了很多和运行时内存页签名的代码。于是我以为我找到原因了，很可能就是代码签名的问题了，在这期间阅读了frida很多相关代码，也把iOS上的代码签名机制重新学习了一遍。就这样一直进入了代码前面的坑里面，甚至想去研究下remap对应的内核代码，到底是什么原因。</p><p>由于还是感觉还是没有找到问题的关键，于是我再从新回头过来思考iOS inlinehook本身，再次goolge搜索关键字，如果这是一个通用的问题那么理论上应该能搜到相关的资料。原本是想搜iOS inlinehook在各系统版本上面的差异变化。不巧搜到了一个别人抽离substitute的hook代码，由于直接抽离了出来，所以在Xcode中十分方便调试。于是抱着试一试的心态重新分析substitute的代码，结果我发现居然这个hook代码能够在iOS12上面进行代码patch。这就很有意思了，这说明CoolStar并不是进行了其他hack操作才能进行hook。就是原本substitute就能正常patch。这样就消除了我之前认为是越狱开发者从内核层面给hook框架提供的支持。接下来我决定一步步的跟下去，看代码patch那里到底和我写的代码差异在哪里。后面发现我的内存页大小居然和substitute里面的页大小不一致。我定义了页大小为4K也就是0x1000，而substitute为16K即0x4000。其实内存页大小这部分代码我也是参考别人写的代码，那代码是2019年作者能够正常运行，应该没问题的。因为目前iOS的设备32位基本淘汰了，然而那个代码定义的页大小就是32位设备上的4K，我手里的设备都是64位的，如果按照32位的4K去分配以及其他操作肯定会出问题。这和我之前remap后的内存错误也对应上来了，之前全部覆盖为0数据的大小正式4K的4倍，也就是一个64位上的16K内存页大小。最后我把内存页大小改为16K以后再次运行发现这次没有崩溃了，再检查一下patch的地址是否修改以及运行是否符合预期，发现一切都正常工作。</p><p>找到原因以后，我把xia0LLDB中的debugme的内存页大小改为16K以后再测试，发现在iOS12上就能够正常的反反调试了。到这里，困扰了我这么久的问题终于得到了解决，也给我以后分析bug有一定启示，很多时候我们先要对整个运行过程以及基本原理要足够了解，这里就因为我理所当然的认为那个代码在内存页大小这个问题上不会有问题，所以也没有仔细去查看是否正确，从而导走偏了方向。</p><h3><a href="#ios-unc0vers-inlinehook-shi-bai-yuan-yin-fen-xi-2019-09-19" class="header-anchor">#</a><span id="ios-unc0vers-inlinehook-shi-bai-yuan-yin-fen-xi-2019-09-19">iOS unc0vers inlinehook失败原因分析(2019/09/19)</span></h3><p>日志：</p><pre><code class="c">sub_1D124() callsub_13B2C() call__int64 MSServerPort(){  char *v0; // x0  int v1; // w20  v0 = **_NSGetArgv();  if ( v0 &amp;&amp; !strcmp(v0, &quot;/usr/libexec/substrated&quot;) )    return 0LL;  if ( !dword_12D524 || (v1 = dword_12D528, v1 != getpid()) )  {    dword_12D524 = sub_1425C();    dword_12D528 = getpid();  }  return (unsigned int)dword_12D524;}</code></pre><pre><code class="c">v3 = bootstrap_look_up(special_port, &quot;cy:com.saurik.substrated&quot;, &amp;sp);</code></pre><p>mobilesubstrate deb包的目录结构</p><pre><code>xia0 ~/xia0/iOSRE/research/iOS11-12-CodePatch-vm_remap-bug/Undecimus.app/apt $ dpkg -X mobilesubstrate_0.9.7033_iphoneos-arm.deb ./extract././Library/./Library/Frameworks/./Library/Frameworks/CydiaSubstrate.framework/./Library/Frameworks/CydiaSubstrate.framework/Headers/./Library/Frameworks/CydiaSubstrate.framework/Info.plist./Library/MobileSubstrate/./Library/MobileSubstrate/DynamicLibraries/./usr/./usr/bin/./usr/bin/cycc./usr/bin/cynject./usr/include/./usr/include/substrate.h./usr/lib/./usr/lib/cycript0.9/./usr/lib/cycript0.9/com/./usr/lib/cycript0.9/com/saurik/./usr/lib/cycript0.9/com/saurik/substrate/./usr/lib/cycript0.9/com/saurik/substrate/MS.cy./usr/lib/libsubstrate.dylib./usr/lib/substrate/./usr/lib/substrate/SubstrateBootstrap.dylib./usr/lib/substrate/SubstrateInserter.dylib./usr/lib/substrate/SubstrateLoader.dylib./usr/libexec/./usr/libexec/substrate./usr/libexec/substrated./Library/Frameworks/CydiaSubstrate.framework/CydiaSubstrate./Library/Frameworks/CydiaSubstrate.framework/Headers/CydiaSubstrate.h./Library/MobileSubstrate/MobileSubstrate.dylib</code></pre><h4><a href="#can-kao" class="header-anchor">#</a><span id="can-kao">参考</span></h4><ul><li><a href="https://github.com/coolstar/electra/issues/233">https://github.com/coolstar/electra/issues/233</a></li><li><a href="https://github.com/coolstar/electra/blob/master/docs/getting-started.md#platformizing-a-binary">https://github.com/coolstar/electra/blob/master/docs/getting-started.md#platformizing-a-binary</a></li><li><a href="https://github.com/ipasimulator/lldb">https://github.com/ipasimulator/lldb</a></li><li><a href="https://github.com/BishopFox/bfinject">https://github.com/BishopFox/bfinject</a></li><li><a href="https://coolstarorg.tumblr.com/" target="_blank" rel="external">https://coolstarorg.tumblr.com/</a></li><li><a href="http://www.newosxbook.com/articles/CodeSigning.pdf" target="_blank" rel="external">http://www.newosxbook.com/articles/CodeSigning.pdf</a></li><li><a href="https://github.com/frida/frida-gum/commit/30deb2c29f060948407b585c4b23475ea60b965b">https://github.com/frida/frida-gum/commit/30deb2c29f060948407b585c4b23475ea60b965b</a></li><li><a href="https://github.com/Siguza/ios-resources/blob/master/bits/arm64.md">https://github.com/Siguza/ios-resources/blob/master/bits/arm64.md</a></li><li><a href="https://github.com/comex/substitute/blob/master/lib/darwin/execmem.c">https://github.com/comex/substitute/blob/master/lib/darwin/execmem.c</a></li><li><a href="https://github.com/anahadaw/iOS_Hook">https://github.com/anahadaw/iOS_Hook</a></li><li><a href="https://forums.developer.apple.com/thread/47532" target="_blank" rel="external">https://forums.developer.apple.com/thread/47532</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2&gt;&lt;a href=&quot;#ios12-nei-cun-patch-remap-bug-fen-xi&quot; class=&quot;header-anchor&quot;&gt;#&lt;/a&gt;&lt;span id=&quot;ios12-nei-cun-patch-remap-bug-fen-xi&quot;&gt;iOS12内存patch 
      
    
    </summary>
    
      <category term="RE" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/categories/RE/"/>
    
    
      <category term="RE" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/RE/"/>
    
      <category term="hook" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/hook/"/>
    
  </entry>
  
  <entry>
    <title>iOS LLDB中反反调试分析与实现</title>
    <link href="https://github.com/4ch12dy/4ch12dy.github.io.git/2019/08/12/xia0lldb-anti-anti-debug/xia0lldb-anti-anti-debug/"/>
    <id>https://github.com/4ch12dy/4ch12dy.github.io.git/2019/08/12/xia0lldb-anti-anti-debug/xia0lldb-anti-anti-debug/</id>
    <published>2019-08-12T11:16:01.000Z</published>
    <updated>2019-09-04T08:31:03.000Z</updated>
    
    <content type="html"><![CDATA[<h3><a href="#ios-lldb-zhong-fan-fan-diao-shi-fen-xi-yu-shi-xian" class="header-anchor">#</a><span id="ios-lldb-zhong-fan-fan-diao-shi-fen-xi-yu-shi-xian">iOS LLDB中反反调试分析与实现</span></h3><h4><a href="#kai-shi" class="header-anchor">#</a><span id="kai-shi">开始</span></h4><p>关于反调试和反反调试，已经有很多人分析过了，也有很多解决方案。但是在LLDB中做反反调试还没人做过，这也是我一直想解决的一个方案，毕竟本身就是为了调试，那么在LLDB直接输入一行命令就能反反调试应该相对酸爽。本文将介绍一种基于内存单指令patch的方式进行反反调试的方案，大概意思就是通过直接修改代码段的指令来绕过反调试机制。</p><h4><a href="#mu-qian-fan-diao-shi-yu-fan-fan-diao-shi-qing-kuang" class="header-anchor">#</a><span id="mu-qian-fan-diao-shi-yu-fan-fan-diao-shi-qing-kuang">目前反调试与反反调试情况</span></h4><p>这里庆哥写了一遍文章分析了 <a href="http://iosre.com/t/topic/8179" target="_blank" rel="external">关于反调试&amp;反反调试那些事</a></p><p>这里简单归纳一下，有如下几种：</p><ul><li>ptrace</li><li>sysctl</li><li>syscall</li><li>SIGTOP</li><li>task_get_exception_ports</li></ul><p>这里实际上就大概三种，其他都是基于ptrace的变种。ptrace这个函数是linux就提供的一个接口，常常用作linux系的反调试，本质就是通过26号系统调用来完成的，目前大多反调试都利用该方案。</p><p>后面看到庆哥同样提供了一个反反调试的LLDB脚本，不过看了下和我的思路还是不一样的。（<del>差点以为白做了）</del></p><p>正如文章里面写到通过<code>lldb</code>下断点，然后修改参数，或者直接返回也可以达到反反调试的效果。由于要不断去检查执行状态等，或者程序有定时器定时检测，这个脚本影响性能及变得很卡影响调试体验。不过还是膜庆哥的方案，学习了。</p><h4><a href="#nei-cun-patch-shi-xian-fan-fan-diao-shi" class="header-anchor">#</a><span id="nei-cun-patch-shi-xian-fan-fan-diao-shi">内存patch实现反反调试</span></h4><p>说一下大概思路：</p><ul><li>内存中找到<code>ptrace</code>地址</li><li>将该内存map为<code>rwx</code></li><li><p>直接将首调指令修改为<code>ret</code>指令</p><p>刚开始以为就这样简单就完了，结果实际写代码的时候才发现过程远比想象中复杂。</p></li></ul><p>由于iOS不允许直接将代码段map为写权限，这里调用<code>mach_vm_protect</code>或<code>mprotect</code>都会异常。但是类似frida、substitute以及hookzz都能进行指令hook。这样说来，肯定是可以修改代码段的。看了下substitute以及frida中关于这块的实现，才发现可以用一种remap的方式修改代码段。</p><p>大致的流程如下：</p><ul><li>使用mmap新建一块内存，把这块内存叫做new</li><li>使用vm_copy把想要篡改的处于__text段内的内存（把这块内存叫target）拷贝到new里</li><li>向new里写入想执行的代码</li><li>调用mprotect把new改为rx。因为mmap出来的内存的max_protection是rwx，所以这里mprotect改权限没问题</li><li>调用mach_vm_remap把new的内容反映回target里</li></ul><p>不过当我写代码测试的时候发现，remap以后整个页数据都变成了0。实在不清楚原因，向Zz求助，Zz直接扔了我他实现这块的代码。我看了以后收益匪浅，只怪之前没分析hookzz的具体实现。后面才知道由于我的设备是iOS12，Zz意思是codesign的问题，hookZz也没支持。于是换了一台iOS9的设备，果然就可以了，向Zz低头。</p><p>期间还由于我手残忘记调用mprotect把new改为rx。导致直接执行异常，用<code>memory region</code>查看地址才知道页保护属性为<code>rw</code>。</p><p>相关代码如下：</p><p>1、map new page for patch</p><pre><code class="c">    // map new page for patch    void *new = mmap(0, PAGE_SIZE, PROT_READ | PROT_WRITE, MAP_ANON | MAP_SHARED, -1, 0);    if (!new ){        NSLog(@&quot;[-] mmap failed!&quot;);        return;    }    NSLog(@&quot;[*] new map address:%p&quot;, new);</code></pre><p>2、start patch</p><pre><code class="c">    // start patch        kret = vm_copy(self_task, (unsigned long)page_start, PAGE_SIZE, (vm_address_t) new);    if (kret != KERN_SUCCESS){        NSLog(@&quot;[-] kr: %d, errno: %d&quot;, kret, errno);        return;    }    char patch_ret_ins_data[4] = {0xc0, 0x03, 0x5f, 0xd6}; // ret     memcpy((void *)(new+patch_offset), patch_ret_ins_data, 4);    NSLog(@&quot;[*] new map+offset address:%p&quot;, (void *)(new+patch_offset));</code></pre><p>3、set new page back to r-x</p><pre><code class="c">    // set back to r-x    int ret = mprotect(new, PAGE_SIZE, PROT_READ | PROT_EXEC);    NSLog(@&quot;[*] ret: %d, errno: %d, addr: %p&quot;, ret, errno, new);</code></pre><p>4、remap the target page</p><pre><code class="c">    kret = mach_vm_remap(mach_task_self(), &amp;target, PAGE_SIZE, 0,                       VM_FLAGS_OVERWRITE, self_task,                       (mach_vm_address_t) new, TRUE,                       &amp;c, &amp;m, inherit);    if(kret != KERN_SUCCESS){        NSLog(@&quot;[-] kr: %d, errno: %d&quot;, kret, errno);        return;    }    NSLog(@&quot;[*] now ptrace_ptr address:%p&quot;, ptrace_ptr)</code></pre><p>5、clear cache</p><pre><code class="c">    void* clear_start_ = (void*)page_start + patch_offset;  sys_icache_invalidate (clear_start_, 4);  sys_dcache_flush (clear_start_, 4);</code></pre><p>完整的代码在xia0LLDB里面已经集成：<a href="https://github.com/4ch12dy/xia0LLDB">https://github.com/4ch12dy/xia0LLDB</a></p><h4><a href="#yi-ge-jian-dan-fan-fan-diao-shi-shi-yan" class="header-anchor">#</a><span id="yi-ge-jian-dan-fan-fan-diao-shi-shi-yan">一个简单反反调试实验</span></h4><p>这里以爱奇艺为例子分析，爱奇艺在main函数里面动态调用了ptrace函数进行反调试。</p><ul><li><p>后台启动方式启动爱奇艺</p><pre><code class="shell">xia0 ~ $ issh debug -x backboard /var/containers/Bundle/Application/F9D8AACA-30F0-4F26-96CA-5B06782CC903/iQiYiPhoneVideo.app/iQiYiPhoneVideo[I]:iproxy process for 2222 port alive, pid=16264 [I]:++++++++++++++++++ Nice to Work :) +++++++++++++++++++++ [I]:iOSRE dir exist [I]:iproxy process for 1234 port alive, pid=16428 [I]:Run ps -e | grep debugserver | grep -v grep; [[ 0 == 0 ]] &amp;&amp; (killall -9 debugserver 2&gt; /dev/null) [I]:/iOSRE/tools/debugserver file exist, Start debug... [I]:Run /iOSRE/tools/debugserver 127.0.0.1:1234 -x backboard /var/containers/Bundle/Application/F9D8AACA-30F0-4F26-96CA-5B06782CC903/iQiYiPhoneVideo.app/iQiYiPhoneVideo</code></pre></li><li><p>LLDB挂上以后在main函数下断点以后直接执行<code>debugme</code>命令</p><pre><code>(lldb) debugmeKill antiDebug by xia0:[*] ptrace target address: 0x1837dc180 and offset: 0x180[*] mmap new page: 0x1021ec000 success. [+] vm_copy target to new page.[+] patch ret[0xc0 0x03 0x5f 0xd6] with memcpy[*] set new page back to r-x success![*] get page info done.[+] remap to target success![*] clear cache success![+] all done! happy debug~</code></pre><p>下面查看对比下patch前后指令ptrace首指令的变化</p><p>Patch之前</p><pre><code>(lldb) x/12i 0x00000001837dc180    0x1837dc180: 0xf00f26a9   adrp   x9, 124119    0x1837dc184: 0x91034129   add    x9, x9, #0xd0             ; =0xd0     0x1837dc188: 0xb900013f   str    wzr, [x9]    0x1837dc18c: 0xd2800350   mov    x16, #0x1a    0x1837dc190: 0xd4001001   svc    #0x80    0x1837dc194: 0x540000c3   b.lo   0x1837dc1ac               ; &lt;+44&gt;    0x1837dc198: 0xa9bf7bfd   stp    x29, x30, [sp, #-0x10]!    0x1837dc19c: 0x910003fd   mov    x29, sp    0x1837dc1a0: 0x97ff9b08   bl     0x1837c2dc0               ; cerror    0x1837dc1a4: 0x910003bf   mov    sp, x29    0x1837dc1a8: 0xa8c17bfd   ldp    x29, x30, [sp], #0x10    0x1837dc1ac: 0xd65f03c0   ret</code></pre><p>Patch之后</p><pre><code>(lldb) x/12i 0x1837dc180    0x1837dc180: 0xd65f03c0   ret        0x1837dc184: 0x91034129   add    x9, x9, #0xd0             ; =0xd0     0x1837dc188: 0xb900013f   str    wzr, [x9]    0x1837dc18c: 0xd2800350   mov    x16, #0x1a    0x1837dc190: 0xd4001001   svc    #0x80    0x1837dc194: 0x540000c3   b.lo   0x1837dc1ac               ; &lt;+44&gt;    0x1837dc198: 0xa9bf7bfd   stp    x29, x30, [sp, #-0x10]!    0x1837dc19c: 0x910003fd   mov    x29, sp    0x1837dc1a0: 0x97ff9b08   bl     0x1837c2dc0               ; cerror    0x1837dc1a4: 0x910003bf   mov    sp, x29    0x1837dc1a8: 0xa8c17bfd   ldp    x29, x30, [sp], #0x10    0x1837dc1ac: 0xd65f03c0   ret</code></pre><p>可以发现首地址已经变成了ret指令。</p></li><li><p>执行continue命令，发现爱奇艺已经能够正常调试。</p><pre><code>(lldb) cProcess 3176 resuming2019-08-13 17:22:17.283 iQiYiPhoneVideo[3176:161840] [plcrash]: init ok2019-08-13 17:22:17.790 iQiYiPhoneVideo[3176:161840] -[QYBaikePageDurationManager bk_appDidBecomeActive:]2019-08-13 17:22:17.922 iQiYiPhoneVideo[3176:161840] CoreData: Failed to load optimized model at path &#39;/var/containers/Bundle/Application/F9D8AACA-30F0-4F26-96CA-5B06782CC903/iQiYiPhoneVideo.app/QYPGCDataModel.momd/QYPGCDataModel_970.omo&#39;2019-08-13 17:22:20.477 iQiYiPhoneVideo[3176:161840] OSStatus error: [-34018] Security error has occurred.2019-08-13 17:22:20.558 iQiYiPhoneVideo[3176:162000] OSStatus error: [-34018] Security error has occurred.3176:161840] Incorrect NSStringEncoding value 0x8000100 detected. Assuming NSASCIIStringEncoding. Will stop this compatiblity mapping behavior in the near future.ontainers/Data/Application/5C31FE18-9BA4-4B2D-80C6-68BF7F65855F/Library/Application Support/爱奇艺/0_im.sqlite</code></pre></li></ul><h4><a href="#zong-jie-todo" class="header-anchor">#</a><span id="zong-jie-todo">总结/Todo</span></h4><p>这里只是简单的绕过了ptrace方式的反调试，针对直接用汇编写的反调试我的做法是静态内存搜索匹配svc位置，发现是调用26号系统调用则利用内存patch为nop。或者写一个简单的hook代码，hook所有的svc地址，判断寄存器的值然后进行hook即可，这样就能绕过这些反调试机制，再次向Zz和庆哥低头。</p><h4><a href="#can-kao-zhi-xie" class="header-anchor">#</a><span id="can-kao-zhi-xie">参考/致谢</span></h4><ul><li><p><a href="https://gist.github.com/piaoger/4ba83f6a954bca113505" target="_blank" rel="external">https://gist.github.com/piaoger/4ba83f6a954bca113505</a></p></li><li><p><a href="https://github.com/comex/substitute/blob/master/lib/darwin/execmem.c">https://github.com/comex/substitute/blob/master/lib/darwin/execmem.c</a></p></li><li><p><a href="https://www.codercto.com/a/63507.html" target="_blank" rel="external">https://www.codercto.com/a/63507.html</a></p></li><li><p><a href="https://github.com/jmpews/HookZz/blob/dev/srcxx/UserMode/ExecMemory/code-patch-tool-darwin.cc#L26">https://github.com/jmpews/HookZz/blob/dev/srcxx/UserMode/ExecMemory/code-patch-tool-darwin.cc#L26</a></p></li><li><p><a href="https://github.com/gdbinit/readmem/blob/master/readmem/main.c">https://github.com/gdbinit/readmem/blob/master/readmem/main.c</a></p></li><li><p><a href="https://github.com/frida/frida-gum/blob/master/gum/backend-darwin/machexc.h">https://github.com/frida/frida-gum/blob/master/gum/backend-darwin/machexc.h</a></p></li><li><p><a href="http://newosxbook.com/src.jl?tree=xnu&amp;file=/libsyscall/mach/mach_vm.c" target="_blank" rel="external">http://newosxbook.com/src.jl?tree=xnu&amp;file=/libsyscall/mach/mach_vm.c</a></p></li><li><p><a href="https://github.com/DaKnOb/memscan/blob/master/main.mm">https://github.com/DaKnOb/memscan/blob/master/main.mm</a></p></li><li><p><a href="http://iosre.com/t/topic/8179" target="_blank" rel="external">http://iosre.com/t/topic/8179</a></p></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3&gt;&lt;a href=&quot;#ios-lldb-zhong-fan-fan-diao-shi-fen-xi-yu-shi-xian&quot; class=&quot;header-anchor&quot;&gt;#&lt;/a&gt;&lt;span id=&quot;ios-lldb-zhong-fan-fan-diao-shi-fen-x
      
    
    </summary>
    
      <category term="RE" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/categories/RE/"/>
    
    
      <category term="RE" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/RE/"/>
    
      <category term="LLDB" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/LLDB/"/>
    
  </entry>
  
  <entry>
    <title>Android应用安装过程深度解析</title>
    <link href="https://github.com/4ch12dy/4ch12dy.github.io.git/2019/08/01/android-apk-install-process/android-apk-install-process/"/>
    <id>https://github.com/4ch12dy/4ch12dy.github.io.git/2019/08/01/android-apk-install-process/android-apk-install-process/</id>
    <published>2019-08-01T07:08:31.000Z</published>
    <updated>2019-08-01T10:29:23.000Z</updated>
    
    <content type="html"><![CDATA[<h3><a href="#android-ying-yong-an-zhuang-guo-cheng-shen-du-jie-xi" class="header-anchor">#</a><span id="android-ying-yong-an-zhuang-guo-cheng-shen-du-jie-xi">Android应用安装过程深度解析</span></h3><blockquote><p>本文由我和willing对整个安装过程的原理梳理，感谢willing精心的绘图以及相关源码整理。</p></blockquote><h4><a href="#kai-shi" class="header-anchor">#</a><span id="kai-shi">开始</span></h4><p>关于对Android应用的安装过程梳理，是因为很多重打包的外挂利用系统矫正器来绕过安卓系统的签名校验。为了分析其原理，详细分析了Android应用安装的过程，找到其中签名校验的地方，进一步做一些对抗和检测。</p><h4><a href="#zheng-ti-liu-cheng" class="header-anchor">#</a><span id="zheng-ti-liu-cheng">整体流程</span></h4><p>一个 Android 应用安装到手机上大致分为四种情形：</p><ul><li>系统应用，在设备每次启动时完成安装</li><li>通过 adb install 命令安装</li><li>应用市场安装，封装安装过程（略）</li><li>第三方应用安装或双击安装包，会启动系统应用引导安装</li></ul><p>无论采用哪种安装方式，最终的安装过程都会走到 PackageManagerService，由这个类来完成一系列的工作。PackageManagerService 实际上是一个系统服务，负责提供系统上所有应用的管理，包括安装、优化、查询和卸载，这个类最终会通过 socket 与 installd 这个守护进程通信，真实对应用进行操作的其实是由 installd 这个进程完成。</p><h4><a href="#chang-jing-yi-xi-tong-ying-yong-an-zhuang" class="header-anchor">#</a><span id="chang-jing-yi-xi-tong-ying-yong-an-zhuang">场景一：系统应用安装</span></h4><p>在设备启动时，Linux 系统的用户空间进程 init （pid = 1）会孵化许多子进程，包括一系列守护进程，其中就有上面提到的 installd，然后会孵化许多重要的系统服务，如 servicemanager，这个进程会负责管理所有服务的 Binder 通信，最后 init 还会孵化 zygote 进程，这个进程是第一个 Java 进程，zygote 进程会孵化出许多应用程序进程，包括 launcher 进程，即桌面进程，zygote 还会孵化出 system_server 进程，负责启动和管理 Framework 的 Java 层服务，包括 PackageManagerService、ActivityManagerService 等。</p><p><img src="https://github.com/4ch12dy/4ch12dy.github.io/blob/master/articlePic/android-apk-install-process/image-20190801151901799.png?raw=true" alt="image-20190801151901799"></p><p><strong>补充：system_server 的启动与运行流程</strong></p><p>system_server 由 zygote 进程孵化，是整个 Android Framework 的基础</p><p>zygote 启动阶段会调用 forkSystemServer() 创建子进程 system_server</p><p><img src="https://github.com/4ch12dy/4ch12dy.github.io/blob/master/articlePic/android-apk-install-process/image-20190801152013042.png?raw=true" alt="image-20190801152013042"></p><p>ForkAndSpecializeCommon 函数中完成进程创建工作并返回，两次返回，pid=0 时为子进程，pid&gt;0 时为父进程。onZygoteInit() 回调的实现在在 app_main.cpp 中，会调用 ProcessState::self() 初始化 binder 的交互操作，然后调用 proc-&gt;startThreadPool() 创建 binder 线程进行通信</p><p>RuntimeInit 的 findStaticMain() 调用 com.android.server.SystemServer 的 main 方法</p><p>SystemServer 的 run() 方法中会完成以下工作：</p><ul><li>设置时间、语言等，设置虚拟机库文件，设置内存</li><li>Looper.prepareMainLooper() 主线程 looper 运行在当前线程</li><li>加载库文件 android_servers，位于 /frameworks/base/services</li><li>createSystemContext() 初始化系统上下文</li><li>SystemServiceManager() 创建系统服务管理器，并添加到本地服务成员 LocalServices 中</li><li>启动各种系统服务，包括引导服务、核心服务、其他服务</li><li>开启循环，等待其他线程通过 handler 发送消息到主线程来处理</li></ul><p>在 system_server 进程启动过程中会启动各种系统服务，其中就包含 PackageManagerService</p><p><img src="https://github.com/4ch12dy/4ch12dy.github.io/blob/master/articlePic/android-apk-install-process/image-20190801152050671.png?raw=true" alt="image-20190801152050671"></p><p>PackageManagerService 类构造函数中完成了许多工作，主要包含：</p><ul><li>创建 Settings 对象，添加系统的 SharedUser 信息</li><li>为 Installer 对象赋值，赋值参数是在 system_server 进程中创建的</li><li>创建 PackageDexOptimizer 和 DexManager 对象</li><li>获取 SystemConfig 实例，获取系统的全局配置信息，如 GlobalGids、SystemPermissions、AvailableFeatures</li><li>创建 ServiceThread 和 PackagerHandler 对象</li><li>创建 UserManagerService，支持多用户</li><li>读取系统定义的权限保存到 permConfig 变量中</li><li>读取系统共享库保存到 libConfig 变量中</li><li>解析 package.xml 文件中的内容保存到 ArrayMap<string, packageparser.package=""> 结构中</string,></li><li>配置扫描参数 scanFlags</li><li>开始扫描系统应用，包括目录 /vender/overlay、/system/framework、/system/priv-app、/system/app、/vendor/app、/oem/app</li><li>开始扫描非系统应用，包括目录 /data/app、/data/app-private</li><li>启动内存垃圾回收</li><li>启动私有服务 PackageManagerInternal</li></ul><p>总结来说主要是这几项内容：</p><ul><li>创建了 Java 层 Installer 和 C 层 installd 之间的 socket 连接</li><li>扫描各目录下 apk文件完成安装（建立各安装包的配置结构信息，并添加到全局列表中进行管理）</li><li>创建了 PackageHandler 对象并建立消息循环，接收外部的安装请求</li><li>解析权限，建立底层 Linux Kernel 的用户机制和虚拟机层权限机制之间的映射</li></ul><p>详细说明各项：</p><p>Installer 是 PackageManagerService 的一个内部类，继承自SystemService，协助完成安装过程，主要是进行 apk 格式转换和数据目录建立，封装对文件和路径操作，真正的安装工作交由 IInstalld 内部类对象完成。</p><p><img src="https://github.com/4ch12dy/4ch12dy.github.io/blob/master/articlePic/android-apk-install-process/image-20190801152128607.png?raw=true" alt="image-20190801152128607"></p><p>Installer 在 SystemServer 中启动，通过 SystemServiceManager 的 startService(Installer.class) 启动。</p><p><img src="https://github.com/4ch12dy/4ch12dy.github.io/blob/master/articlePic/android-apk-install-process/image-20190801152145965.png?raw=true" alt="image-20190801152145965"></p><p>构造函数 Installer() 初始化 context 和 isolated（是否真正连接installd）成员变量</p><p>重写 onStart() 方法，基于 isolated 判断是否调用 connect() 进行连接</p><p>connect() 通过 ServiceManager 获取 installd 服务并拿到服务的本地代理放到成员变量 mInstalld 中</p><p>Installer 调用 dexopt() 最终调用了 mInstalld 的dexopt() 方法，其他方法类似，几乎就是一个 IInstalld 类的封装</p><p><strong>!!!!  Installer 的实现变化很大：6.0 上通过以命令的方式通过 execute 方法执行；8.1 通过 AIDL 接口实现</strong></p><p><strong>PackageManageService（system权限） 与 installd（root权限） 守护进程共同完成应用管理</strong></p><p>PackageManagerService 的构造函数中会扫描许多应用目录来安装 apk</p><p>包括：</p><ul><li>系统应用，目录有 <code>/vender/overlay</code>、<code>/system/framework</code>、<code>/system/priv-app</code>、<code>/system/app</code>、<code>/vendor/app</code>、<code>/oem/app</code></li><li>非系统应用，目录有 <code>/data/app</code>、<code>/data/app-private</code></li></ul><p>调用的方法是 <code>scanDirTracedLI()</code></p><p><img src="https://github.com/4ch12dy/4ch12dy.github.io/blob/master/articlePic/android-apk-install-process/image-20190801152328199.png?raw=true" alt="image-20190801152328199"></p><p>可以看到依次调用 scanDirLI()、scanPackageLI()、scanPackageInternalLI()</p><p>其中，scanDirLI() 调用了 ParallelPackageParser 类进行解析，从名字也能看出做了一些并行的优化处理，真正的工作还是交给 PackageParser 来完成，PackageParser 的 parsePackage() 方法内部完成了应用的解析，实际上是解析了 AndroidManifest.xml 文件里面各个标签，包括包名、版本、权限、各组件这些信息，最后的解析结果放在 PackageParser.Package 类中返回给 PMS，这样 PMS 就拥有应用的信息便与做各种管理</p><p>后面继续调用了 scanPackageLI() 和 scanPackageInternalLI() 是进一步检测应用是否需要更新，如果需要更新则接着调用 createInstallArgsForExisting() 构造安装参数开始安装（后面还会遇到这个函数，暂时不展开），安装涉及到的签名校验也是在这里，调用了 collectCertificatesLI()、compareSignatures() 等</p><h4><a href="#chang-jing-er-adb-ming-ling-an-zhuang" class="header-anchor">#</a><span id="chang-jing-er-adb-ming-ling-an-zhuang">场景二：adb 命令安装</span></h4><p>adb 是 Android SDK 提供的一个命令行工具，为客户端-服务器架构，服务端为移动端上运行的守护进程 adbd，与 installd 一样由 init 进程创建</p><p>源码路径为：<a href="http://androidxref.com/8.1.0_r33/xref/system/core/adb/" target="_blank" rel="external">http://androidxref.com/8.1.0_r33/xref/system/core/adb/</a></p><p><img src="https://github.com/4ch12dy/4ch12dy.github.io/blob/master/articlePic/android-apk-install-process/image-20190801152448109.png?raw=true" alt="image-20190801152448109"></p><p>adb_commandline() 函数接收 adb 命令行参数，调用 install_app() 执行安装流程，这个函数会对命令行做一些修改，实际上调用 pm 命令，并通过 send_shell_command() 将命令发送给 Pm 类。</p><p>Pm 启动函数 main 会构造 Pm 类对象并调用 run() 方法，在这个方法里首先会获取 PackageManger 服务 mPm，然后调用 getPackageInstaller() 获取 PackageInstaller 对象 mInstaller，最后基于不同的命令调用不同的方法。</p><p>runInstall() 里面会首先获取之前解析时设置的安装参数 InstallParams，然后依次调用 doCreateSession() 创建安装会话，doWriteSession() 会通过 IO 流将应用信息写入 PackageInstaller.Session 对象，doCommitSession() 会提交相应的会话启动安装，最后调用 abandonSession() 结束会话。</p><p><img src="https://github.com/4ch12dy/4ch12dy.github.io/blob/master/articlePic/android-apk-install-process/image-20190801152518924.png?raw=true" alt="image-20190801152518924"></p><p>PackageInstallerSession 的 commit() 方法首先将包信息封装到 PackageInstallObserverAdapter 这个类中，是 PackageInstallerService 的一个内部类，然后通过这个适配器获取 PackageInstallObserver2 对象代理，这是一个跨进程的观察者，接收安装状态的回调，最后用 Handler 的 obtainMessage 构造一个 MSG_COMMIT 类型的消息并发送出去。</p><p>发送的消息由 PackageInstallerService 的 Handler.Callback 接受，然后调用 commitLocked()，此方法最终会调用 PMS 的 installStage() 方法。</p><p>PackageInstallObserver2 对象接收到安装成功的回调时，会接着调用 PackageInstallerService 的 dispatchSessionFinished()，这个方法最后也是到了 PMS 里面调用 sendSessionCommitBroadcast() 方法。</p><h4><a href="#chang-jing-san-di-san-fang-ying-yong-an-zhuang" class="header-anchor">#</a><span id="chang-jing-san-di-san-fang-ying-yong-an-zhuang">场景三：第三方应用安装</span></h4><p>当下载一个新的应用包双击安装时，实际上是发送了一个 “android.intent.action.INSTALL_PACKAGE” 的 intent，这个时候会唤起 Android 系统的一个应用 PackageInstaller 来完成安装操作</p><p>PackageInstaller 的应用代码位于：<a href="http://androidxref.com/8.1.0_r33/xref/packages/apps/PackageInstaller/" target="_blank" rel="external">http://androidxref.com/8.1.0_r33/xref/packages/apps/PackageInstaller/</a></p><p>安装位置 /system/priv-app/GooglePackageInstaller，是一个 Android 系统默认应用程序，提供了用户界面来管理应用或包，用于安装普通文件</p><p><img src="https://github.com/4ch12dy/4ch12dy.github.io/blob/master/articlePic/android-apk-install-process/image-20190801152605993.png?raw=true" alt="image-20190801152605993"></p><p>应用双击安装后会唤起 PackageInstaller 应用，入口类为 InstallStart，onCreate() 首先被调用完成一些初始化过程，然后获取调用源做一些权限检查。</p><p>然后会调起 PackageInstallerActivity，onCreate() 会包括获取 PackageManager 和 PackageInstaller 对象，然后从 intent 中获取 mSessionId、packageUri、mOriginatingURI、mReferrerURI 这些与安装包相关的信息，接着调用 processPackageUri() 解析 uri，这里面会调用 PackageParser 去解析包，再接着会调用 bindUi() 完成安装主界面的展示和部件绑定，最后调用 checkIfAllowedAndInitiateInstall() 检查是否允许安装，如果允许，里面会继续调用 initiateInstall() 初始化安装，实际上这个函数是检查是否需要替换安装，最后调用 startInstallConfirm() 准备安装，设置 mOk 这个安装按钮为 true。</p><p>用户确认点击安装按钮后，调用 startInstall() 开始安装，这个函数里面又会构造一个 intent 传递必要的数据，开启 InstallInstalling 这个 activity。</p><p><img src="https://github.com/4ch12dy/4ch12dy.github.io/blob/master/articlePic/android-apk-install-process/image-20190801152635344.png?raw=true" alt="image-20190801152635344"></p><p>InstallInstalling 这个类会拿到应用数据开启真正的安装流程。</p><p>首先是 onCreate() 函数，首先从 Intent 中取出数据放到 ApplicationInfo 中，然后基于拿到的应用信息分两种情况：如果是更新，则调用 getPackageManager() 获取 PackageManager 然后调用 installExistingPackage() 安装，成功调用 launchSuccess() 方法，失败调用 launchFailure() 方法，launchSuccess 会构造 Intent 跳转到 InstallSuccess 类， launchFailure 则跳转到 InstallFailed 类；如果是新应用的安装，首先会向 InstallEventReceiver 注册一个安装结果监听的广播，成功调用 launchSuccess，失败调用 launchFailure。</p><p>接下来是 onStart() 方法，这里会依次调用 getPackageManager()，getPackageInstaller()，registerSessionCallback() 注册会话的回调。</p><p>最后是 onResume() 方法，这个方法里会获取 session 的相关信息，然后创建并执行 InstallingAsyncTask() 的安装服务，其中的 doInBackground() 方法会将应用信息通过 IO 流写入 PackageInstaller.Session 中，onPostExecute() 方法则构造一个 PendingIntent 并将它的 IntentSender 通过 PackageInstaller.Session 的 commit() 方法发送出去</p><p>这里就跟 adb 安装走到了同一个流程中。</p><h4><a href="#shen-ru-pms-zhong-de-an-zhuang" class="header-anchor">#</a><span id="shen-ru-pms-zhong-de-an-zhuang">深入 PMS 中的安装</span></h4><p>上面的后面两种场景最后都会通过 PackageInstallerSession 的 commit() 方法提交一个安装的会话，并且最终调用到了 PackageManagerService 的 installStage() 方法</p><p><img src="https://github.com/4ch12dy/4ch12dy.github.io/blob/master/articlePic/android-apk-install-process/image-20190801152711796.png?raw=true" alt="image-20190801152711796"></p><p>在 installStage() 里会基于传入的参数构造一个 InstallParams 对象，这个对象中包含安装包的所有数据，然后将这个对象作为消息内容，通过 mHandler 发送一个类型为 INIT_COPY 的消息。</p><p>所有类型的消息处理都在 PackageHandler 里，这个类会通过 Binder 与 system_server 创建的 ServiceThread 线程绑定，PackageHandler 负责分发任务，ServiceThread 负责处理任务。</p><p><strong>1、处理 INIT_COPY 消息</strong></p><p>首先从消息结构中取出前面封装好的 HandlerParams 对象，然后检查 mBound 标志判断是否绑定 DefaultContainerService，这个服务用于检查和复制文件，位于 com.android.defcontainer 进程，通过 IMediaContainerService 与PMS 通信，mBound 默认为 false，此时调用 connectToService() 来绑定服务，并获取当前索引值的 HandlerParams 对象添加到 mPendingInstalls 这个 HandlerParams 的 ArrayList 中，如果 mBound 为 true，即服务已经连接，则直接添加 HandlerParams 对象，并发送一个 MCS_BOUND 消息。</p><p><strong>2、处理 MCS_BOUND 消息</strong></p><p>首先检查 DefaultContainerService 服务连接没问题，就开始处理安装请求队列，从 mPendingInstalls 中取出 HandlerParams 对象并调用它的 startCopy() 方法。</p><p><img src="https://github.com/4ch12dy/4ch12dy.github.io/blob/master/articlePic/android-apk-install-process/image-20190801152741833.png?raw=true" alt="image-20190801152741833"></p><p>HandlerParams 是 PMS 中的抽象类，它的 startCopy() 会通过一个 mRetries 的私有变量检查尝试次数，超过4次则向 Handler 发送 MCS_GIVE_UP 的消息，抓到异常则发送 MCS_RECONNECT 的消息，成功则继续调用 handleStartCopy() 这个抽象方法，具体实现在 InstallParams 中，</p><p>InstallParams 的 handleStartCopy() 会首先是确定应用安装位置，是sd卡还是内部存储，并且做一些检查如位置冲突，空间够不够，然后通过 createInstallArgs() 创建 InstallArgs 类，然后调用这个类的 copyApk() 方法，InstallArgs 类也是抽象类，定义了应用包安装逻辑，子类包括 FileInstallArgs，处理 non-ASEC 应用，也即内部存储空间的应用， AsecInstallArgs 处理安装到 SD 卡中的应用，以及 MoveInstallArgs 处理已安装的应用，因此实际上是调用各自实例对象的 copyApk() 方法</p><p>以 FileInstallArgs 为例，copyApk() 方法会调用 doCopyApk()，在这个方法里会首先创建一个临时存储目录，然后调用 DefaultContainerService 的 copyPackage() 方法完成 apk 复制</p><p>HandlerParams 复制 apk 后会调用 handleReturnCode()，这个方法又会调用 processPendingInstall() 方法，最终会调用到 InstallArgs 的 doPreInstall() 完成安装前的清理工作，调用 installPackageTracedLI() 实现真正的安装，以及调用 InstallArgs 的 doPostInstall() 完成收尾的清理工作，最后发送一个类型为 POST_INSTALL 的消息</p><p><img src="https://github.com/4ch12dy/4ch12dy.github.io/blob/master/articlePic/android-apk-install-process/image-20190801152755489.png?raw=true" alt="image-20190801152755489"></p><p> installPackageTracedLI() 里面完成的是真正的安装操作，会依次进行变量初始化，再次解析应用包，获取签名信息，权限检查，安装路径重命名等等操作，最后根据参数有两种不同的处理方式，更新条件下的覆盖安装，调用 replacePackageLI() 方法，以及应用的首次安装，调用 installNewPackageLI() 方法</p><p>其中 replacePackageLI() 会首先清楚应用包的注册信息，然后类似 installNewPackageLI() 里面的流程重新安装更新的包，直接看  installNewPackageLI() 流程</p><p>installNewPackageLI() 里面调用 scanPackageTraceLI() 执行安装，然后这个函数里面又会继续调用 scanPackageInternalLI() 执行包解析，最后将 PackageParser.Package 对象返回出来，扫描完包之后就会调用 updateSettingsLI() 更新 Settings，也就是更新应用在 PMS 中的注册信息，会修改包括 packages.xml、package.list 等相关文件，如果安装成功则调用 prepareAppDataAfterInstallLIF() 来创建相关的数据目录，失败则执行回退操作 deletePackageLIF()</p><p><strong>3、处理 POST_INSTALL 消息</strong></p><p>首先从 mRunningInstalls 中拿到 PostInstallData 对象，mRunningInstalls 是 PostInstallData 格式的列表，在应用安装成功时构建，在安装完成后会调用 delete() 移除这一条记录，接下来取 PostInstallData 对象中的一些信息如安装参数，授予的权限等作为参数调用 handlePackagePostInstall() 执行安装完成的后续操作，包括授予权限，发送安装成功广播，发送启动广播等等</p><h4><a href="#an-zhuang-guo-cheng-xiao-jie" class="header-anchor">#</a><span id="an-zhuang-guo-cheng-xiao-jie">安装过程小结</span></h4><p>与应用相关的一些目录</p><ul><li><p>/system/priv-app：系统应用安装路径，Android 4.4+ 开始出现，区分系统应用权限，拥有 SignatureOrSystem 权限，此目录下的 service 具有保活能力</p></li><li><p>/system/app：系统应用安装路径，权限略低于 priv-app 目录下的应用，放置比如厂商内置应用</p></li><li><p>/data/app：用户应用安装路径，应用安装时将 apk 复制到此目录下</p></li></ul><ul><li><p>/data/data：用户应用数据存放路径，存在沙箱隔离</p></li><li><p>/data/dalvik-cache：存放应用的dex 文件</p></li><li><p>/data/system：存放应用安装相关文件</p><ul><li>packages.xml 是一个应用的注册表，在解析应用时创建，有变化时更新，记录系统权限，各应用信息，如name, codePath, flag, version, userid，下次开机时直接读取并添加到内存列表</li><li>package.list 指定应用的默认存储位置，userid 等</li></ul></li></ul><p>应用安装过程总结</p><ol><li>将应用 apk 拷贝到指定目录下</li><li>解压 apk，将 dex 文件拷贝到 /data/dalvik-cache 目录，创建 /data/data/<packagename> 数据目录</packagename></li><li>解析 AndroidManifest.xml 及其他资源文件，提取应用包信息，注册到 packags.xml 中</li><li>由 Launcher 进程通过 PMS 取出所有应用程序，展示在桌面上</li></ol><h4><a href="#pms-yu-pm-yu-apm" class="header-anchor">#</a><span id="pms-yu-pm-yu-apm">PMS 与 PM 与APM</span></h4><p>前面的一切分析都是围绕 PackageManagerService 来进行的，但是实际上平时开发过程中基本接触不到这个类，在用户层用得最多的应该是 PackageManager 这个类</p><p><img src="https://github.com/4ch12dy/4ch12dy.github.io/blob/master/articlePic/android-apk-install-process/image-20190801152858658.png?raw=true" alt="image-20190801152858658"></p><p>通常在用户层通过 Context 的 getPackageManager() 方法来获取 PackageManager 实例，Context 的 getPackageManager() 实现在 ContextImpl 里面，这个函数实际上返回的是一个 ApplicationPackageManager 对象，ApplicationPackageManager 类构造函数需要两个璨是，一个是 ContextImpl 自身，另一个是通过 ActivityThread 的 getPackageManager() 获取 IPackageManager 对象</p><p>ActivityThread 的 getPackageManager() 首先调用 ServiceManager 的 getService(“package”) 获取 IBinder 对象，然后通过 IPackageManger.Stub.asInterface(IBinder) 获取 IPackageManager 对象，实际上为这个对象的一个代理</p><p>继续梳理一下这个类与 PMS 之间的关系</p><p><img src="https://github.com/4ch12dy/4ch12dy.github.io/blob/master/articlePic/android-apk-install-process/image-20190801152915992.png?raw=true" alt="image-20190801152915992"></p><p>IPackageManager 使用了 Android 接口定义语言（AIDL）实现进程间通信，通过在 .aidl 后缀的文件中定义好接口，Android SDK 就会基于此文件自动生成一个 IBinder 接口的类，服务端实现这些接口，客户端则通过绑定到服务调用接口中定义的方法</p><p>IPackageManager 通过 AIDL 文件自动生成的一个接口类，继承自 IInterface</p><p>IPackageManager.Stub 是 IPackageManager 的内部类，继承自 Binder，实现 IPackageManager</p><ul><li>asInterface() 方法接受 IBinder 对象，转换成 IPackageManager 类型对象并返回，实际上返回的是 IPackageManager.Stub.Proxy 对象</li><li>asBinder() 方法返回自身，即 IPackageManager.Stub 对象</li><li>重写了 onTransact() 方法，根据命令类型处理数据传输</li></ul><p>IPackageManager.Stub.Proxy 是 IPackageManager.Stub 的内部类，实现了IPackageManager接口</p><ul><li>mRemote对象是IBinder类型，是对IPackageManager.Stub的引用</li><li>重写了asBinder()方法，返回mRemote</li><li>实现了AIDL文件定义的接口</li></ul><p>PackageManager 是系统提供的服务管理类，负责管理应用程序包的，包含以下功能：</p><ul><li>安装/卸载/更新应用，包括 installPackage/</li><li>查询已安装应用，通过 getInstalledPackages() 方法获取 PackageInfo 对象的列表</li><li>查询应用相关信息，通过 getPackageInfo() 方法获取 PackageInfo 对象</li><li>查询权限相关信息，通过 getPermissionInfo() 方法获取 PermissionInfo 对象</li><li>增加/删除权限，包括 addPermission/removePermission</li><li>清除用户数据/缓存/代码等</li></ul><p>PackageManager 是一个抽象类，定义了 IPackageManager 接口的子集</p><p>ApplicationPackageManager 是 PackageManager 的实现类，它继承了 PackageManager 并实现其所有抽象方法</p><p>PackageManagerService 继承了 IPackageManager.Stub</p><p>因此，总结来说就是，ApplicationPackageManager 是 AIDL 模型中 Binder 通信的客户端，PackageMangerService 就是服务端，客户端的所有的功能都是通过一个 IPackageManager 类型的成员变量去完成的，实际上这个变量就是 PackageManagerService 的一个代理，通过这个代理客户端可以调用到 PackageManagerService 中的一些方法</p><h4><a href="#can-kao" class="header-anchor">#</a><span id="can-kao">参考</span></h4><ul><li><a href="http://androidxref.com/8.1.0_r33/xref/" target="_blank" rel="external">http://androidxref.com/8.1.0_r33/xref/</a></li><li><a href="https://juejin.im/post/5b7e72bbe51d453894001ef0#heading-6" target="_blank" rel="external">https://juejin.im/post/5b7e72bbe51d453894001ef0#heading-6</a></li><li><a href="http://solart.cc/2016/10/30/install_apk/" target="_blank" rel="external">http://solart.cc/2016/10/30/install_apk/</a></li><li><a href="https://www.jianshu.com/p/4f16421d5c7f" target="_blank" rel="external">https://www.jianshu.com/p/4f16421d5c7f</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3&gt;&lt;a href=&quot;#android-ying-yong-an-zhuang-guo-cheng-shen-du-jie-xi&quot; class=&quot;header-anchor&quot;&gt;#&lt;/a&gt;&lt;span id=&quot;android-ying-yong-an-zhuang-guo-che
      
    
    </summary>
    
      <category term="wiki" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/categories/wiki/"/>
    
    
      <category term="RE" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/RE/"/>
    
      <category term="Android" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/Android/"/>
    
  </entry>
  
  <entry>
    <title>Arduino ESP8266开发板上手实践</title>
    <link href="https://github.com/4ch12dy/4ch12dy.github.io.git/2019/07/30/Arduino-ESP8266-bigstep/Arduino-ESP8266-bigstep/"/>
    <id>https://github.com/4ch12dy/4ch12dy.github.io.git/2019/07/30/Arduino-ESP8266-bigstep/Arduino-ESP8266-bigstep/</id>
    <published>2019-07-30T02:46:35.000Z</published>
    <updated>2019-08-09T08:47:21.000Z</updated>
    
    <content type="html"><![CDATA[<h3><a href="#arduino-esp8266-kai-fa-ban-shang-shou-shi-jian" class="header-anchor">#</a><span id="arduino-esp8266-kai-fa-ban-shang-shou-shi-jian">Arduino ESP8266开发板上手实践</span></h3><h4><a href="#huan-jing-da-jian-macos" class="header-anchor">#</a><span id="huan-jing-da-jian-macos">环境搭建（macOS）</span></h4><p>官方说明：<a href="https://github.com/esp8266/Arduino">https://github.com/esp8266/Arduino</a></p><ul><li><p><strong>安装IDE （Arduino IDE）</strong></p><p>下载地址：<a href="https://www.arduino.cc/en/main/software" target="_blank" rel="external">https://www.arduino.cc/en/main/software</a></p><p>还有种方式是利用<a href="https://github.com/plerup/makeEspArduino">Makefile</a>去做开发，这里先做个记录，说不定以后会用这个开发模式，毕竟可控性比较高。但目前还不是很熟悉，建议选择上面的IDE。</p></li></ul><ul><li><p><strong>下载ESP8266硬件包</strong></p><p>1 、在设置里面的附加板管理器网址中增加以下链接<code>https://arduino.esp8266.com/stable/package_esp8266com_index.json</code></p><p><img src="https://github.com/4ch12dy/4ch12dy.github.io/blob/master/articlePic/Arduino-ESP8266-bigstep/image-20190730143145367.png?raw=true" width="500" hegiht="313" align="center"></p><p>2、在工具中找到你的开发板，然后进入开发板管理器，搜索<strong>esp8266</strong>安装该库，我这里已经安装了。</p><p><img src="https://github.com/4ch12dy/4ch12dy.github.io/blob/master/articlePic/Arduino-ESP8266-bigstep/image-20190730143643887.png?raw=true" width="500" hegiht="313" align="center"></p><p>注意：如果这种方式安装不了，你可以选择下载软件包手动安装，这里不展开分析。参考<a href="https://github.com/esp8266/Arduino">这里</a></p></li><li><p><strong>运行示例代码</strong></p><p><img src="https://github.com/4ch12dy/4ch12dy.github.io/blob/master/articlePic/Arduino-ESP8266-bigstep/image-20190730144157955.png?raw=true" width="500" hegiht="313" align="center"></p><p>我这里打开Blink这个示例代码，这段代码很简单，就是控制LED灯的闪烁。</p><p>代码如下</p><pre><code class="c">/*  ESP8266 Blink by Simon Peter  Blink the blue LED on the ESP-01 module  This example code is in the public domain  The blue LED on the ESP-01 module is connected to GPIO1  (which is also the TXD pin; so we cannot use Serial.print() at the same time)  Note that this sketch uses LED_BUILTIN to find the pin with the internal LED*/void setup() {  pinMode(LED_BUILTIN, OUTPUT);     // Initialize the LED_BUILTIN pin as an output}// the loop function runs over and over again forevervoid loop() {  digitalWrite(LED_BUILTIN, LOW);   // Turn the LED on (Note that LOW is the voltage level  // but actually the LED is on; this is because  // it is active low on the ESP-01)  delay(1000);                      // Wait for a second  digitalWrite(LED_BUILTIN, HIGH);  // Turn the LED off by making the voltage HIGH  delay(2000);                      // Wait for two seconds (to demonstrate the active low LED)}</code></pre><p>在这里点击项目上传，就会编译该Blink项目并上传写入开发板上面运行。如果一切顺利的话，你的开发板的LED灯应该就会开始闪烁了。</p></li></ul><h4><a href="#chong-yao-yi-xie-keng-yi-ji-zhu-yi-dian" class="header-anchor">#</a><span id="chong-yao-yi-xie-keng-yi-ji-zhu-yi-dian">重要！！！一些坑以及注意点</span></h4><p>下面说下一切不是很顺利的情况，首先我这里是以mac会开发平台，所以这里都是mac相关的注意事项和问题。</p><p>确定你的端口正常，即电脑是否与开发板正常通信。一般来说你上传代码报错多半是由于端口不可用或者无法找到端口。这里提供几个思路去检查。</p><p>1、确定usb是否连接，这里可以下载一个IORegistryExplorer的工具。<a href="https://developer.apple.com/download/more/" target="_blank" rel="external">下载地址1</a> <a href="https://github.com/vulgo/IORegistryExplorer">下载地址2</a> <a href="https://mac.softpedia.com/get/System-Utilities/IORegistryExplorer.shtml" target="_blank" rel="external">下载地址3</a>在我插入开发板的时候可以看到usb2.0下面多了一个设备，说明能够usb连接正常。</p><p><img src="https://github.com/4ch12dy/4ch12dy.github.io/blob/master/articlePic/Arduino-ESP8266-bigstep/image-20190730145128956.png?raw=true" width="500" hegiht="313" align="center"></p><p>2、确定安装了开发板相关的驱动，这个驱动的作用主要就是将设备操作通过<code>Virtual COM Port</code>去通信。这里有几个坑。之前网上能搜到的驱动都不支持最新的macOS系统（10.14）。所以导致我的<code>/dev</code>目录下并没有出现对应的文件。之前的驱动大多是这个<a href="https://github.com/adrianmihalko/ch340g-ch34g-ch34x-mac-os-x-driver">CH340G CH34G CH34X Mac OS X driver</a> 照着里面的步骤，把SIP禁用以及其他都操作了一遍都不行。最后才发现这个驱动可能不支持最新的mac系统，这里我找到一个能够在最新系统正常的驱动下载地址在<a href="https://www.silabs.com/products/development-tools/software/usb-to-uart-bridge-vcp-drivers" target="_blank" rel="external">这里</a>。安装完以后在<code>/dev</code>就应该有一个<code>tty.SLAB_USBtoUART</code>的文件。说明通信的端口已经建立，这时候再IDE中选择该端口。</p><p><img src="https://github.com/4ch12dy/4ch12dy.github.io/blob/master/articlePic/Arduino-ESP8266-bigstep/image-20190730145909934.png?raw=true" width="500" hegiht="313" align="center"></p><h4><a href="#zi-yuan-lian-jie" class="header-anchor">#</a><span id="zi-yuan-lian-jie">资源链接</span></h4><p>这里我提供一些我在搭建过程中搜到的一些资源，可以参考一下</p><ul><li><p><a href="https://www.arduino.cc/en/guide/macOSX?setlang=cn" target="_blank" rel="external">https://www.arduino.cc/en/guide/macOSX?setlang=cn</a></p><p>在Mac OS X系统上入门Arduino/ Genuino</p></li><li><p><a href="https://juejin.im/post/5b569026e51d4513ee6dd509" target="_blank" rel="external">https://juejin.im/post/5b569026e51d4513ee6dd509</a></p><p>Esp8266+Arduino+Mac开发环境搭建</p></li><li><p><a href="https://www.open-homeautomation.com/2016/06/10/program-an-esp8266-from-arduino-on-macos/" target="_blank" rel="external">https://www.open-homeautomation.com/2016/06/10/program-an-esp8266-from-arduino-on-macos/</a></p><p>Program an ESP8266 from Arduino on MacOS</p></li><li><p><a href="https://github.com/adrianmihalko/ch340g-ch34g-ch34x-mac-os-x-driver">https://github.com/adrianmihalko/ch340g-ch34g-ch34x-mac-os-x-driver</a></p><p>CH340G CH34G CH34X Mac OS X driver</p></li><li><p><a href="http://www.nodemcu.com" target="_blank" rel="external">http://www.nodemcu.com</a></p><p>资料下载访问官网</p></li><li><p><a href="https://pan.baidu.com/s/1ZCjaSJLNpQWL7CPOpkH-dg" target="_blank" rel="external">https://pan.baidu.com/s/1ZCjaSJLNpQWL7CPOpkH-dg</a></p><p>NODEMCU资料</p></li><li><p><a href="http://www.wch.cn/download/CH341SER_MAC_ZIP.html" target="_blank" rel="external">http://www.wch.cn/download/CH341SER_MAC_ZIP.html</a></p><p>mac串口驱动下载地址</p></li><li><p><a href="https://freeware.the-meiers.org/" target="_blank" rel="external">https://freeware.the-meiers.org/</a></p><p>CoolTerm串口监控工具下载</p></li><li><p>SIP禁用步骤</p><pre><code>1. 重启mac，在出现苹果标志和进度条的时候按住 cmd+r2. 终端中输入csrutil disable/status/enabled3. 重启mac</code></pre></li></ul><h4><a href="#avr-ni-xiang-ji-chu" class="header-anchor">#</a><span id="avr-ni-xiang-ji-chu">AVR逆向基础</span></h4><p>下面我们就来熟悉一下这个系统，包括代码环境，编译环境，常见库，开发相关。还是以一些demo代码作为学习。</p><p>由于我们主要是研究iOT逆向，所以可能不会关注在实际开发上面。这里先学习下Arduino上面的执行文件格式，以及指令架构等。</p><p>我们通常说的Arduino上面就运行的是一个AVR指令架构的处理器。</p><blockquote><p>AVR refers to the line of MCUs manufactured by Atmel and used in the original designs.</p></blockquote><p>由于ida对这个执行文件的支持不是很好，我们准备用<a href="https://github.com/radare/radare2">radare2</a>来分析这个bin文件。</p><h4><a href="#can-kao" class="header-anchor">#</a><span id="can-kao">参考</span></h4><ul><li><p><a href="https://blog.csdn.net/iotisan/article/details/78766463" target="_blank" rel="external">https://blog.csdn.net/iotisan/article/details/78766463</a></p><p>和ESP8266 Arduino谈场恋爱 01 一条具有中国特色的开发环境安装道路</p></li><li><p><a href="https://www.reddit.com/r/arduino/comments/9jlz5g/any_nodemcu_esp8266_drivers_for_macos_mojave/" target="_blank" rel="external">https://www.reddit.com/r/arduino/comments/9jlz5g/any_nodemcu_esp8266_drivers_for_macos_mojave/</a></p><p>Any NodeMCU esp8266 Drivers for MacOS Mojave?</p></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3&gt;&lt;a href=&quot;#arduino-esp8266-kai-fa-ban-shang-shou-shi-jian&quot; class=&quot;header-anchor&quot;&gt;#&lt;/a&gt;&lt;span id=&quot;arduino-esp8266-kai-fa-ban-shang-shou-shi
      
    
    </summary>
    
      <category term="IOT" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/categories/IOT/"/>
    
    
      <category term="Arduino" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/Arduino/"/>
    
      <category term="IOT" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/IOT/"/>
    
  </entry>
  
  <entry>
    <title>Electron跨平台App实战分析</title>
    <link href="https://github.com/4ch12dy/4ch12dy.github.io.git/2019/07/29/Electron-app-reversing/Electron-app-reversing/"/>
    <id>https://github.com/4ch12dy/4ch12dy.github.io.git/2019/07/29/Electron-app-reversing/Electron-app-reversing/</id>
    <published>2019-07-29T03:59:49.000Z</published>
    <updated>2020-04-24T07:06:26.273Z</updated>
    
    <content type="html"><![CDATA[<script src="//cdn.bootcss.com/jquery/1.11.3/jquery.min.js"></script><div id="hbe-security">  <div class="hbe-input-container">  <input type="password" class="hbe-form-control" id="pass" placeholder="give me the secret code ;)">    <label for="pass">give me the secret code ;)</label>    <div class="bottom-line"></div>  </div></div><div id="decryptionError" style="display: none;">Incorrect Password!</div><div id="noContentError" style="display: none;">No content to display!</div><div id="encrypt-blog" style="display:none">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</div><script src="/lib/crypto-js.js"></script><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      something you can not kown 
    
    </summary>
    
      <category term="RE" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/categories/RE/"/>
    
    
      <category term="Electron" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/Electron/"/>
    
      <category term="RE" scheme="https://github.com/4ch12dy/4ch12dy.github.io.git/tags/RE/"/>
    
  </entry>
  
</feed>
